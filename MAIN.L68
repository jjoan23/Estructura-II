0000183C Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 20/12/2024 17:43:21

00000000                             1  *-----------------------------------------------------------------------------
00000000                             2  * Title      : MAIN
00000000                             3  * Written by :
00000000                             4  * Date       :
00000000                             5  * Description:
00000000                             6  *-----------------------------------------------------------------------------
00000000                             7  
00001000                             8              ORG    $1000
00001000                             9              
00001000                            10              INCLUDE 'CONST.X68'
00001000                            11  ; ----------------------------------------------------------------------------
00001000                            12  ; CONSTANTES DEL JUEGO
00001000                            13  ; ----------------------------------------------------------------------------
00001000                            14     
00001000                            15  ; --- CONSTANTES DE LA MANZANA -----------------------------------------------
00001000                            16  
00001000  =00000014                 17  MNZWIDTH    EQU     20                      ; ANCHURA DE LA MANZANA (a determinar)
00001000  =00000014                 18  MNZHEIGH    EQU     20                      ; ALTURA DE LA MANZANA (a determinar)
00001000  =0000AAFF                 19  MNZPCOL     EQU     $0000AAFF               ; COLOR CONTORNO MANZANA (a determinar)
00001000  =000000FF                 20  MNZFCOL     EQU     $000000FF               ; COLOR RELLENO MANZANA (a determinar)
00001000                            21  
00001000                            22  ; --- CONSTANTES DE LA SERPIENTE ---------------------------------------------
00001000                            23  
00001000  =00000001                 24  MAXSGM      EQU     1                       ; TAMAÑO MÁXIMO DE SEGMENTOS (a determinar)
00001000  =00000001                 25  LNGINI      EQU     1                       ; LONGITUD INICIAL SERPIENTE (a determinar)
00001000  =00000014                 26  SGMWIDTH    EQU     20                      ; ANCHURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 27  SGMHEIGH    EQU     20                      ; ALTURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 28  CBZVEL      EQU     20                      ; VELOCIDAD DE LA CABEZA (a determinar)
00001000  =0000FF00                 29  SGMPCOL     EQU     $0000FF00               ; COLOR CONTORNO SEGMENTO (PROVISIONAL)
00001000  =0000AA00                 30  SGMFCOL     EQU     $0000AA00               ; COLOR RELLENO SEGMENTO (PROVISIONAL)
00001000  =0000000A                 31  COLWIDTH    EQU     10                      ; ANCHURA DE LA COLA (PROVISIONAL)
00001000  =0000000A                 32  COLHEIGH    EQU     10                      ; ALTURA DE LA COLA (PROVISIONAL)
00001000  =0000FF00                 33  COLPCOL     EQU     $0000FF00               ; COLOR CONTORNO COLA (PROVISIONAL)
00001000  =0000AA00                 34  COLFCOL     EQU     $0000AA00               ; COLOR RELLENO COLA (PROVISIONAL)
00001000  =00000014                 35  CBZWIDTH    EQU     20                      ; ANCHURA DE LA CABEZA (PROVISIONAL)
00001000  =00000014                 36  CBZHEIGH    EQU     20                      ; ALTURA DE LA CABEZA (PROVISIONAL)
00001000  =0000FF00                 37  CBZPCOL     EQU     $0000FF00               ; COLOR CONTORNO CABEZA (PROVISIONAL)
00001000  =0000AA00                 38  CBZFCOL     EQU     $0000AA00               ; COLOR RELLENO CABEZA (PROVISIONAL)
00001000  =0000000A                 39  OJOWIDTH    EQU     10                      ; ANCHURA DE OJO DE SERPIENTE
00001000  =0000000A                 40  OJOHEIGH    EQU     10                      ; ALTURA DE OJO DE SERPIENTE
00001000  =00000000                 41  OJOPCOL     EQU     $00000000               ; COLOR CONTORNO OJO
00001000  =00FFFFFF                 42  OJOFCOL     EQU     $00FFFFFF               ; COLOR RELLENO OJO
00001000                            43  
00001000                            44  
00001000                            45  
00001000                            46  ; --- CONSTANTES MARCADOR ----------------------------------------------------
00001000                            47  
00001000  =00000001                 48  PNTSFCOL    EQU     1                       ; COLOR FONDO MARCADOR (a determinar)
00001000  =00000001                 49  PNTSTEXT    EQU     1                       ; COORDENADAS DEL MARCADOR (a determinar)
00001000                            50  
00001000                            51  
00001000                            52  
00001000                            53  
00001000                            54  
00001000                            55  
00001000                            56  
00001000                            57  -------------------- end include --------------------
00001000                            58              INCLUDE 'SYSCONST.X68'
00001000                            59  ; ----------------------------------------------------------------------------
00001000                            60  ; CONSTANTES DEL SISTEMA
00001000                            61  ; ----------------------------------------------------------------------------
00001000                            62  
00001000                            63  ; ---CONSTANTES DE LA PANTALLA------------------------------------------------
00001000                            64  
00001000  =00000280                 65  PANWIDTH    EQU     640                     ; ANCHO DE LA PANTALLA
00001000  =000001E0                 66  PANHEIGH    EQU     480                     ; ALTURA DE LA PANTALLA
00001000  =0090EE90                 67  COLFND      EQU     $90EE90                 ; COLOR DEL FONDO DE LA PANTALLA
00001000                            68  
00001000                            69  ; ---CONSTANTES DE LA MATRIZ--------------------------------------------------
00001000                            70  
00001000  =00000014                 71  SIZECLDA    EQU     20                      ; TAMAÑO DE CADA CELDA EN PIXELES
00001000  =00000020                 72  NUMCLMNS    EQU     32                      ; COLUMNAS DE CELDAS (640/10)
00001000  =00000018                 73  NUMFILAS    EQU     24                      ; FILAS DE CELDAS (480/10)
00001000  =00000300                 74  TCELDAS     EQU     768                     ; TOTAL DE CELDAS (64 * 48)
00001000                            75  
00001000                            76  ; ---CÓDIGOS DE TECLADO-------------------------------------------------------
00001000                            77  
00001000  =00000025                 78  KBDLEFT     EQU     $25
00001000  =00000026                 79  KBDUP       EQU     $26
00001000  =00000027                 80  KBDRIGHT    EQU     $27
00001000  =00000028                 81  KBDDOWN     EQU     $28
00001000                            82  
00001000                            83  
00001000                            84  -------------------- end include --------------------
00001000                            85              INCLUDE 'SYSTEM.X68'
00001000                            86   
00001000                            87   
00001000                            88  SYSINIT
00001000                            89  ; INICIA EL  SISTEMA
00001000                            90  ; INPUT    : NONE
00001000                            91  ; OUTPUT   : NONE
00001000                            92  ; MODIFIES : NONE
00001000                            93  ; ----------------------------------------------------------------------------
00001000  4EB9 0000101E             94              JSR     SCRINIT
00001006                            95              
00001006  21FC 0000104C 0080        96              MOVE.L  #SCRPLOT,($80)
0000100E  21FC 0000106E 0084        97              MOVE.L  #KBDUPD,($84)
00001016                            98              
00001016  40E7                      99              MOVE.W  SR,-(A7)
00001018  0257 DFFF                100              ANDI.W  #$DFFF,(A7)
0000101C                           101              
0000101C  4E73                     102              RTE
0000101E                           103              
0000101E                           104  ; ------------------------------------------------------------------------------
0000101E                           105  SCRINIT
0000101E                           106  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
0000101E                           107  ; ENABLE DOUBLE BUFFER.
0000101E                           108  ; INPUT    : NONE
0000101E                           109  ; OUTPUT   : NONE
0000101E                           110  ; MODIFIES : NONE
0000101E                           111  ; ------------------------------------------------------------------------------
0000101E                           112  
0000101E  48E7 C000                113              MOVEM.L D0-D1,-(A7)
00001022                           114  
00001022                           115              ; SET SCREEN RESOLUTION
00001022  103C 0021                116              MOVE.B  #33,D0
00001026  223C 028001E0            117              MOVE.L  #PANWIDTH<<16|PANHEIGH,D1
0000102C  4E4F                     118              TRAP    #15
0000102E                           119              
0000102E                           120              ; SET WINDOWED MODE
0000102E  7201                     121              MOVE.L  #1,D1
00001030  4E4F                     122              TRAP    #15
00001032                           123              
00001032                           124              ; CLEAR SCREEN
00001032  103C 000B                125              MOVE.B  #11,D0
00001036  323C FF00                126              MOVE.W  #$FF00,D1
0000103A  4E4F                     127              TRAP    #15
0000103C                           128              
0000103C                           129              ; ENABLE DOUBLE BUFFER
0000103C  103C 005C                130              MOVE.B  #92,D0
00001040  123C 0011                131              MOVE.B  #17,D1
00001044  4E4F                     132              TRAP    #15
00001046                           133              
00001046  4CDF 0003                134              MOVEM.L (A7)+,D0-D1
0000104A                           135              
0000104A  4E75                     136              RTS    
0000104C                           137  
0000104C                           138  ; ------------------------------------------------------------------------------
0000104C                           139  SCRPLOT
0000104C                           140  ; UPDATES DOUBLE BUFFER
0000104C                           141  ; INPUT    : NONE
0000104C                           142  ; OUTPUT   : NONE
0000104C                           143  ; MODIFIES : NONE
0000104C                           144  ; ------------------------------------------------------------------------------
0000104C                           145  
0000104C  48A7 C000                146              MOVEM.W D0-D1,-(A7)
00001050                           147              
00001050                           148              ; SWITCH BUFFERS
00001050  103C 005E                149              MOVE.B  #94,D0
00001054  4E4F                     150              TRAP    #15
00001056                           151              
00001056                           152              ; CLEAR HIDDEN BUFFER
00001056  103C 000B                153              MOVE.B  #11,D0
0000105A  323C FF00                154              MOVE.W  #$FF00,D1
0000105E  4E4F                     155              TRAP    #15
00001060                           156              
00001060  4C9F 0003                157              MOVEM.W (A7)+,D0-D1
00001064                           158              
00001064  4E73                     159              RTE
00001066                           160          
00001066                           161  ; ------------------------------------------------------------------------------
00001066                           162  KBDINIT
00001066                           163  ; INIT KEYBOARD
00001066                           164  ; INPUT    : NONE
00001066                           165  ; OUTPUT   : NONE
00001066                           166  ; MODIFIES : NONE
00001066                           167  ; ------------------------------------------------------------------------------
00001066                           168  
00001066  4239 00001BB2            169              CLR.B   (KBDEDGE)
0000106C  4E75                     170              RTS
0000106E                           171  
0000106E                           172  ; ------------------------------------------------------------------------------
0000106E                           173  KBDUPD
0000106E                           174  ; UPDATE KEYBOARD INFO.  
0000106E                           175  ; 7 -> PAUSE
0000106E                           176  ; 6 -> FIRE 3
0000106E                           177  ; 5 -> FIRE 2
0000106E                           178  ; 4 -> FIRE 1
0000106E                           179  ; 3 -> DOWN
0000106E                           180  ; 2 -> RIGHT
0000106E                           181  ; 1 -> UP
0000106E                           182  ; 0 -> LEFT
0000106E                           183  ; INPUT    : NONE
0000106E                           184  ; OUTPUT   : NONE
0000106E                           185  ; MODIFIES : NONE
0000106E                           186  ; ------------------------------------------------------------------------------
0000106E                           187  
0000106E  48E7 F000                188              MOVEM.L D0-D3,-(A7)
00001072                           189  
00001072                           190              ; LEE ESTADO DEL TECLADO
00001072  103C 0013                191              MOVE.B  #19,D0
00001076  223C 25262728            192              MOVE.L  #KBDLEFT<<24|KBDUP<<16|KBDRIGHT<<8|KBDDOWN,D1
0000107C  4E4F                     193              TRAP    #15                  ; Lee las teclas y guarda en D1
0000107E                           194  
0000107E                           195              ; CONVERT TO DESIRED FORMAT
0000107E  363C 0003                196              MOVE.W  #3,D3
00001082  E189                     197  .LOOP       LSL.L   #8,D1
00001084  E312                     198              ROXL.B  #1,D2
00001086  51CB FFFA                199              DBRA.W  D3,.LOOP
0000108A                           200  
0000108A                           201              ; PROCESA FLANCOS ASCENDENTES
0000108A  1039 00001BB2            202              MOVE.B  (KBDEDGE),D0         ; Estado anterior
00001090  4600                     203              NOT.B   D0                   ; Invertir bits (teclas no presionadas)
00001092  C002                     204              AND.B   D2,D0                ; Detectar flancos ascendentes
00001094  13C0 00001BB2            205              MOVE.B  D0,(KBDEDGE)         ; Almacena los flancos en KBDEDGE
0000109A                           206              
0000109A                           207              ; STORE KBDEDGE
0000109A  13C2 00001BB2            208              MOVE.B  D2,(KBDEDGE)
000010A0                           209  
000010A0  4CDF 000F                210              MOVEM.L (A7)+,D0-D3
000010A4  4E73                     211              RTE
000010A6                           212  
000010A6                           213  
000010A6                           214  
000010A6                           215  ; CODIGO ANTERIOR
000010A6                           216  
000010A6                           217  
000010A6                           218  
000010A6                           219  
000010A6                           220  
000010A6                           221  
000010A6                           222  
000010A6                           223  
000010A6                           224  
000010A6                           225  
000010A6                           226  
000010A6                           227  
000010A6                           228  
000010A6                           229  
000010A6                           230  
000010A6                           231  
000010A6                           232  
000010A6                           233  -------------------- end include --------------------
000010A6                           234              INCLUDE 'LIB/UTLCODE.X68'
000010A6                           235  ; =============================================================================
000010A6                           236  ; UTILITY CODE
000010A6                           237  ; =============================================================================
000010A6                           238  
000010A6                           239  ; -----------------------------------------------------------------------------
000010A6                           240  UTLINIT
000010A6                           241  ; INITIALIZES UTILITY CODE
000010A6                           242  ; INPUT    - NONE
000010A6                           243  ; OUTPUT   - NONE
000010A6                           244  ; MODIFIES - NONE
000010A6                           245  ; -----------------------------------------------------------------------------
000010A6  48E7 C000                246              MOVEM.L D0-D1,-(A7)
000010AA  103C 0008                247              MOVE.B  #8,D0
000010AE  4E4F                     248              TRAP    #15
000010B0  13C1 000018AE            249              MOVE.B  D1,(UTLRNDIX)
000010B6  4CDF 0003                250              MOVEM.L (A7)+,D0-D1
000010BA  4E75                     251              RTS
000010BC                           252  
000010BC                           253  ; -----------------------------------------------------------------------------
000010BC                           254  UTLRAND
000010BC                           255  ; PROVIDES A PSEUDO-RANDOM BYTE
000010BC                           256  ; INPUT    - NONE
000010BC                           257  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000010BC                           258  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010BC                           259  ; -----------------------------------------------------------------------------
000010BC  2F08                     260              MOVE.L  A0,-(A7)
000010BE  41F9 000010DA            261              LEA     .RANDVEC,A0
000010C4  4280                     262              CLR.L   D0
000010C6  1039 000018AE            263              MOVE.B  (UTLRNDIX),D0
000010CC  1030 0800                264              MOVE.B  (A0,D0.L),D0
000010D0  5239 000018AE            265              ADDQ.B  #1,(UTLRNDIX)
000010D6  205F                     266              MOVE.L  (A7)+,A0
000010D8  4E75                     267              RTS
000010DA                           268  
000010DA                           269  
000010DA= A2 EE 9A 0C F5 24 ...    270  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000010E2= 2A A3 51 26 E0 AC ...    271              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000010EA= 75 51 CA FD 33 EB ...    272              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000010F2= 60 CC E7 B8 9A EB ...    273              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000010FA= 1D 76 B5 95 B0 89 ...    274              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001102= 39 15 48 C9 6E CA ...    275              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
0000110A= 43 E7 E2 7C 37 25 ...    276              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001112= E9 94 CE E9 E4 52 ...    277              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
0000111A= 37 6D 9A 84 A2 28 ...    278              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001122= 19 E2 C6 77 80 D4 ...    279              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
0000112A= 0A 5A 32 67 33 C2 ...    280              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001132= 59 80 DC 0E 57 FC ...    281              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
0000113A= 8A AB BC F7 07 4D ...    282              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001142= EF D5 77 6E 1E BB ...    283              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
0000114A= D6 E0 2A 8F BD 28 ...    284              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001152= 13 4F 66 EC 0A 64 ...    285              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
0000115A= 56 52 9A 16 9B 90 ...    286              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001162= 06 8A A4 F7 01 DA ...    287              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
0000116A= F2 E7 77 28 B1 76 ...    288              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001172= A4 42 E3 81 B1 67 ...    289              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
0000117A= BF CE FA 16 BF 38 ...    290              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001182= D1 8B 50 0C 5F 49 ...    291              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
0000118A= DE 4C 14 A2 40 DC ...    292              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001192= B6 9B 0A 38 5D AB ...    293              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
0000119A= E2 1B DD 75 15 82 ...    294              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000011A2= 8A 26 51 30 9F 47 ...    295              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000011AA= 1E 8A BB 71 C6 6E ...    296              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000011B2= 9F 47 E5 34 94 27 ...    297              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000011BA= 7D 06 D6 BA 30 0F ...    298              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000011C2= EC 7F 7E 03 CF 2D ...    299              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000011CA= 94 5B 23 F2 8B CD ...    300              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000011D2= 74 33 EC B9 0F D5 ...    301              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000011D2= 74 33 EC B9 0F D5 ...    302  -------------------- end include --------------------
000011DA                           303              INCLUDE 'HEADSRP.X68'
000011DA                           304  
000011DA                           305  ; ------------------------------------------------------------------------------
000011DA                           306  HEADINIT
000011DA                           307  ; INICIALIZAR CABEZA.
000011DA                           308  ; INPUT    : NONE 
000011DA                           309  ; OUTPUT   : NONE
000011DA                           310  ; MODIFIES : NONE
000011DA                           311  ; ------------------------------------------------------------------------------
000011DA  33FC 0140 0000189A       312              MOVE.W  #PANWIDTH/2,(CBZPOSX)
000011E2  33FC 00F0 0000189C       313              MOVE.W  #PANHEIGH/2,(CBZPOSY)
000011EA  4279 000018AA            314              CLR     TRZPLOT
000011F0  13FC 0003 000018AA       315              MOVE.B  #3,TRZPLOT
000011F8  4279 00001BB0            316              CLR.W   ESTDCBZ
000011FE  33FC 0000 00001BB0       317              MOVE.W  #0,ESTDCBZ
00001206  4E75                     318              RTS
00001208                           319              
00001208                           320  ; ------------------------------------------------------------------------------
00001208                           321  HEADUPD
00001208                           322  ; ACTUALIZAR CABEZA.
00001208                           323  ; INPUT    : NONE 
00001208                           324  ; OUTPUT   : NONE
00001208                           325  ; MODIFIES : NONE
00001208                           326  ; ------------------------------------------------------------------------------
00001208  48A7 E000                327              MOVEM.W D0-D2,-(A7)
0000120C                           328                       
0000120C  4240                     329              CLR.W   D0
0000120E  4241                     330              CLR.W   D1
00001210  4242                     331              CLR.W   D2
00001212  3239 0000189A            332              MOVE.W  CBZPOSX,D1
00001218  33C1 000018A6            333              MOVE.W  D1,SGMPOSX
0000121E  3439 0000189C            334              MOVE.W  CBZPOSY,D2
00001224  33C2 000018A8            335              MOVE.W  D2,SGMPOSY
0000122A  4EB9 0000160C            336              JSR     CINDMTRZ
00001230  4EB9 0000165E            337              JSR     RSTCLD
00001236                           338              
00001236  4240                     339              CLR.W   D0
00001238  3039 00001BB0            340              MOVE.W  ESTDCBZ,D0
0000123E  B07C 0000                341              CMP.W   #0,D0
00001242  6700 001A                342              BEQ     SIGDER
00001246  B07C 0001                343              CMP.W   #1,D0
0000124A  6700 0036                344              BEQ     SIGARR
0000124E  B07C 0002                345              CMP.W   #2,D0
00001252  6700 0052                346              BEQ     SIGIZQ
00001256  B07C 0003                347              CMP.W   #3,D0
0000125A  6700 006E                348              BEQ     SIGABA
0000125E                           349              
0000125E  0679 0014 0000189A       350  SIGDER:     ADD.W   #CBZVEL,CBZPOSX               ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE 
00001266  3239 0000189A            351              MOVE.W  CBZPOSX,D1
0000126C  3439 0000189C            352              MOVE.W  CBZPOSY,D2
00001272  4EB9 0000160C            353              JSR     CINDMTRZ
00001278  4EB9 00001646            354              JSR     CBZOCPD  
0000127E  6000 006E                355              BRA     FIN
00001282                           356              
00001282  0479 0014 0000189C       357  SIGARR:     SUB.W   #CBZVEL,CBZPOSY              ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE
0000128A  3239 0000189A            358              MOVE.W  CBZPOSX,D1
00001290  3439 0000189C            359              MOVE.W  CBZPOSY,D2 
00001296  4EB9 0000160C            360              JSR     CINDMTRZ
0000129C  4EB9 00001646            361              JSR     CBZOCPD  
000012A2  6000 004A                362              BRA     FIN   
000012A6                           363    
000012A6  0479 0014 0000189A       364  SIGIZQ:     SUB.W   #CBZVEL,CBZPOSX              ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE 
000012AE  3239 0000189A            365              MOVE.W  CBZPOSX,D1
000012B4  3439 0000189C            366              MOVE.W  CBZPOSY,D2
000012BA  4EB9 0000160C            367              JSR     CINDMTRZ
000012C0  4EB9 00001646            368              JSR     CBZOCPD  
000012C6  6000 0026                369              BRA     FIN      
000012CA                           370  
000012CA  0679 0014 0000189C       371  SIGABA:     ADD.W   #CBZVEL,CBZPOSY               ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE 
000012D2  3239 0000189A            372              MOVE.W  CBZPOSX,D1
000012D8  3439 0000189C            373              MOVE.W  CBZPOSY,D2
000012DE  4EB9 0000160C            374              JSR     CINDMTRZ 
000012E4  4EB9 00001646            375              JSR     CBZOCPD  
000012EA  6000 0002                376              BRA     FIN      
000012EE                           377              
000012EE                           378  FIN:            
000012EE  4C9F 0007                379              MOVEM.W (A7)+,D0-D2
000012F2  4E75                     380              RTS
000012F4                           381              
000012F4                           382  ; ------------------------------------------------------------------------------
000012F4                           383  HEADPLOT
000012F4                           384  ; DIBUJAR CABEZA.
000012F4                           385  ; INPUT    : NONE 
000012F4                           386  ; OUTPUT   : NONE
000012F4                           387  ; MODIFIES : NONE
000012F4                           388  ; ------------------------------------------------------------------------------
000012F4  3F00                     389             MOVE.W  D0,-(A7)                ; GUARDAMOS D0
000012F6  3003                     390              MOVE.W  D3,D0                  ; PONEMOS EL INDICE DE LA CELDA EN D0 PARA CALCULAR SUS COORDENADAS
000012F8  4EB9 000016CA            391              JSR     CNVICOOR
000012FE  2F01                     392              MOVE.L  D1,-(A7)
00001300                           393              
00001300                           394              ; SET COLOR DEL CONTORNO CABEZA
00001300  103C 0050                395              MOVE.B  #80,D0
00001304  223C 0000FF00            396              MOVE.L  #CBZPCOL,D1
0000130A  4E4F                     397              TRAP    #15
0000130C                           398              
0000130C                           399              ; SET COLOR DEL RELLENO CABEZA
0000130C  103C 0051                400              MOVE.B  #81,D0
00001310  223C 0000AA00            401              MOVE.L  #CBZFCOL,D1
00001316  4E4F                     402              TRAP    #15
00001318                           403              
00001318                           404              ; DIBUJAR CABEZA
00001318  103C 0057                405              MOVE.B  #87,D0
0000131C  221F                     406              MOVE.L  (A7)+,D1
0000131E  3F03                     407              MOVE.W  D3,-(A7)
00001320  3601                     408              MOVE.W  D1,D3
00001322  0643 0014                409              ADD.W   #CBZWIDTH,D3
00001326  3802                     410              MOVE.W  D2,D4
00001328  0644 0014                411              ADD.W   #CBZHEIGH,D4
0000132C  4E4F                     412              TRAP    #15
0000132E                           413              
0000132E  2F01                     414              MOVE.L  D1,-(A7)
00001330                           415              
00001330                           416              ; SET COLOR DEL CONTORNO OJO
00001330  103C 0050                417              MOVE.B  #80,D0
00001334  7200                     418              MOVE.L  #OJOPCOL,D1
00001336  4E4F                     419              TRAP    #15
00001338                           420              
00001338                           421              ; SET COLOR DEL RELLENO OJO
00001338  103C 0051                422              MOVE.B  #81,D0
0000133C  223C 00FFFFFF            423              MOVE.L  #OJOFCOL,D1
00001342  4E4F                     424              TRAP    #15
00001344                           425              
00001344                           426              ; DIBUJAR OJO
00001344  103C 0058                427              MOVE.B  #88,D0
00001348  221F                     428              MOVE.L  (A7)+,D1
0000134A  2F01                     429              MOVE.L  D1,-(A7)
0000134C  2F02                     430              MOVE.L  D2,-(A7)
0000134E  5A41                     431              ADD.W   #OJOWIDTH/2,D1            
00001350  3601                     432              MOVE.W  D1,D3
00001352  0643 000A                433              ADD.W   #OJOWIDTH,D3
00001356  5A42                     434              ADD.W   #OJOHEIGH/2,D2
00001358  3802                     435              MOVE.W  D2,D4
0000135A  0644 000A                436              ADD.W   #OJOHEIGH,D4
0000135E  4E4F                     437              TRAP    #15
00001360                           438  
00001360                           439              ; DEFINIR COORDENADAS IRIS
00001360  241F                     440              MOVE.L  (A7)+,D2
00001362  221F                     441              MOVE.L  (A7)+,D1
00001364  0641 000A                442              ADD.W   #OJOWIDTH,D1
00001368  0642 000A                443              ADD.W   #OJOHEIGH,D2
0000136C  103C 0052                444              MOVE.B  #82,D0
00001370  4E4F                     445              TRAP    #15
00001372                           446              
00001372                           447              
00001372  361F                     448              MOVE.W  (A7)+,D3
00001374  301F                     449              MOVE.W  (A7)+,D0
00001376                           450  
00001376                           451  
00001376  4E75                     452              RTS
00001378                           453  
00001378                           454  
00001378                           455  
00001378                           456  
00001378                           457  
00001378                           458  
00001378                           459  
00001378                           460  
00001378                           461  
00001378                           462  
00001378                           463  
00001378                           464  
00001378                           465  
00001378                           466  
00001378                           467  
00001378                           468  
00001378                           469  -------------------- end include --------------------
00001378                           470              INCLUDE 'SEGSRP.X68'
00001378                           471  
00001378                           472  ; ------------------------------------------------------------------------------
00001378                           473  SEGINIT
00001378                           474  ; INICIALIZAR SEGMENTO.
00001378                           475  ; INPUT    : NONE 
00001378                           476  ; OUTPUT   : NONE
00001378                           477  ; MODIFIES : NONE
00001378                           478  ; ------------------------------------------------------------------------------
00001378  33FC 012C 000018A6       479              MOVE.W  #(PANWIDTH/2)-CBZWIDTH,(SGMPOSX)
00001380  33FC 00F0 000018A8       480              MOVE.W  #PANHEIGH/2,(SGMPOSY)
00001388  4E75                     481              RTS
0000138A                           482              
0000138A                           483  ; ------------------------------------------------------------------------------
0000138A                           484  SEGUPD
0000138A                           485  ; ACTUALIZAR SEGMENTO.
0000138A                           486  ; INPUT    : NONE 
0000138A                           487  ; OUTPUT   : NONE
0000138A                           488  ; MODIFIES : NONE
0000138A                           489  ; ------------------------------------------------------------------------------
0000138A  48A7 6000                490              MOVEM.W D1-D2,-(A7)
0000138E                           491              
0000138E  3239 000018A6            492              MOVE.W  SGMPOSX,D1
00001394  33C1 000018A2            493              MOVE.W  D1,COLPOSX
0000139A  3439 000018A8            494              MOVE.W  SGMPOSY,D2
000013A0  33C2 000018A4            495              MOVE.W  D2,COLPOSY
000013A6  4EB9 0000160C            496              JSR     CINDMTRZ
000013AC  4EB9 0000165E            497              JSR     RSTCLD
000013B2                           498              
000013B2  4C9F 0006                499              MOVEM.W (A7)+,D1-D2            
000013B6  4E75                     500              RTS
000013B8                           501              
000013B8                           502  ; ------------------------------------------------------------------------------
000013B8                           503  SEGPLOT
000013B8                           504  ; DIBUJAR SEGMENTO.
000013B8                           505  ; INPUT    : NONE 
000013B8                           506  ; OUTPUT   : NONE
000013B8                           507  ; MODIFIES : NONE
000013B8                           508  ; ------------------------------------------------------------------------------
000013B8  3F00                     509              MOVE.W  D0,-(A7)
000013BA  3003                     510              MOVE.W  D3,D0
000013BC  4EB9 000016CA            511              JSR     CNVICOOR
000013C2  2F01                     512              MOVE.L  D1,-(A7)
000013C4                           513              
000013C4  103C 0050                514              MOVE.B  #80,D0
000013C8  223C 0000FF00            515              MOVE.L  #SGMPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DEL SEGMENTO
000013CE  4E4F                     516              TRAP    #15
000013D0                           517              
000013D0  103C 0051                518              MOVE.B  #81,D0
000013D4  223C 0000AA00            519              MOVE.L  #SGMFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DEL SEGMENTO
000013DA  4E4F                     520              TRAP    #15
000013DC                           521              
000013DC  103C 0057                522              MOVE.B  #87,D0
000013E0  221F                     523              MOVE.L  (A7)+,D1
000013E2  3F03                     524              MOVE.W  D3,-(A7)
000013E4  3601                     525              MOVE.W  D1,D3
000013E6  0643 0014                526              ADD.W   #SIZECLDA,D3
000013EA  3802                     527              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
000013EC  0644 0014                528              ADD.W   #SIZECLDA,D4
000013F0  4E4F                     529              TRAP    #15                     
000013F2                           530                          
000013F2  361F                     531              MOVE.W  (A7)+,D3  
000013F4  301F                     532              MOVE.W  (A7)+,D0
000013F6                           533  
000013F6                           534  
000013F6  4E75                     535              RTS
000013F8                           536  
000013F8                           537  
000013F8                           538  
000013F8                           539  
000013F8                           540  
000013F8                           541  
000013F8                           542  
000013F8                           543  
000013F8                           544  
000013F8                           545  -------------------- end include --------------------
000013F8                           546              INCLUDE 'TAILSRP.X68'
000013F8                           547     
000013F8                           548  ; ------------------------------------------------------------------------------
000013F8                           549  TAILINIT
000013F8                           550  ; INICIALIZAR COLA.
000013F8                           551  ; INPUT    : NONE 
000013F8                           552  ; OUTPUT   : NONE
000013F8                           553  ; MODIFIES : NONE
000013F8                           554  ; ------------------------------------------------------------------------------
000013F8  33FC 011D 000018A2       555              MOVE.W  #(PANWIDTH/2)-CBZWIDTH-SGMWIDTH+(COLWIDTH/2),(COLPOSX)
00001400  33FC 00F0 000018A4       556              MOVE.W  #(PANHEIGH/2),(COLPOSY)
00001408  4E75                     557              RTS
0000140A                           558              
0000140A                           559              
0000140A                           560  ; ------------------------------------------------------------------------------
0000140A                           561  TAILUPD
0000140A                           562  ; ACTUALIZAR COLA.
0000140A                           563  ; INPUT    : NONE 
0000140A                           564  ; OUTPUT   : NONE
0000140A                           565  ; MODIFIES : NONE
0000140A                           566  ; ------------------------------------------------------------------------------
0000140A  48A7 6000                567              MOVEM.W D1-D2,-(A7)
0000140E                           568              
0000140E  3239 000018A2            569              MOVE.W  COLPOSX,D1
00001414  3439 000018A4            570              MOVE.W  COLPOSY,D2
0000141A  4EB9 0000160C            571              JSR     CINDMTRZ
00001420  4EB9 0000165E            572              JSR     RSTCLD 
00001426                           573              
00001426  4C9F 0006                574              MOVEM.W (A7)+,D1-D2            
0000142A  4E75                     575              RTS
0000142C                           576              
0000142C                           577  ; ------------------------------------------------------------------------------
0000142C                           578  TAILPLOT
0000142C                           579  ; DIBUJAR COLA
0000142C                           580  ; INPUT    : NONE 
0000142C                           581  ; OUTPUT   : NONE
0000142C                           582  ; MODIFIES : NONE
0000142C                           583  ; ------------------------------------------------------------------------------
0000142C  3F00                     584              MOVE.W  D0,-(A7)
0000142E  3003                     585              MOVE.W  D3,D0
00001430  4EB9 000016CA            586              JSR     CNVICOOR
00001436  2F01                     587              MOVE.L  D1,-(A7)
00001438                           588              
00001438  103C 0050                589              MOVE.B  #80,D0
0000143C  223C 0000FF00            590              MOVE.L  #COLPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA COLA
00001442  4E4F                     591              TRAP    #15
00001444                           592              
00001444  103C 0051                593              MOVE.B  #81,D0
00001448  223C 0000AA00            594              MOVE.L  #COLFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA COLA
0000144E  4E4F                     595              TRAP    #15
00001450                           596              
00001450  103C 0057                597              MOVE.B  #87,D0
00001454  221F                     598              MOVE.L  (A7)+,D1
00001456  3F03                     599              MOVE.W  D3,-(A7)
00001458  3601                     600              MOVE.W  D1,D3
0000145A  0643 0014                601              ADD.W   #SIZECLDA,D3
0000145E  3802                     602              MOVE.W  D2,D4                    
00001460  0644 0014                603              ADD.W   #SIZECLDA,D4
00001464  4E4F                     604              TRAP    #15                    ; DIBUJAMOS EL CUADRADO 
00001466                           605                          
00001466  361F                     606              MOVE.W  (A7)+,D3  
00001468  301F                     607              MOVE.W  (A7)+,D0
0000146A                           608  
0000146A  4E75                     609              RTS
0000146C                           610  
0000146C                           611  
0000146C                           612  
0000146C                           613  
0000146C                           614  
0000146C                           615  
0000146C                           616  
0000146C                           617  
0000146C                           618  -------------------- end include --------------------
0000146C                           619              INCLUDE 'APPLE.X68'
0000146C                           620     
0000146C                           621  ; ------------------------------------------------------------------------------
0000146C                           622  APPLEINIT
0000146C                           623  ; Inicializa la manzana en una posición aleatoria
0000146C                           624  ; INPUT    : NONE 
0000146C                           625  ; OUTPUT   : NONE
0000146C                           626  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
0000146C                           627  ; ------------------------------------------------------------------------------
0000146C                           628  
0000146C                           629              ; Llama a la función para generar la posición aleatoria
0000146C  4EB9 0000155A            630              JSR     GENPOSMNZ
00001472                           631  
00001472                           632              ; Convierte las coordenadas de la manzana a índice de la matriz
00001472  4EB9 0000160C            633              JSR     CINDMTRZ
00001478                           634  
00001478                           635              ; Verifica si la celda está ocupada o libre
00001478                           636  CHECK:
00001478  4EB9 00001706            637              JSR     CHECKCLD
0000147E  6700 0010                638              BEQ     MARKMNZ                  ; Si está libre
00001482                           639  
00001482                           640              ; Si la celda está ocupada
00001482  4EB9 0000155A            641              JSR     GENPOSMNZ                ; Genera una nueva posición
00001488  4EB9 0000160C            642              JSR     CINDMTRZ                 ; Convierte las nuevas coordenadas
0000148E  60E8                     643              BRA     CHECK                    ; Repite la comprobación
00001490                           644  
00001490                           645  MARKMNZ:
00001490                           646              ; Marca la celda como ocupada con la manzana (estado 4)
00001490  4EB9 000016B4            647              JSR     MNZOCPD
00001496                           648  
00001496                           649              ; Dibuja la manzana en la pantalla
00001496  4EB9 000014DC            650              JSR     APPLEPLOT
0000149C                           651  
0000149C  4E75                     652              RTS
0000149E                           653              
0000149E                           654              ;MOVE.W  #30,(MNZPOSX)   ;DE MOMENTO PONGO X E Y ELEGIDAS MANUALMENTE, EN TEORÍA DEBE SER ALEATORIO
0000149E                           655              ;MOVE.W  #30,(MNZPOSY)
0000149E                           656  
0000149E                           657  ; ------------------------------------------------------------------------------
0000149E                           658  APPLEUPD
0000149E                           659  ; Actualiza la posición de la manzana cuando la serpiente come
0000149E                           660  ; INPUT    : NONE 
0000149E                           661  ; OUTPUT   : NONE
0000149E                           662  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
0000149E                           663  ; ------------------------------------------------------------------------------
0000149E                           664  
0000149E                           665              ; Convierte las coordenadas actuales de la manzana a índice de la matriz
0000149E  4EB9 0000160C            666              JSR     CINDMTRZ
000014A4                           667  
000014A4                           668              ; Marca la celda anterior como vacía
000014A4  4EB9 00001672            669              JSR     MCLDVCIA
000014AA                           670  
000014AA                           671              ; Llama a la función para generar una nueva posición aleatoria
000014AA  4EB9 0000155A            672              JSR     GENPOSMNZ
000014B0                           673  
000014B0                           674              ; Convierte las nuevas coordenadas de la manzana a índice de la matriz
000014B0  4EB9 0000160C            675              JSR     CINDMTRZ
000014B6                           676  
000014B6                           677  CHCKUPDT:
000014B6  4EB9 00001706            678              JSR     CHECKCLD             ; Verifica si la celda está libre
000014BC  6700 0010                679              BEQ     NEWMNZ               ; Si está libre
000014C0                           680  
000014C0                           681              ; Si la celda está ocupada
000014C0  4EB9 0000155A            682              JSR     GENPOSMNZ            ; Genera una nueva posición
000014C6  4EB9 0000160C            683              JSR     CINDMTRZ             ; Convierte las nuevas coordenadas
000014CC  60E8                     684              BRA     CHCKUPDT             ; Repite la comprobación
000014CE                           685  
000014CE                           686  NEWMNZ:
000014CE                           687              ; Marca la celda como ocupada con la manzana (estado 4)
000014CE  4EB9 000016B4            688              JSR     MNZOCPD
000014D4                           689  
000014D4                           690              ; Dibuja la nueva manzana en la pantalla
000014D4  4EB9 000014DC            691              JSR     APPLEPLOT
000014DA                           692  
000014DA  4E75                     693              RTS
000014DC                           694              
000014DC                           695  ; ------------------------------------------------------------------------------
000014DC                           696  APPLEPLOT
000014DC                           697  ; Dibuja la manzana
000014DC                           698  ; INPUT    : NONE 
000014DC                           699  ; OUTPUT   : NONE
000014DC                           700  ; MODIFIES : NONE
000014DC                           701  ; ------------------------------------------------------------------------------
000014DC  3F00                     702              MOVE.W  D0,-(A7)
000014DE  3003                     703              MOVE.W  D3,D0
000014E0  4EB9 000016CA            704              JSR     CNVICOOR
000014E6  2F01                     705              MOVE.L  D1,-(A7)                ; PRIMERO DEBEMOS DIBUJAR EL FONDO Y LUEGO LA MANZANA
000014E8                           706              
000014E8  103C 0050                707              MOVE.B  #80,D0
000014EC  223C 0090EE90            708              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
000014F2  4E4F                     709              TRAP    #15
000014F4                           710              
000014F4  103C 0051                711              MOVE.B  #81,D0
000014F8  223C 0090EE90            712              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
000014FE  4E4F                     713              TRAP    #15
00001500                           714              
00001500  103C 0057                715              MOVE.B  #87,D0
00001504  221F                     716              MOVE.L  (A7)+,D1
00001506  3F03                     717              MOVE.W  D3,-(A7)
00001508  3601                     718              MOVE.W  D1,D3
0000150A  0643 0014                719              ADD.W   #SIZECLDA,D3
0000150E  3802                     720              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001510  0644 0014                721              ADD.W   #SIZECLDA,D4
00001514  4E4F                     722              TRAP    #15                     
00001516                           723                          
00001516  361F                     724              MOVE.W  (A7)+,D3  
00001518  301F                     725              MOVE.W  (A7)+,D0
0000151A                           726  
0000151A  3F00                     727              MOVE.W  D0,-(A7)
0000151C  3003                     728              MOVE.W  D3,D0
0000151E  4EB9 000016CA            729              JSR     CNVICOOR
00001524  2F01                     730              MOVE.L  D1,-(A7)
00001526                           731              
00001526  103C 0050                732              MOVE.B  #80,D0
0000152A  223C 0000AAFF            733              MOVE.L  #MNZPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA MANZANA
00001530  4E4F                     734              TRAP    #15
00001532                           735              
00001532  103C 0051                736              MOVE.B  #81,D0
00001536  223C 000000FF            737              MOVE.L  #MNZFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA MANZANA
0000153C  4E4F                     738              TRAP    #15
0000153E                           739              
0000153E  103C 0058                740              MOVE.B  #88,D0
00001542  221F                     741              MOVE.L  (A7)+,D1
00001544  3F03                     742              MOVE.W  D3,-(A7)
00001546  3601                     743              MOVE.W  D1,D3
00001548  0643 0014                744              ADD.W   #SIZECLDA,D3
0000154C  3802                     745              MOVE.W  D2,D4                    ; DIBUJAMOS EL CIRCULO
0000154E  0644 0014                746              ADD.W   #SIZECLDA,D4
00001552  4E4F                     747              TRAP    #15                     
00001554                           748                          
00001554  361F                     749              MOVE.W  (A7)+,D3  
00001556  301F                     750              MOVE.W  (A7)+,D0
00001558                           751  
00001558                           752  
00001558  4E75                     753              RTS
0000155A                           754  ; ----------------------------------------------------------------------------
0000155A                           755  GENPOSMNZ
0000155A                           756  ; Genera una posición aleatoria para la manzana
0000155A                           757  ; INPUT: NONE
0000155A                           758  ; OUTPUT:
0000155A                           759  ; MODIFIES: MNZPOSX, MNZPOSY
0000155A                           760  ; ----------------------------------------------------------------------------
0000155A                           761  
0000155A  48E7 8000                762              MOVEM.L D0,-(A7)
0000155E                           763  
0000155E                           764              ; Genera la coordenada X aleatoria
0000155E  4EB8 10BC                765              JSR     UTLRAND
00001562  0240 001F                766              ANDI.W  #NUMCLMNS-1, D0       ; Asegura que esté en [0, NUMCLMNS-1]
00001566  C0FC 0014                767              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
0000156A  3200                     768              MOVE.W  D0,D1
0000156C  33C0 00001896            769              MOVE.W  D0, MNZPOSX           ; Guarda la coordenada X generada
00001572                           770              
00001572                           771              ; Generar coordenada Y aleatoria
00001572  4EB8 10BC                772              JSR     UTLRAND
00001576  0240 0017                773              ANDI.W  #NUMFILAS-1, D0       ; Asegura que esté en el rango [0, NUMFILAS-1]
0000157A  C0FC 0014                774              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
0000157E  3400                     775              MOVE.W  D0,D2
00001580  33C0 00001898            776              MOVE.W  D0, MNZPOSY           ; Guarda la coordenada Y generada
00001586                           777              
00001586  4CDF 0001                778              MOVEM.L (A7)+,D0
0000158A  4E75                     779              RTS 
0000158C                           780  
0000158C                           781  
0000158C                           782  
0000158C                           783  -------------------- end include --------------------
0000158C                           784              INCLUDE 'SCORE.X68'
0000158C                           785     
0000158C                           786  ; ------------------------------------------------------------------------------
0000158C                           787  SCOINIT
0000158C                           788  ; INICIALIZAR MARCADOR.
0000158C                           789  ; INPUT    : NONE 
0000158C                           790  ; OUTPUT   : NONE
0000158C                           791  ; MODIFIES : NONE
0000158C                           792  ; ------------------------------------------------------------------------------
0000158C  4E75                     793              RTS
0000158E                           794              
0000158E                           795  ; ------------------------------------------------------------------------------
0000158E                           796  SCOUPD
0000158E                           797  ; ACTUALIZAR MARCADOR.
0000158E                           798  ; INPUT    : NONE 
0000158E                           799  ; OUTPUT   : NONE
0000158E                           800  ; MODIFIES : NONE
0000158E                           801  ; ------------------------------------------------------------------------------
0000158E  4E75                     802              RTS
00001590                           803              
00001590                           804  ; ------------------------------------------------------------------------------
00001590                           805  SCOPLOT
00001590                           806  ; DIBUJAR MARCADOR.
00001590                           807  ; INPUT    : NONE 
00001590                           808  ; OUTPUT   : NONE
00001590                           809  ; MODIFIES : NONE
00001590                           810  ; ------------------------------------------------------------------------------
00001590  4E75                     811              RTS
00001592                           812  
00001592                           813  
00001592                           814  
00001592                           815  
00001592                           816  -------------------- end include --------------------
00001592                           817              INCLUDE 'MATRIZ.X68'
00001592                           818  ; ----------------------------------------------------------------------------
00001592                           819  ; MATRIZ
00001592                           820  ; ----------------------------------------------------------------------------
00001592                           821  
00001592                           822  ;-----------------------------------------------------------------------------
00001592                           823  MTZINIT
00001592                           824  ; INICIALIZA LA MATRIZ, AL PRINCIPIO ESTÁ VACÍA
00001592                           825  ; INPUT    : NONE
00001592                           826  ; OUTPUT   : NONE
00001592                           827  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001592                           828  ; ----------------------------------------------------------------------------
00001592                           829              
00001592  48A7 E080                830              MOVEM.W D0-D2/A0,-(A7)
00001596                           831              
00001596  41F9 000018B0            832              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
0000159C  303C 0300                833              MOVE.W #TCELDAS, D0    ; Número total de celdas
000015A0                           834  
000015A0                           835  CLNCLDS:
000015A0  4218                     836              CLR.B (A0)+            ; Coloca 0 en cada celda
000015A2  5340                     837              SUBI.W #1, D0          ; Decrementa el contador de celdas
000015A4  66FA                     838              BNE CLNCLDS            ; Repite hasta que esten vacías
000015A6                           839              
000015A6                           840              
000015A6  3239 0000189A            841              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
000015AC  3439 0000189C            842              MOVE.W  CBZPOSY, D2
000015B2  4EB9 0000160C            843              JSR     CINDMTRZ
000015B8  4EB9 00001646            844              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
000015BE                           845              
000015BE  3239 000018A6            846              MOVE.W  SGMPOSX, D1
000015C4  3439 000018A8            847              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
000015CA  4EB9 0000160C            848              JSR     CINDMTRZ
000015D0  4EB9 00001688            849              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
000015D6                           850              
000015D6  3239 000018A2            851              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
000015DC  3439 000018A4            852              MOVE.W  COLPOSY, D2
000015E2  4EB9 0000160C            853              JSR     CINDMTRZ
000015E8  4EB9 0000169E            854              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
000015EE                           855              
000015EE  3239 00001896            856              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
000015F4  3439 00001898            857              MOVE.W  MNZPOSY, D2
000015FA  4EB9 0000160C            858              JSR     CINDMTRZ
00001600  4EB9 000016B4            859              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
00001606                           860              
00001606                           861              
00001606  4C9F 0107                862              MOVEM.W (A7)+,D0-D2/A0
0000160A                           863  
0000160A  4E75                     864              RTS
0000160C                           865  
0000160C                           866  ;-----------------------------------------------------------------------------
0000160C                           867  CINDMTRZ
0000160C                           868  ; CALCULA EL ÍNDICE DE UNA CELDA
0000160C                           869  ; INPUT    : D1 = coordenada X pantalla, D2 = coordenada Y pantalla
0000160C                           870  ; OUTPUT   : D0 = índice de la celda en ESTDCLDS
0000160C                           871  ; MODIFIES : NONE
0000160C                           872  ; ----------------------------------------------------------------------------
0000160C                           873  
0000160C  48A7 7000                874               MOVEM.W D1-D3,-(A7)     ; Guarda los registros D1-D3 en la pila
00001610                           875  
00001610                           876              ; Divide X por SIZECLDA
00001610  3601                     877              MOVE.W  D1, D3          ; Copia X a D3
00001612  4241                     878              CLR.W   D1              ; Inicializa el cociente de X
00001614                           879  
00001614  B67C 0014                880  DIVX:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
00001618  6D00 000A                881              BLT     ENDDIVX         ; Si D3 < SIZECLDA, salta a ENDDIVX
0000161C  0443 0014                882              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
00001620  5241                     883              ADDQ.W  #1, D1          ; Incrementa el cociente de X
00001622  60F0                     884              BRA     DIVX            ; Repite el bucle
00001624                           885  
00001624                           886  ENDDIVX:
00001624                           887  
00001624                           888              ; Divide Y por SIZECLDA
00001624  3602                     889              MOVE.W  D2, D3          ; Copia Y a D3
00001626  4242                     890              CLR.W   D2              ; Inicializa el cociente de Y
00001628                           891  
00001628  B67C 0014                892  DIVY:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
0000162C  6D00 000A                893              BLT     ENDDIVY         ; Si D3 < SIZECLDA, salta a ENDDIVY
00001630  0443 0014                894              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
00001634  5242                     895              ADDQ.W  #1, D2          ; Incrementa el cociente de Y
00001636  60F0                     896              BRA     DIVY            ; Repite el bucle
00001638                           897  
00001638                           898  ENDDIVY:
00001638                           899  
00001638                           900              ; Calcula el índice
00001638  4240                     901              CLR.W   D0
0000163A  3002                     902              MOVE.W  D2, D0          ; D0 = Y_CELDA
0000163C  EB40                     903              ASL.W   #5, D0          ; D0 = Y_CELDA * NUMCLMNS (32 = 2^5)
0000163E  D041                     904              ADD.W   D1, D0          ; D0 = Y_CELDA * NUMCLMNS + X_CELDA
00001640                           905  
00001640  4C9F 000E                906              MOVEM.W (A7)+,D1-D3     ; Restaura los registros D1-D3 desde la pila
00001644                           907  
00001644  4E75                     908              RTS  
00001646                           909              
00001646                           910  ;-----------------------------------------------------------------------------
00001646                           911  CBZOCPD
00001646                           912  ; MARCA UNA CELDA COMO OCUPADA POR LA CABEZA
00001646                           913  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001646                           914  ; OUTPUT   : NONE
00001646                           915  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001646                           916  ; ----------------------------------------------------------------------------
00001646                           917  
00001646  48A7 0080                918              MOVEM.W A0,-(A7)
0000164A                           919  
0000164A  41F9 000018B0            920              LEA     ESTDCLDS, A0                ; Dirección de la matriz en A0
00001650  11B9 000018AA 0000       921              MOVE.B  TRZPLOT, (A0, D0.W)           ; Marca la celda como ocupada
00001658                           922              
00001658  4C9F 0100                923              MOVEM.W (A7)+,A0
0000165C                           924              
0000165C  4E75                     925              RTS
0000165E                           926              
0000165E                           927              
0000165E                           928              
0000165E                           929  ;-----------------------------------------------------------------------------
0000165E                           930  RSTCLD
0000165E                           931  ; RESTA 1 A LA CELDA PASADA POR PARÁMETRO
0000165E                           932  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000165E                           933  ; OUTPUT   : NONE
0000165E                           934  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000165E                           935  ; ----------------------------------------------------------------------------
0000165E                           936  
0000165E  48A7 0080                937              MOVEM.W A0,-(A7)
00001662                           938  
00001662  41F9 000018B0            939              LEA     ESTDCLDS, A0              ; Dirección de la matriz en A0
00001668  5330 0000                940              SUBQ.B   #1, (A0, D0.W)           ; Marca la celda como ocupada
0000166C                           941              
0000166C  4C9F 0100                942              MOVEM.W (A7)+,A0
00001670                           943              
00001670  4E75                     944              RTS
00001672                           945             
00001672                           946  ;-----------------------------------------------------------------------------
00001672                           947  MCLDVCIA
00001672                           948  ; MARCA UNA CELDA COMO VACÍA
00001672                           949  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001672                           950  ; OUTPUT   : NONE
00001672                           951  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001672                           952  ; ----------------------------------------------------------------------------
00001672                           953  
00001672  48A7 0080                954              MOVEM.W A0,-(A7)
00001676                           955  
00001676  41F9 000018B0            956              LEA ESTDCLDS, A0                ; Direccion de la matriz en A0
0000167C  11BC 0000 0000           957              MOVE.B #0, (A0, D0.W)           ; Marca la celda como vacía
00001682                           958              
00001682  4C9F 0100                959              MOVEM.W (A7)+,A0
00001686                           960              
00001686  4E75                     961              RTS
00001688                           962  
00001688                           963  ;-----------------------------------------------------------------------------
00001688                           964  SGMOCPD
00001688                           965  ; MARCA UNA CELDA COMO OCUPADA POR EL SEGMENTO
00001688                           966  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001688                           967  ; OUTPUT   : NONE
00001688                           968  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001688                           969  ; ----------------------------------------------------------------------------
00001688                           970  
00001688  48A7 0080                971              MOVEM.W A0,-(A7)
0000168C                           972  
0000168C  41F9 000018B0            973              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
00001692  11BC 0002 0000           974              MOVE.B #2, (A0, D0.W)           ; Marca la celda como ocupada
00001698                           975              
00001698  4C9F 0100                976              MOVEM.W (A7)+,A0
0000169C                           977              
0000169C  4E75                     978              RTS
0000169E                           979              
0000169E                           980  ;-----------------------------------------------------------------------------
0000169E                           981  COLOCPD
0000169E                           982  ; MARCA UNA CELDA COMO OCUPADA POR LA COLA
0000169E                           983  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000169E                           984  ; OUTPUT   : NONE
0000169E                           985  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000169E                           986  ; ----------------------------------------------------------------------------
0000169E                           987  
0000169E  48A7 0080                988              MOVEM.W A0,-(A7)
000016A2                           989  
000016A2  41F9 000018B0            990              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
000016A8  11BC 0001 0000           991              MOVE.B #1, (A0, D0.W)           ; Marca la celda como ocupada
000016AE                           992              
000016AE  4C9F 0100                993              MOVEM.W (A7)+,A0
000016B2                           994              
000016B2  4E75                     995              RTS
000016B4                           996  
000016B4                           997  
000016B4                           998  ;-----------------------------------------------------------------------------
000016B4                           999  MNZOCPD
000016B4                          1000  ; MARCA UNA CELDA COMO OCUPADA POR LA MANZANA
000016B4                          1001  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016B4                          1002  ; OUTPUT   : NONE
000016B4                          1003  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016B4                          1004  ; ----------------------------------------------------------------------------
000016B4                          1005  
000016B4  48A7 0080               1006              MOVEM.W A0,-(A7)
000016B8                          1007  
000016B8  41F9 000018B0           1008              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
000016BE  11BC 0004 0000          1009              MOVE.B #4, (A0, D0.W)           ; Marca la celda como ocupada
000016C4                          1010              
000016C4  4C9F 0100               1011              MOVEM.W (A7)+,A0
000016C8                          1012              
000016C8  4E75                    1013              RTS
000016CA                          1014  
000016CA                          1015              
000016CA                          1016  ;-----------------------------------------------------------------------------
000016CA                          1017  CNVICOOR
000016CA                          1018  ; Convierte un índice de celda a coordenadas de pantalla (X, Y)
000016CA                          1019  ; INPUT    : D0 = índice de la celda en ESTADO_CELDAS
000016CA                          1020  ; OUTPUT   : D1 = coordenada X, D2 = coordenada Y
000016CA                          1021  ; MODIFIES : NONE
000016CA                          1022  ; ----------------------------------------------------------------------------
000016CA                          1023  
000016CA  48A7 9800               1024              MOVEM.W D0/D3-D4,-(A7)
000016CE                          1025  
000016CE  3400                    1026              MOVE.W  D0,D2         ; Copia índice a D2 para calcular la fila
000016D0  EA4A                    1027              LSR.W   #5,D2         ; D2 = índice / NUM_COLUMNAS (32 = 2^5)
000016D2  3200                    1028              MOVE.W  D0,D1         ; Copia índice a D1 para calcular la columna
000016D4  C27C 001F               1029              AND.W   #$1F,D1       ; D1 = índice % NUM_COLUMNAS (31 = 0x1F) (CREO)
000016D8                          1030  
000016D8                          1031              ; Multiplica por TAMAÑO_CELDA = 10
000016D8  363C 0014               1032              MOVE.W  #SIZECLDA, D3
000016DC  3801                    1033              MOVE.W  D1,D4         ; Copia D1 para multiplicar por 10
000016DE  4241                    1034              CLR.W   D1            ; Inicializa resultado
000016E0                          1035  
000016E0                          1036  
000016E0                          1037  MULTLOOPX: 
000016E0  B87C 0000               1038              CMP.W   #0, D4        ; ¿Quedan iteraciones?
000016E4  6700 0008               1039              BEQ     ENDMULTX
000016E8  D243                    1040              ADD.W   D3,D1         ; Suma TAMANO_CELDA (10) repetidamente
000016EA                          1041  
000016EA  5344                    1042              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
000016EC  60F2                    1043              BRA     MULTLOOPX     ; Repite mientras no sea 0
000016EE                          1044  ENDMULTX: 
000016EE  3802                    1045              MOVE.W  D2,D4         ; Copia D2 para multiplicar por 10
000016F0  4242                    1046              CLR.W   D2            ; Inicializa resultado
000016F2                          1047  
000016F2                          1048  MULTLOOPY: 
000016F2  B87C 0000               1049              CMP.W   #0, D4        ; ¿Quedan iteraciones?
000016F6  6700 0008               1050              BEQ     ENDMULTY
000016FA  D443                    1051              ADD.W   D3,D2         ; Suma TAMANO_CELDA (10) repetidamente
000016FC  5344                    1052              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
000016FE  60F2                    1053              BRA     MULTLOOPY     ; Repite mientras no sea 0
00001700                          1054  ENDMULTY:
00001700  4C9F 0019               1055              MOVEM.W (A7)+,D0/D3-D4
00001704                          1056  
00001704  4E75                    1057              RTS
00001706                          1058  
00001706                          1059  ; ----------------------------------------------------------------------------
00001706                          1060  CHECKCLD
00001706                          1061  ; INPUT: D0 = índice de la celda
00001706                          1062  ; OUTPUT: D0 = 0 si está vacía, 1 si está ocupada
00001706                          1063  ; MODIFIES: Ninguno
00001706                          1064  ; ----------------------------------------------------------------------------
00001706                          1065  
00001706  41F9 000018B0           1066              LEA     ESTDCLDS, A0    ; Carga la dirección de la matriz ESTDCLDS
0000170C  1230 0000               1067              MOVE.B  (A0, D0.W),D1   ; Carga el estado de la celda en D1
00001710  B23C 0000               1068              CMP.B   #0, D1          ; Compara si está vacía (0)
00001714  6700 0008               1069              BEQ     CLDFREE         ; Si está vacía
00001718  303C 0001               1070              MOVE.W  #1, D0          ; Si está ocupada, devuelve 1 (ocupada)
0000171C                          1071  
0000171C  4E75                    1072              RTS
0000171E                          1073  
0000171E                          1074  CLDFREE:
0000171E  303C 0000               1075              MOVE.W  #0, D0                 ; Devuelve 0 (libre)
00001722                          1076  
00001722  4E75                    1077              RTS
00001724                          1078  
00001724                          1079  
00001724                          1080  ;-----------------------------------------------------------------------------
00001724                          1081  FONPLOT
00001724                          1082  ; DIBUJADO DEL FONDO
00001724                          1083  ; INPUT    : NONE
00001724                          1084  ; OUTPUT   : NONE
00001724                          1085  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001724                          1086  ; ----------------------------------------------------------------------------
00001724                          1087  
00001724  3F00                    1088              MOVE.W  D0,-(A7)
00001726  3003                    1089              MOVE.W  D3,D0
00001728  4EB8 16CA               1090              JSR     CNVICOOR
0000172C  2F01                    1091              MOVE.L  D1,-(A7)
0000172E                          1092              
0000172E  103C 0050               1093              MOVE.B  #80,D0
00001732  223C 0090EE90           1094              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001738  4E4F                    1095              TRAP    #15
0000173A                          1096              
0000173A  103C 0051               1097              MOVE.B  #81,D0
0000173E  223C 0090EE90           1098              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001744  4E4F                    1099              TRAP    #15
00001746                          1100              
00001746  103C 0057               1101              MOVE.B  #87,D0
0000174A  221F                    1102              MOVE.L  (A7)+,D1
0000174C  3F03                    1103              MOVE.W  D3,-(A7)
0000174E  3601                    1104              MOVE.W  D1,D3
00001750  0643 0014               1105              ADD.W   #SIZECLDA,D3
00001754  3802                    1106              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001756  0644 0014               1107              ADD.W   #SIZECLDA,D4
0000175A  4E4F                    1108              TRAP    #15                     
0000175C                          1109                          
0000175C  361F                    1110              MOVE.W  (A7)+,D3  
0000175E  301F                    1111              MOVE.W  (A7)+,D0
00001760  4E75                    1112              RTS         
00001762                          1113  
00001762                          1114  
00001762                          1115  
00001762                          1116  ;-----------------------------------------------------------------------------
00001762                          1117  MTZUPD
00001762                          1118  ; ACTUALIZA LA MATRIZ CASILLA A CASILLA
00001762                          1119  ; INPUT    : NONE
00001762                          1120  ; OUTPUT   : NONE
00001762                          1121  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001762                          1122  ; ----------------------------------------------------------------------------
00001762                          1123  
00001762                          1124  
00001762  48A7 E080               1125              MOVEM.W D0-D2/A0,-(A7)
00001766                          1126              
00001766  41F9 000018B0           1127              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
0000176C  303C 0300               1128              MOVE.W #TCELDAS, D0    ; Número total de celdas
00001770                          1129  
00001770                          1130  .CLNCLDS:
00001770  4218                    1131              CLR.B (A0)+            ; Coloca 0 en cada celda
00001772  5340                    1132              SUBI.W #1, D0          ; Decrementa el contador de celdas
00001774  66FA                    1133              BNE .CLNCLDS           ; Repite hasta que esten vacías
00001776                          1134              
00001776                          1135              
00001776  3239 0000189A           1136              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
0000177C  3439 0000189C           1137              MOVE.W  CBZPOSY, D2
00001782  4EB8 160C               1138              JSR     CINDMTRZ
00001786  4EB8 1646               1139              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
0000178A                          1140              
0000178A  3239 000018A6           1141              MOVE.W  SGMPOSX, D1
00001790  3439 000018A8           1142              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
00001796  4EB8 160C               1143              JSR     CINDMTRZ
0000179A  4EB8 1688               1144              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
0000179E                          1145              
0000179E  3239 000018A2           1146              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
000017A4  3439 000018A4           1147              MOVE.W  COLPOSY, D2
000017AA  4EB8 160C               1148              JSR     CINDMTRZ
000017AE  4EB8 169E               1149              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
000017B2                          1150              
000017B2  3239 00001896           1151              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
000017B8  3439 00001898           1152              MOVE.W  MNZPOSY, D2
000017BE  4EB8 160C               1153              JSR     CINDMTRZ
000017C2  4EB8 16B4               1154              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
000017C6                          1155              
000017C6                          1156              
000017C6  4C9F 0107               1157              MOVEM.W (A7)+,D0-D2/A0
000017CA                          1158  
000017CA  4E75                    1159              RTS
000017CC                          1160  
000017CC                          1161  
000017CC                          1162  
000017CC                          1163  ;-----------------------------------------------------------------------------
000017CC                          1164  MTZPLOT
000017CC                          1165  ; DIBUJA LA MATRIZ CASILLA A CASILLA
000017CC                          1166  ; INPUT    : NONE
000017CC                          1167  ; OUTPUT   : NONE
000017CC                          1168  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000017CC                          1169  ; ----------------------------------------------------------------------------
000017CC  48E7 F080               1170              MOVEM.L D0-D3/A0,-(A7)
000017D0                          1171  
000017D0  4240                    1172              CLR.W   D0
000017D2  4243                    1173              CLR.W   D3
000017D4  41F9 000018B0           1174              LEA     ESTDCLDS, A0            ; Apunta al inicio de ESTDCLDS
000017DA  303C 0300               1175              MOVE.W  #TCELDAS, D0            ; Número total de celdas
000017DE  363C 0000               1176              MOVE.W  #0,D3                   ; LO UTILIZAMOS PARA SABER EL INDICE EN EL QUE NOS ENCONTRAMOS
000017E2  4241                    1177              CLR.W   D1
000017E4  4242                    1178              CLR.W   D2
000017E6                          1179              
000017E6                          1180  
000017E6                          1181  PLOTCLDS:
000017E6  1218                    1182              MOVE.B  (A0)+,D1                ; MOVEMOS EL VALOR DE LA CELDA A D1
000017E8  B23C 0000               1183              CMP.B   #0,D1
000017EC  6700 0036               1184              BEQ     PLOTVAC                 ; SALTA A DIBUJAR POSICIÓN VACÍA
000017F0  B23C 0001               1185              CMP.B   #1,D1 
000017F4  6700 0034               1186              BEQ     PLOTCOL                 ; SALTA A DIBUJAR COLA
000017F8  B23C 0002               1187              CMP.B   #2,D1
000017FC  6700 0032               1188              BEQ     PLOTSEG                 ; SALTA A DIBUJAR SEGMENTO
00001800  B239 000018AA           1189              CMP.B   TRZPLOT,D1
00001806  6700 0016               1190              BEQ     PLOTCBZ                 ; SALTA A DIBUJAR CABEZA
0000180A  B23C 0004               1191              CMP.B   #4,D1                 
0000180E  6700 0026               1192              BEQ     PLOTAPPLE               ; SALTA A DIBUJAR MANZANA
00001812                          1193    
00001812                          1194  DONEPLOT            
00001812  5243                    1195              ADDQ    #1,D3                   ; AUMENTAMOS EL INDICE DE CELDA PARA LA SIGUIENTE
00001814  5340                    1196              SUBI.W  #1, D0                  ; Decrementa el contador de celdas
00001816  66CE                    1197              BNE     PLOTCLDS                ; Repite hasta que esten vacías
00001818  4CDF 010F               1198              MOVEM.L (A7)+,D0-D3/A0
0000181C  4E75                    1199              RTS
0000181E                          1200  PLOTCBZ:
0000181E  4EB8 12F4               1201              JSR     HEADPLOT
00001822  60EE                    1202              BRA     DONEPLOT
00001824                          1203  
00001824                          1204  PLOTVAC:    
00001824  4EB8 1724               1205              JSR     FONPLOT
00001828  60E8                    1206              BRA     DONEPLOT                ; DIBUJADO HECHO 
0000182A                          1207  
0000182A                          1208  PLOTCOL:   
0000182A  4EB8 142C               1209              JSR     TAILPLOT 
0000182E  60E2                    1210              BRA     DONEPLOT                ; DIBUJADO HECHO 
00001830                          1211              
00001830                          1212  PLOTSEG:    
00001830  4EB8 13B8               1213              JSR     SEGPLOT
00001834  60DC                    1214              BRA     DONEPLOT                ; DIBUJADO HECHO    
00001836                          1215  
00001836                          1216  PLOTAPPLE:
00001836  4EB8 14DC               1217              JSR     APPLEPLOT
0000183A  60D6                    1218              BRA     DONEPLOT            
0000183C                          1219  
0000183C                          1220  
0000183C                          1221  
0000183C                          1222  
0000183C                          1223  
0000183C                          1224  
0000183C                          1225  
0000183C                          1226  
0000183C                          1227  
0000183C                          1228  
0000183C                          1229  
0000183C                          1230  
0000183C                          1231  
0000183C                          1232  
0000183C                          1233  -------------------- end include --------------------
0000183C                          1234  START:
0000183C                          1235                  
0000183C                          1236  ; --- INIZIALIZACIÓN ---------------------------------------------------------
0000183C                          1237  
0000183C  4EB8 1000               1238              JSR     SYSINIT
00001840  4EB8 10A6               1239              JSR     UTLINIT
00001844  4EB8 1066               1240              JSR     KBDINIT
00001848  4EB8 1592               1241              JSR     MTZINIT
0000184C  4EB8 11DA               1242              JSR     HEADINIT                
00001850  4EB8 1378               1243              JSR     SEGINIT
00001854  4EB8 13F8               1244              JSR     TAILINIT
00001858  4EB8 158C               1245              JSR     SCOINIT
0000185C  4EB8 146C               1246              JSR     APPLEINIT
00001860                          1247              
00001860                          1248  
00001860                          1249  .LOOP
00001860                          1250  
00001860                          1251  ; --- ACTUALIZAR -------------------------------------------------------------
00001860                          1252  
00001860                          1253  ; LEER DISPOSITIVOS DE ENTRADA
00001860                          1254  
00001860  4E41                    1255              TRAP    #1
00001862                          1256  
00001862                          1257  ; ACTUALIZAR LÓGICA DEL JUEGO
00001862                          1258              
00001862  4EB8 140A               1259              JSR     TAILUPD
00001866  4EB8 138A               1260              JSR     SEGUPD
0000186A  4EB8 1208               1261              JSR     HEADUPD
0000186E                          1262              ;JSR     APPLEUPD  
0000186E  4EB8 1762               1263              JSR     MTZUPD
00001872                          1264              
00001872                          1265  ; --- SINCRONIZACIÓN ---------------------------------------------------------
00001872                          1266              ; THE FOLLOWING SYNC STRATEGY IS ****WRONG****
00001872  103C 0017               1267              MOVE.B  #23,D0
00001876  7201                    1268              MOVE.L  #1,D1
00001878  4E4F                    1269              TRAP    #15
0000187A                          1270  
0000187A                          1271  
0000187A                          1272  ;---DIBUJAR-------------------------------------------------------------------
0000187A  4EB8 12F4               1273               JSR     HEADPLOT
0000187E  4EB8 13B8               1274               JSR     SEGPLOT
00001882  4EB8 142C               1275               JSR     TAILPLOT
00001886  4EB8 14DC               1276               JSR     APPLEPLOT
0000188A  4EB8 17CC               1277               JSR     MTZPLOT
0000188E                          1278              
0000188E  4E40                    1279              TRAP    #0                      ; ACTUALIZA DOBLE BUFFER
00001890                          1280  
00001890                          1281  
00001890  60CE                    1282              BRA     .LOOP
00001892                          1283  
00001892  FFFF FFFF               1284              SIMHALT
00001896                          1285              
00001896                          1286              INCLUDE 'VARS.X68'
00001896                          1287  ; ----------------------------------------------------------------------------
00001896                          1288  ; VARIABLES DEL JUEGO
00001896                          1289  ; ----------------------------------------------------------------------------
00001896                          1290  
00001896                          1291  ; --- VARIABLES DE LA MANZANA ------------------------------------------------
00001896                          1292  
00001896                          1293  MNZPOSX     DS.W    1                       ; COORDENADA X DE LA MANZANA
00001898                          1294  MNZPOSY     DS.W    1                       ; COORDENADA Y DE LA MANZANA
0000189A                          1295  
0000189A                          1296  ; --- VARIABLES DE LA SERPIENTE ----------------------------------------------
0000189A                          1297  
0000189A                          1298  CBZPOSX     DS.W    1                       ; COORDENADA X CABEZA
0000189C                          1299  CBZPOSY     DS.W    1                       ; COORDENADA Y CABEZA
0000189E                          1300  CBZVELX     DS.W    1                       ; VELOCIDAD X CABEZA
000018A0                          1301  CBZVELY     DS.W    1                       ; VELOCIDAD Y CABEZA
000018A2                          1302  COLPOSX     DS.W    1                       ; COORDENADA X COLA
000018A4                          1303  COLPOSY     DS.W    1                       ; COORDENADA Y COLA
000018A6                          1304  SGMPOSX     DS.W    1                       ; COORDENADA X SEGMENTO
000018A8                          1305  SGMPOSY     DS.W    1                       ; COORDENADA Y SEGMENTO
000018AA                          1306  TRZPLOT     DS.B    1                       ; NÚMERO DE TROZOS A DIBUJAR
000018AB                          1307  
000018AB                          1308  ; --- VARIABLES DEL MARCADOR -------------------------------------------------
000018AB                          1309  
000018AC                          1310  JGOPNTS     DS.W    1                       ; PUNTUACIÓN DEL JUEGO
000018AE                          1311  
000018AE                          1312  
000018AE                          1313  
000018AE                          1314  
000018AE                          1315  -------------------- end include --------------------
000018AE                          1316              INCLUDE 'LIB/UTLVARS.X68'
000018AE                          1317  ; =============================================================================
000018AE                          1318  ; UTILITY VARIABLES
000018AE                          1319  ; =============================================================================
000018AE                          1320  
000018AE                          1321  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000018B0                          1322              DS.W    0
000018B0                          1323  -------------------- end include --------------------
000018B0                          1324              INCLUDE 'SYSVARS.X68'
000018B0                          1325  ; ----------------------------------------------------------------------------
000018B0                          1326  ; VARIABLES DEL SISTEMA
000018B0                          1327  ; ----------------------------------------------------------------------------
000018B0                          1328  
000018B0                          1329  ; --- VARIABLES DE LA MATRIZ -------------------------------------------------
000018B0                          1330  
000018B0                          1331  ESTDCLDS    DS.B    TCELDAS                 ; ESTADO DE LAS CELDAS 0=VACÍO  1=COLA   2=SEGMENTO  TRZPLOT=CABEZA  4?=MANZANA    
00001BB0                          1332  ESTDCBZ     DS.B    1                       ; 0= DERECHA, 1=ARRIBA, 2=IZQUIERDA, 3=ABAJO
00001BB1                          1333  
00001BB1                          1334  ; --- VARIABLES DE TECLADO ---------------------------------------------------
00001BB1                          1335  
00001BB1                          1336  KBDVAL      DS.B    1
00001BB2                          1337  KBDEDGE     DS.B    1                       ; KEY EDGE
00001BB4                          1338  LASTKEY     DS.L    1                       
00001BB8                          1339  
00001BB8                          1340  
00001BB8                          1341  
00001BB8                          1342  
00001BB8                          1343  
00001BB8                          1344  
00001BB8                          1345  
00001BB8                          1346  
00001BB8                          1347  
00001BB8                          1348  
00001BB8                          1349  
00001BB8                          1350  
00001BB8                          1351  
00001BB8                          1352  
00001BB8                          1353  
00001BB8                          1354  
00001BB8                          1355  -------------------- end include --------------------
00001BB8                          1356      
00001BB8                          1357      
00001BB8                          1358              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
APPLEINIT           146C
APPLEPLOT           14DC
APPLEUPD            149E
CBZFCOL             AA00
CBZHEIGH            14
CBZOCPD             1646
CBZPCOL             FF00
CBZPOSX             189A
CBZPOSY             189C
CBZVEL              14
CBZVELX             189E
CBZVELY             18A0
CBZWIDTH            14
CHCKUPDT            14B6
CHECK               1478
CHECKCLD            1706
CINDMTRZ            160C
CLDFREE             171E
CLNCLDS             15A0
CNVICOOR            16CA
COLFCOL             AA00
COLFND              90EE90
COLHEIGH            A
COLOCPD             169E
COLPCOL             FF00
COLPOSX             18A2
COLPOSY             18A4
COLWIDTH            A
DIVX                1614
DIVY                1628
DONEPLOT            1812
ENDDIVX             1624
ENDDIVY             1638
ENDMULTX            16EE
ENDMULTY            1700
ESTDCBZ             1BB0
ESTDCLDS            18B0
FIN                 12EE
FONPLOT             1724
GENPOSMNZ           155A
HEADINIT            11DA
HEADPLOT            12F4
HEADUPD             1208
JGOPNTS             18AC
KBDDOWN             28
KBDEDGE             1BB2
KBDINIT             1066
KBDLEFT             25
KBDRIGHT            27
KBDUP               26
KBDUPD              106E
KBDUPD:LOOP         1082
KBDVAL              1BB1
LASTKEY             1BB4
LNGINI              1
MARKMNZ             1490
MAXSGM              1
MCLDVCIA            1672
MNZFCOL             FF
MNZHEIGH            14
MNZOCPD             16B4
MNZPCOL             AAFF
MNZPOSX             1896
MNZPOSY             1898
MNZWIDTH            14
MTZINIT             1592
MTZPLOT             17CC
MTZUPD              1762
MTZUPD:CLNCLDS      1770
MULTLOOPX           16E0
MULTLOOPY           16F2
NEWMNZ              14CE
NUMCLMNS            20
NUMFILAS            18
OJOFCOL             FFFFFF
OJOHEIGH            A
OJOPCOL             0
OJOWIDTH            A
PANHEIGH            1E0
PANWIDTH            280
PLOTAPPLE           1836
PLOTCBZ             181E
PLOTCLDS            17E6
PLOTCOL             182A
PLOTSEG             1830
PLOTVAC             1824
PNTSFCOL            1
PNTSTEXT            1
RSTCLD              165E
SCOINIT             158C
SCOPLOT             1590
SCOUPD              158E
SCRINIT             101E
SCRPLOT             104C
SEGINIT             1378
SEGPLOT             13B8
SEGUPD              138A
SGMFCOL             AA00
SGMHEIGH            14
SGMOCPD             1688
SGMPCOL             FF00
SGMPOSX             18A6
SGMPOSY             18A8
SGMWIDTH            14
SIGABA              12CA
SIGARR              1282
SIGDER              125E
SIGIZQ              12A6
SIZECLDA            14
START               183C
START:LOOP          1860
SYSINIT             1000
TAILINIT            13F8
TAILPLOT            142C
TAILUPD             140A
TCELDAS             300
TRZPLOT             18AA
UTLINIT             10A6
UTLRAND             10BC
UTLRAND:RANDVEC     10DA
UTLRNDIX            18AE
