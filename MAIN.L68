000018A8 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 19/12/2024 11:35:44

00000000                             1  *-----------------------------------------------------------------------------
00000000                             2  * Title      : MAIN
00000000                             3  * Written by :
00000000                             4  * Date       :
00000000                             5  * Description:
00000000                             6  *-----------------------------------------------------------------------------
00000000                             7  
00001000                             8              ORG    $1000
00001000                             9              
00001000                            10              INCLUDE 'CONST.X68'
00001000                            11  ; ----------------------------------------------------------------------------
00001000                            12  ; CONSTANTES DEL JUEGO
00001000                            13  ; ----------------------------------------------------------------------------
00001000                            14     
00001000                            15  ; --- CONSTANTES DE LA MANZANA -----------------------------------------------
00001000                            16  
00001000  =00000014                 17  MNZWIDTH    EQU     20                      ; ANCHURA DE LA MANZANA (a determinar)
00001000  =00000014                 18  MNZHEIGH    EQU     20                      ; ALTURA DE LA MANZANA (a determinar)
00001000  =0000AAFF                 19  MNZPCOL     EQU     $0000AAFF               ; COLOR CONTORNO MANZANA (a determinar)
00001000  =000000FF                 20  MNZFCOL     EQU     $000000FF               ; COLOR RELLENO MANZANA (a determinar)
00001000                            21  
00001000                            22  ; --- CONSTANTES DE LA SERPIENTE ---------------------------------------------
00001000                            23  
00001000  =00000001                 24  MAXSGM      EQU     1                       ; TAMAÑO MÁXIMO DE SEGMENTOS (a determinar)
00001000  =00000001                 25  LNGINI      EQU     1                       ; LONGITUD INICIAL SERPIENTE (a determinar)
00001000  =00000014                 26  SGMWIDTH    EQU     20                      ; ANCHURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 27  SGMHEIGH    EQU     20                      ; ALTURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 28  CBZVEL      EQU     20                      ; VELOCIDAD DE LA CABEZA (a determinar)
00001000  =0000FF00                 29  SGMPCOL     EQU     $0000FF00               ; COLOR CONTORNO SEGMENTO (PROVISIONAL)
00001000  =0000AA00                 30  SGMFCOL     EQU     $0000AA00               ; COLOR RELLENO SEGMENTO (PROVISIONAL)
00001000  =0000000A                 31  COLWIDTH    EQU     10                      ; ANCHURA DE LA COLA (PROVISIONAL)
00001000  =0000000A                 32  COLHEIGH    EQU     10                      ; ALTURA DE LA COLA (PROVISIONAL)
00001000  =0000FF00                 33  COLPCOL     EQU     $0000FF00               ; COLOR CONTORNO COLA (PROVISIONAL)
00001000  =0000AA00                 34  COLFCOL     EQU     $0000AA00               ; COLOR RELLENO COLA (PROVISIONAL)
00001000  =00000014                 35  CBZWIDTH    EQU     20                      ; ANCHURA DE LA CABEZA (PROVISIONAL)
00001000  =00000014                 36  CBZHEIGH    EQU     20                      ; ALTURA DE LA CABEZA (PROVISIONAL)
00001000  =0000FF00                 37  CBZPCOL     EQU     $0000FF00               ; COLOR CONTORNO CABEZA (PROVISIONAL)
00001000  =0000AA00                 38  CBZFCOL     EQU     $0000AA00               ; COLOR RELLENO CABEZA (PROVISIONAL)
00001000  =0000000A                 39  OJOWIDTH    EQU     10                      ; ANCHURA DE OJO DE SERPIENTE
00001000  =0000000A                 40  OJOHEIGH    EQU     10                      ; ALTURA DE OJO DE SERPIENTE
00001000  =00000000                 41  OJOPCOL     EQU     $00000000               ; COLOR CONTORNO OJO
00001000  =00FFFFFF                 42  OJOFCOL     EQU     $00FFFFFF               ; COLOR RELLENO OJO
00001000                            43  
00001000                            44  
00001000                            45  
00001000                            46  ; --- CONSTANTES MARCADOR ----------------------------------------------------
00001000                            47  
00001000  =00000001                 48  PNTSFCOL    EQU     1                       ; COLOR FONDO MARCADOR (a determinar)
00001000  =00000001                 49  PNTSTEXT    EQU     1                       ; COORDENADAS DEL MARCADOR (a determinar)
00001000                            50  
00001000                            51  
00001000                            52  
00001000                            53  
00001000                            54  
00001000                            55  
00001000                            56  
00001000                            57  -------------------- end include --------------------
00001000                            58              INCLUDE 'SYSCONST.X68'
00001000                            59  ; ----------------------------------------------------------------------------
00001000                            60  ; CONSTANTES DEL SISTEMA
00001000                            61  ; ----------------------------------------------------------------------------
00001000                            62  
00001000                            63  ; ---CONSTANTES DE LA PANTALLA------------------------------------------------
00001000                            64  
00001000  =00000280                 65  PANWIDTH    EQU     640                     ; ANCHO DE LA PANTALLA
00001000  =000001E0                 66  PANHEIGH    EQU     480                     ; ALTURA DE LA PANTALLA
00001000  =0090EE90                 67  COLFND      EQU     $90EE90                 ; COLOR DEL FONDO DE LA PANTALLA
00001000                            68  
00001000                            69  ; ---CONSTANTES DE LA MATRIZ--------------------------------------------------
00001000                            70  
00001000  =00000014                 71  SIZECLDA    EQU     20                      ; TAMAÑO DE CADA CELDA EN PIXELES
00001000  =00000020                 72  NUMCLMNS    EQU     32                      ; COLUMNAS DE CELDAS (640/10)
00001000  =00000018                 73  NUMFILAS    EQU     24                      ; FILAS DE CELDAS (480/10)
00001000  =00000300                 74  TCELDAS     EQU     768                     ; TOTAL DE CELDAS (64 * 48)
00001000                            75  
00001000                            76  ; ---CÓDIGOS DE TECLADO-------------------------------------------------------
00001000                            77  
00001000  =00000025                 78  KBDLEFT     EQU     $25
00001000  =00000026                 79  KBDUP       EQU     $26
00001000  =00000027                 80  KBDRIGHT    EQU     $27
00001000  =00000028                 81  KBDDOWN     EQU     $28
00001000                            82  
00001000                            83  
00001000                            84  
00001000                            85  
00001000                            86  
00001000                            87  
00001000                            88  
00001000                            89  -------------------- end include --------------------
00001000                            90              INCLUDE 'SYSTEM.X68'
00001000                            91   
00001000                            92   
00001000                            93  SYSINIT
00001000                            94  ; INICIA EL  SISTEMA
00001000                            95  ; INPUT    : NONE
00001000                            96  ; OUTPUT   : NONE
00001000                            97  ; MODIFIES : NONE
00001000                            98  ; ----------------------------------------------------------------------------
00001000  4EB9 0000101E             99              JSR     SCRINIT
00001006                           100              
00001006  21FC 0000104C 0080       101              MOVE.L  #SCRPLOT,($80)
0000100E  21FC 00001074 0084       102              MOVE.L  #KBDUPD,($84)
00001016                           103              
00001016  40E7                     104              MOVE.W  SR,-(A7)
00001018  0257 DFFF                105              ANDI.W  #$DFFF,(A7)
0000101C                           106              
0000101C  4E73                     107              RTE
0000101E                           108              
0000101E                           109  ; ------------------------------------------------------------------------------
0000101E                           110  SCRINIT
0000101E                           111  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
0000101E                           112  ; ENABLE DOUBLE BUFFER.
0000101E                           113  ; INPUT    : NONE
0000101E                           114  ; OUTPUT   : NONE
0000101E                           115  ; MODIFIES : NONE
0000101E                           116  ; ------------------------------------------------------------------------------
0000101E                           117  
0000101E  48E7 C000                118              MOVEM.L D0-D1,-(A7)
00001022                           119  
00001022                           120              ; SET SCREEN RESOLUTION
00001022  103C 0021                121              MOVE.B  #33,D0
00001026  223C 028001E0            122              MOVE.L  #PANWIDTH<<16|PANHEIGH,D1
0000102C  4E4F                     123              TRAP    #15
0000102E                           124              
0000102E                           125              ; SET WINDOWED MODE
0000102E  7201                     126              MOVE.L  #1,D1
00001030  4E4F                     127              TRAP    #15
00001032                           128              
00001032                           129              ; CLEAR SCREEN
00001032  103C 000B                130              MOVE.B  #11,D0
00001036  323C FF00                131              MOVE.W  #$FF00,D1
0000103A  4E4F                     132              TRAP    #15
0000103C                           133              
0000103C                           134              ; ENABLE DOUBLE BUFFER
0000103C  103C 005C                135              MOVE.B  #92,D0
00001040  123C 0011                136              MOVE.B  #17,D1
00001044  4E4F                     137              TRAP    #15
00001046                           138              
00001046  4CDF 0003                139              MOVEM.L (A7)+,D0-D1
0000104A                           140              
0000104A  4E75                     141              RTS    
0000104C                           142  
0000104C                           143  ; ------------------------------------------------------------------------------
0000104C                           144  SCRPLOT
0000104C                           145  ; UPDATES DOUBLE BUFFER
0000104C                           146  ; INPUT    : NONE
0000104C                           147  ; OUTPUT   : NONE
0000104C                           148  ; MODIFIES : NONE
0000104C                           149  ; ------------------------------------------------------------------------------
0000104C                           150  
0000104C  48A7 C000                151              MOVEM.W D0-D1,-(A7)
00001050                           152              
00001050                           153              ; SWITCH BUFFERS
00001050  103C 005E                154              MOVE.B  #94,D0
00001054  4E4F                     155              TRAP    #15
00001056                           156              
00001056                           157              ; CLEAR HIDDEN BUFFER
00001056  103C 000B                158              MOVE.B  #11,D0
0000105A  323C FF00                159              MOVE.W  #$FF00,D1
0000105E  4E4F                     160              TRAP    #15
00001060                           161              
00001060  4C9F 0003                162              MOVEM.W (A7)+,D0-D1
00001064                           163              
00001064  4E73                     164              RTE
00001066                           165          
00001066                           166  ; ------------------------------------------------------------------------------
00001066                           167  KBDINIT
00001066                           168  ; INIT KEYBOARD
00001066                           169  ; INPUT    : NONE
00001066                           170  ; OUTPUT   : NONE
00001066                           171  ; MODIFIES : NONE
00001066                           172  ; ------------------------------------------------------------------------------
00001066  4239 00001C1D            173              CLR.B   (KBDVAL)
0000106C  4239 00001C1E            174              CLR.B   (KBDEDGE)
00001072  4E75                     175              RTS
00001074                           176  
00001074                           177  ; ------------------------------------------------------------------------------
00001074                           178  KBDUPD
00001074                           179  ; UPDATE KEYBOARD INFO.  
00001074                           180  ; 7 -> PAUSE
00001074                           181  ; 6 -> FIRE 3
00001074                           182  ; 5 -> FIRE 2
00001074                           183  ; 4 -> FIRE 1
00001074                           184  ; 3 -> DOWN
00001074                           185  ; 2 -> RIGHT
00001074                           186  ; 1 -> UP
00001074                           187  ; 0 -> LEFT
00001074                           188  ; INPUT    : NONE
00001074                           189  ; OUTPUT   : NONE
00001074                           190  ; MODIFIES : NONE
00001074                           191  ; ------------------------------------------------------------------------------
00001074                           192  
00001074  48E7 F000                193              MOVEM.L D0-D3,-(A7)
00001078                           194  
00001078                           195              ; READ FIRST PART
00001078  103C 0013                196              MOVE.B  #19,D0
0000107C  223C 25262728            197              MOVE.L  #KBDLEFT<<24|KBDUP<<16|KBDRIGHT<<8|KBDDOWN,D1
00001082  4E4F                     198              TRAP    #15
00001084  23C1 00001C20            199              MOVE.L  D1,(LASTKEY)
0000108A                           200            
0000108A                           201              ; CONVERT TO DESIRED FORMAT
0000108A  363C 0003                202              MOVE.W  #3,D3
0000108E  E189                     203  .LOOP       LSL.L   #8,D1
00001090  E312                     204              ROXL.B  #1,D2
00001092  51CB FFFA                205              DBRA.W  D3,.LOOP
00001096                           206              
00001096                           207              ; COMPUTE KBDEDGE
00001096  1039 00001C1D            208              MOVE.B  (KBDVAL),D0
0000109C  4600                     209              NOT.B   D0
0000109E  C002                     210              AND.B   D2,D0
000010A0  13C0 00001C1E            211              MOVE.B  D0,(KBDEDGE)
000010A6                           212              
000010A6                           213              ; STORE KBDVAL
000010A6  13C2 00001C1D            214              MOVE.B  D2,(KBDVAL)
000010AC                           215              
000010AC  4240                     216              CLR.W   D0
000010AE  2039 00001C20            217              MOVE.L  (LASTKEY),D0
000010B4  B0BC 000000FF            218              CMP.L   #$000000FF,D0
000010BA  6700 0038                219              BEQ     IZQ
000010BE  B0BC 0000FF00            220              CMP.L   #$0000FF00,D0
000010C4  6700 0022                221              BEQ     ARR
000010C8  B0BC 00FF0000            222              CMP.L   #$00FF0000,D0
000010CE  6700 000C                223              BEQ     DER
000010D2  B0BC FF000000            224              CMP.L   #$FF000000,D0
000010D8  6700 0026                225              BEQ     ABA
000010DC                           226              
000010DC  33FC 0000 00001C1C       227  DER:        MOVE.W  #0,ESTDCBZ
000010E4  6000 0026                228              BRA     CONTINU
000010E8                           229              
000010E8  33FC 0001 00001C1C       230  ARR:        MOVE.W  #1,ESTDCBZ
000010F0  6000 001A                231              BRA     CONTINU
000010F4                           232  
000010F4  33FC 0002 00001C1C       233  IZQ:        MOVE.W  #2,ESTDCBZ
000010FC  6000 000E                234              BRA     CONTINU                    
00001100                           235  
00001100  33FC 0003 00001C1C       236  ABA:        MOVE.W  #3,ESTDCBZ
00001108  6000 0002                237              BRA     CONTINU
0000110C                           238  
0000110C                           239  
0000110C                           240      
0000110C                           241  CONTINU:
0000110C                           242              
0000110C  4CDF 000F                243              MOVEM.L (A7)+,D0-D3
00001110                           244  
00001110  4E73                     245              RTE
00001112                           246  
00001112                           247  
00001112                           248  
00001112                           249  -------------------- end include --------------------
00001112                           250              INCLUDE 'LIB/UTLCODE.X68'
00001112                           251  ; =============================================================================
00001112                           252  ; UTILITY CODE
00001112                           253  ; =============================================================================
00001112                           254  
00001112                           255  ; -----------------------------------------------------------------------------
00001112                           256  UTLINIT
00001112                           257  ; INITIALIZES UTILITY CODE
00001112                           258  ; INPUT    - NONE
00001112                           259  ; OUTPUT   - NONE
00001112                           260  ; MODIFIES - NONE
00001112                           261  ; -----------------------------------------------------------------------------
00001112  48E7 C000                262              MOVEM.L D0-D1,-(A7)
00001116  103C 0008                263              MOVE.B  #8,D0
0000111A  4E4F                     264              TRAP    #15
0000111C  13C1 0000191A            265              MOVE.B  D1,(UTLRNDIX)
00001122  4CDF 0003                266              MOVEM.L (A7)+,D0-D1
00001126  4E75                     267              RTS
00001128                           268  
00001128                           269  ; -----------------------------------------------------------------------------
00001128                           270  UTLRAND
00001128                           271  ; PROVIDES A PSEUDO-RANDOM BYTE
00001128                           272  ; INPUT    - NONE
00001128                           273  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001128                           274  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001128                           275  ; -----------------------------------------------------------------------------
00001128  2F08                     276              MOVE.L  A0,-(A7)
0000112A  41F9 00001146            277              LEA     .RANDVEC,A0
00001130  4280                     278              CLR.L   D0
00001132  1039 0000191A            279              MOVE.B  (UTLRNDIX),D0
00001138  1030 0800                280              MOVE.B  (A0,D0.L),D0
0000113C  5239 0000191A            281              ADDQ.B  #1,(UTLRNDIX)
00001142  205F                     282              MOVE.L  (A7)+,A0
00001144  4E75                     283              RTS
00001146                           284  
00001146                           285  
00001146= A2 EE 9A 0C F5 24 ...    286  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000114E= 2A A3 51 26 E0 AC ...    287              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001156= 75 51 CA FD 33 EB ...    288              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000115E= 60 CC E7 B8 9A EB ...    289              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001166= 1D 76 B5 95 B0 89 ...    290              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
0000116E= 39 15 48 C9 6E CA ...    291              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001176= 43 E7 E2 7C 37 25 ...    292              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
0000117E= E9 94 CE E9 E4 52 ...    293              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001186= 37 6D 9A 84 A2 28 ...    294              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
0000118E= 19 E2 C6 77 80 D4 ...    295              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001196= 0A 5A 32 67 33 C2 ...    296              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
0000119E= 59 80 DC 0E 57 FC ...    297              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000011A6= 8A AB BC F7 07 4D ...    298              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000011AE= EF D5 77 6E 1E BB ...    299              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000011B6= D6 E0 2A 8F BD 28 ...    300              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000011BE= 13 4F 66 EC 0A 64 ...    301              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000011C6= 56 52 9A 16 9B 90 ...    302              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
000011CE= 06 8A A4 F7 01 DA ...    303              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000011D6= F2 E7 77 28 B1 76 ...    304              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
000011DE= A4 42 E3 81 B1 67 ...    305              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000011E6= BF CE FA 16 BF 38 ...    306              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000011EE= D1 8B 50 0C 5F 49 ...    307              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
000011F6= DE 4C 14 A2 40 DC ...    308              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
000011FE= B6 9B 0A 38 5D AB ...    309              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001206= E2 1B DD 75 15 82 ...    310              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000120E= 8A 26 51 30 9F 47 ...    311              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001216= 1E 8A BB 71 C6 6E ...    312              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000121E= 9F 47 E5 34 94 27 ...    313              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001226= 7D 06 D6 BA 30 0F ...    314              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000122E= EC 7F 7E 03 CF 2D ...    315              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001236= 94 5B 23 F2 8B CD ...    316              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000123E= 74 33 EC B9 0F D5 ...    317              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
0000123E= 74 33 EC B9 0F D5 ...    318  -------------------- end include --------------------
00001246                           319              INCLUDE 'HEADSRP.X68'
00001246                           320  
00001246                           321  ; ------------------------------------------------------------------------------
00001246                           322  HEADINIT
00001246                           323  ; INICIALIZAR CABEZA.
00001246                           324  ; INPUT    : NONE 
00001246                           325  ; OUTPUT   : NONE
00001246                           326  ; MODIFIES : NONE
00001246                           327  ; ------------------------------------------------------------------------------
00001246  33FC 0140 00001906       328              MOVE.W  #PANWIDTH/2,(CBZPOSX)
0000124E  33FC 00F0 00001908       329              MOVE.W  #PANHEIGH/2,(CBZPOSY)
00001256  4279 00001916            330              CLR     TRZPLOT
0000125C  13FC 0003 00001916       331              MOVE.B  #3,TRZPLOT
00001264  4279 00001C1C            332              CLR.W   ESTDCBZ
0000126A  33FC 0000 00001C1C       333              MOVE.W  #0,ESTDCBZ
00001272  4E75                     334              RTS
00001274                           335              
00001274                           336  ; ------------------------------------------------------------------------------
00001274                           337  HEADUPD
00001274                           338  ; ACTUALIZAR CABEZA.
00001274                           339  ; INPUT    : NONE 
00001274                           340  ; OUTPUT   : NONE
00001274                           341  ; MODIFIES : NONE
00001274                           342  ; ------------------------------------------------------------------------------
00001274  48A7 E000                343              MOVEM.W D0-D2,-(A7)
00001278                           344                       
00001278  4240                     345              CLR.W   D0
0000127A  4241                     346              CLR.W   D1
0000127C  4242                     347              CLR.W   D2
0000127E  3239 00001906            348              MOVE.W  CBZPOSX,D1
00001284  33C1 00001912            349              MOVE.W  D1,SGMPOSX
0000128A  3439 00001908            350              MOVE.W  CBZPOSY,D2
00001290  33C2 00001914            351              MOVE.W  D2,SGMPOSY
00001296  4EB9 00001678            352              JSR     CINDMTRZ
0000129C  4EB9 000016CA            353              JSR     RSTCLD
000012A2                           354              
000012A2  4240                     355              CLR.W   D0
000012A4  3039 00001C1C            356              MOVE.W  ESTDCBZ,D0
000012AA  B07C 0000                357              CMP.W   #0,D0
000012AE  6700 001A                358              BEQ     SIGDER
000012B2  B07C 0001                359              CMP.W   #1,D0
000012B6  6700 0036                360              BEQ     SIGARR
000012BA  B07C 0002                361              CMP.W   #2,D0
000012BE  6700 0052                362              BEQ     SIGIZQ
000012C2  B07C 0003                363              CMP.W   #3,D0
000012C6  6700 006E                364              BEQ     SIGABA
000012CA                           365              
000012CA  0679 0014 00001906       366  SIGDER:     ADD.W   #CBZVEL,CBZPOSX               ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE 
000012D2  3239 00001906            367              MOVE.W  CBZPOSX,D1
000012D8  3439 00001908            368              MOVE.W  CBZPOSY,D2
000012DE  4EB9 00001678            369              JSR     CINDMTRZ
000012E4  4EB9 000016B2            370              JSR     CBZOCPD  
000012EA  6000 006E                371              BRA     FIN
000012EE                           372              
000012EE  0479 0014 00001908       373  SIGARR:     SUB.W   #CBZVEL,CBZPOSY              ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE
000012F6  3239 00001906            374              MOVE.W  CBZPOSX,D1
000012FC  3439 00001908            375              MOVE.W  CBZPOSY,D2 
00001302  4EB9 00001678            376              JSR     CINDMTRZ
00001308  4EB9 000016B2            377              JSR     CBZOCPD  
0000130E  6000 004A                378              BRA     FIN   
00001312                           379    
00001312  0479 0014 00001906       380  SIGIZQ:     SUB.W   #CBZVEL,CBZPOSX              ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE 
0000131A  3239 00001906            381              MOVE.W  CBZPOSX,D1
00001320  3439 00001908            382              MOVE.W  CBZPOSY,D2
00001326  4EB9 00001678            383              JSR     CINDMTRZ
0000132C  4EB9 000016B2            384              JSR     CBZOCPD  
00001332  6000 0026                385              BRA     FIN      
00001336                           386  
00001336  0679 0014 00001908       387  SIGABA:     ADD.W   #CBZVEL,CBZPOSY               ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE 
0000133E  3239 00001906            388              MOVE.W  CBZPOSX,D1
00001344  3439 00001908            389              MOVE.W  CBZPOSY,D2
0000134A  4EB9 00001678            390              JSR     CINDMTRZ 
00001350  4EB9 000016B2            391              JSR     CBZOCPD  
00001356  6000 0002                392              BRA     FIN      
0000135A                           393              
0000135A                           394  FIN:            
0000135A  4C9F 0007                395              MOVEM.W (A7)+,D0-D2
0000135E  4E75                     396              RTS
00001360                           397              
00001360                           398  ; ------------------------------------------------------------------------------
00001360                           399  HEADPLOT
00001360                           400  ; DIBUJAR CABEZA.
00001360                           401  ; INPUT    : NONE 
00001360                           402  ; OUTPUT   : NONE
00001360                           403  ; MODIFIES : NONE
00001360                           404  ; ------------------------------------------------------------------------------
00001360  3F00                     405             MOVE.W  D0,-(A7)                ; GUARDAMOS D0
00001362  3003                     406              MOVE.W  D3,D0                   ; PONEMOS EL INDICE DE LA CELDA EN D0 PARA CALCULAR SUS COORDENADAS
00001364  4EB9 00001736            407              JSR     CNVICOOR
0000136A  2F01                     408              MOVE.L  D1,-(A7)
0000136C                           409              
0000136C                           410              ; SET COLOR DEL CONTORNO CABEZA
0000136C  103C 0050                411              MOVE.B  #80,D0
00001370  223C 0000FF00            412              MOVE.L  #CBZPCOL,D1
00001376  4E4F                     413              TRAP    #15
00001378                           414              
00001378                           415              ; SET COLOR DEL RELLENO CABEZA
00001378  103C 0051                416              MOVE.B  #81,D0
0000137C  223C 0000AA00            417              MOVE.L  #CBZFCOL,D1
00001382  4E4F                     418              TRAP    #15
00001384                           419              
00001384                           420              ; DIBUJAR CABEZA
00001384  103C 0057                421              MOVE.B  #87,D0
00001388  221F                     422              MOVE.L  (A7)+,D1
0000138A  3F03                     423              MOVE.W  D3,-(A7)
0000138C  3601                     424              MOVE.W  D1,D3
0000138E  0643 0014                425              ADD.W   #CBZWIDTH,D3
00001392  3802                     426              MOVE.W  D2,D4
00001394  0644 0014                427              ADD.W   #CBZHEIGH,D4
00001398  4E4F                     428              TRAP    #15
0000139A                           429              
0000139A  2F01                     430              MOVE.L  D1,-(A7)
0000139C                           431              
0000139C                           432              ; SET COLOR DEL CONTORNO OJO
0000139C  103C 0050                433              MOVE.B  #80,D0
000013A0  7200                     434              MOVE.L  #OJOPCOL,D1
000013A2  4E4F                     435              TRAP    #15
000013A4                           436              
000013A4                           437              ; SET COLOR DEL RELLENO OJO
000013A4  103C 0051                438              MOVE.B  #81,D0
000013A8  223C 00FFFFFF            439              MOVE.L  #OJOFCOL,D1
000013AE  4E4F                     440              TRAP    #15
000013B0                           441              
000013B0                           442              ; DIBUJAR OJO
000013B0  103C 0058                443              MOVE.B  #88,D0
000013B4  221F                     444              MOVE.L  (A7)+,D1
000013B6  2F01                     445              MOVE.L  D1,-(A7)
000013B8  2F02                     446              MOVE.L  D2,-(A7)
000013BA  5A41                     447              ADD.W   #OJOWIDTH/2,D1            
000013BC  3601                     448              MOVE.W  D1,D3
000013BE  0643 000A                449              ADD.W   #OJOWIDTH,D3
000013C2  5A42                     450              ADD.W   #OJOHEIGH/2,D2
000013C4  3802                     451              MOVE.W  D2,D4
000013C6  0644 000A                452              ADD.W   #OJOHEIGH,D4
000013CA  4E4F                     453              TRAP    #15
000013CC                           454  
000013CC                           455              ; DEFINIR COORDENADAS IRIS
000013CC  241F                     456              MOVE.L  (A7)+,D2
000013CE  221F                     457              MOVE.L  (A7)+,D1
000013D0  0641 000A                458              ADD.W   #OJOWIDTH,D1
000013D4  0642 000A                459              ADD.W   #OJOHEIGH,D2
000013D8  103C 0052                460              MOVE.B  #82,D0
000013DC  4E4F                     461              TRAP    #15
000013DE                           462              
000013DE                           463              
000013DE  361F                     464              MOVE.W  (A7)+,D3
000013E0  301F                     465              MOVE.W  (A7)+,D0
000013E2                           466  
000013E2                           467  
000013E2  4E75                     468              RTS
000013E4                           469  
000013E4                           470  
000013E4                           471  
000013E4                           472  
000013E4                           473  
000013E4                           474  
000013E4                           475  
000013E4                           476  
000013E4                           477  
000013E4                           478  
000013E4                           479  
000013E4                           480  
000013E4                           481  
000013E4                           482  
000013E4                           483  
000013E4                           484  -------------------- end include --------------------
000013E4                           485              INCLUDE 'SEGSRP.X68'
000013E4                           486  
000013E4                           487  ; ------------------------------------------------------------------------------
000013E4                           488  SEGINIT
000013E4                           489  ; INICIALIZAR SEGMENTO.
000013E4                           490  ; INPUT    : NONE 
000013E4                           491  ; OUTPUT   : NONE
000013E4                           492  ; MODIFIES : NONE
000013E4                           493  ; ------------------------------------------------------------------------------
000013E4  33FC 012C 00001912       494              MOVE.W  #(PANWIDTH/2)-CBZWIDTH,(SGMPOSX)
000013EC  33FC 00F0 00001914       495              MOVE.W  #PANHEIGH/2,(SGMPOSY)
000013F4  4E75                     496              RTS
000013F6                           497              
000013F6                           498  ; ------------------------------------------------------------------------------
000013F6                           499  SEGUPD
000013F6                           500  ; ACTUALIZAR SEGMENTO.
000013F6                           501  ; INPUT    : NONE 
000013F6                           502  ; OUTPUT   : NONE
000013F6                           503  ; MODIFIES : NONE
000013F6                           504  ; ------------------------------------------------------------------------------
000013F6  48A7 6000                505              MOVEM.W D1-D2,-(A7)
000013FA  3239 00001912            506              MOVE.W  SGMPOSX,D1
00001400  33C1 0000190E            507              MOVE.W  D1,COLPOSX
00001406  3439 00001914            508              MOVE.W  SGMPOSY,D2
0000140C  33C2 00001910            509              MOVE.W  D2,COLPOSY
00001412  4EB9 00001678            510              JSR     CINDMTRZ
00001418  4EB9 000016CA            511              JSR     RSTCLD
0000141E  4C9F 0006                512              MOVEM.W (A7)+,D1-D2            
00001422  4E75                     513              RTS
00001424                           514              
00001424                           515  ; ------------------------------------------------------------------------------
00001424                           516  SEGPLOT
00001424                           517  ; DIBUJAR SEGMENTO.
00001424                           518  ; INPUT    : NONE 
00001424                           519  ; OUTPUT   : NONE
00001424                           520  ; MODIFIES : NONE
00001424                           521  ; ------------------------------------------------------------------------------
00001424  3F00                     522              MOVE.W  D0,-(A7)
00001426  3003                     523              MOVE.W  D3,D0
00001428  4EB9 00001736            524              JSR     CNVICOOR
0000142E  2F01                     525              MOVE.L  D1,-(A7)
00001430                           526              
00001430  103C 0050                527              MOVE.B  #80,D0
00001434  223C 0000FF00            528              MOVE.L  #SGMPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DEL SEGMENTO
0000143A  4E4F                     529              TRAP    #15
0000143C                           530              
0000143C  103C 0051                531              MOVE.B  #81,D0
00001440  223C 0000AA00            532              MOVE.L  #SGMFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DEL SEGMENTO
00001446  4E4F                     533              TRAP    #15
00001448                           534              
00001448  103C 0057                535              MOVE.B  #87,D0
0000144C  221F                     536              MOVE.L  (A7)+,D1
0000144E  3F03                     537              MOVE.W  D3,-(A7)
00001450  3601                     538              MOVE.W  D1,D3
00001452  0643 0014                539              ADD.W   #SIZECLDA,D3
00001456  3802                     540              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001458  0644 0014                541              ADD.W   #SIZECLDA,D4
0000145C  4E4F                     542              TRAP    #15                     
0000145E                           543                          
0000145E  361F                     544              MOVE.W  (A7)+,D3  
00001460  301F                     545              MOVE.W  (A7)+,D0
00001462                           546  
00001462                           547  
00001462  4E75                     548              RTS
00001464                           549  
00001464                           550  
00001464                           551  
00001464                           552  
00001464                           553  
00001464                           554  
00001464                           555  
00001464                           556  
00001464                           557  -------------------- end include --------------------
00001464                           558              INCLUDE 'TAILSRP.X68'
00001464                           559     
00001464                           560  ; ------------------------------------------------------------------------------
00001464                           561  TAILINIT
00001464                           562  ; INICIALIZAR COLA.
00001464                           563  ; INPUT    : NONE 
00001464                           564  ; OUTPUT   : NONE
00001464                           565  ; MODIFIES : NONE
00001464                           566  ; ------------------------------------------------------------------------------
00001464  33FC 011D 0000190E       567              MOVE.W  #(PANWIDTH/2)-CBZWIDTH-SGMWIDTH+(COLWIDTH/2),(COLPOSX)
0000146C  33FC 00F0 00001910       568              MOVE.W  #(PANHEIGH/2),(COLPOSY)
00001474  4E75                     569              RTS
00001476                           570              
00001476                           571              
00001476                           572  ; ------------------------------------------------------------------------------
00001476                           573  TAILUPD
00001476                           574  ; ACTUALIZAR COLA.
00001476                           575  ; INPUT    : NONE 
00001476                           576  ; OUTPUT   : NONE
00001476                           577  ; MODIFIES : NONE
00001476                           578  ; ------------------------------------------------------------------------------
00001476  48A7 6000                579              MOVEM.W D1-D2,-(A7)
0000147A  3239 0000190E            580              MOVE.W  COLPOSX,D1
00001480  3439 00001910            581              MOVE.W  COLPOSY,D2
00001486  4EB9 00001678            582              JSR     CINDMTRZ
0000148C  4EB9 000016CA            583              JSR     RSTCLD 
00001492  4C9F 0006                584              MOVEM.W (A7)+,D1-D2            
00001496  4E75                     585              RTS
00001498                           586              
00001498                           587  ; ------------------------------------------------------------------------------
00001498                           588  TAILPLOT
00001498                           589  ; DIBUJAR COLA
00001498                           590  ; INPUT    : NONE 
00001498                           591  ; OUTPUT   : NONE
00001498                           592  ; MODIFIES : NONE
00001498                           593  ; ------------------------------------------------------------------------------
00001498  3F00                     594              MOVE.W  D0,-(A7)
0000149A  3003                     595              MOVE.W  D3,D0
0000149C  4EB9 00001736            596              JSR     CNVICOOR
000014A2  2F01                     597              MOVE.L  D1,-(A7)
000014A4                           598              
000014A4  103C 0050                599              MOVE.B  #80,D0
000014A8  223C 0000FF00            600              MOVE.L  #COLPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA COLA
000014AE  4E4F                     601              TRAP    #15
000014B0                           602              
000014B0  103C 0051                603              MOVE.B  #81,D0
000014B4  223C 0000AA00            604              MOVE.L  #COLFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA COLA
000014BA  4E4F                     605              TRAP    #15
000014BC                           606              
000014BC  103C 0057                607              MOVE.B  #87,D0
000014C0  221F                     608              MOVE.L  (A7)+,D1
000014C2  3F03                     609              MOVE.W  D3,-(A7)
000014C4  3601                     610              MOVE.W  D1,D3
000014C6  0643 0014                611              ADD.W   #SIZECLDA,D3
000014CA  3802                     612              MOVE.W  D2,D4                    
000014CC  0644 0014                613              ADD.W   #SIZECLDA,D4
000014D0  4E4F                     614              TRAP    #15                    ; DIBUJAMOS EL CUADRADO 
000014D2                           615                          
000014D2  361F                     616              MOVE.W  (A7)+,D3  
000014D4  301F                     617              MOVE.W  (A7)+,D0
000014D6                           618  
000014D6  4E75                     619              RTS
000014D8                           620  
000014D8                           621  
000014D8                           622  
000014D8                           623  
000014D8                           624  
000014D8                           625  
000014D8                           626  
000014D8                           627  -------------------- end include --------------------
000014D8                           628              INCLUDE 'APPLE.X68'
000014D8                           629     
000014D8                           630  ; ------------------------------------------------------------------------------
000014D8                           631  APPLEINIT
000014D8                           632  ; Inicializa la manzana en una posición aleatoria
000014D8                           633  ; INPUT    : NONE 
000014D8                           634  ; OUTPUT   : NONE
000014D8                           635  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
000014D8                           636  ; ------------------------------------------------------------------------------
000014D8                           637  
000014D8                           638              ; Llama a la función para generar la posición aleatoria
000014D8  4EB9 000015C6            639              JSR     GENPOSMNZ
000014DE                           640  
000014DE                           641              ; Convierte las coordenadas de la manzana a índice de la matriz
000014DE  4EB9 00001678            642              JSR     CINDMTRZ
000014E4                           643  
000014E4                           644              ; Verifica si la celda está ocupada o libre
000014E4                           645  CHECK:
000014E4  4EB9 00001772            646              JSR     CHECKCLD
000014EA  6700 0010                647              BEQ     MARKMNZ                  ; Si está libre
000014EE                           648  
000014EE                           649              ; Si la celda está ocupada
000014EE  4EB9 000015C6            650              JSR     GENPOSMNZ                ; Genera una nueva posición
000014F4  4EB9 00001678            651              JSR     CINDMTRZ                 ; Convierte las nuevas coordenadas
000014FA  60E8                     652              BRA     CHECK                    ; Repite la comprobación
000014FC                           653  
000014FC                           654  MARKMNZ:
000014FC                           655              ; Marca la celda como ocupada con la manzana (estado 4)
000014FC  4EB9 00001720            656              JSR     MNZOCPD
00001502                           657  
00001502                           658              ; Dibuja la manzana en la pantalla
00001502  4EB9 00001548            659              JSR     APPLEPLOT
00001508                           660  
00001508  4E75                     661              RTS
0000150A                           662              
0000150A                           663              ;MOVE.W  #30,(MNZPOSX)   ;DE MOMENTO PONGO X E Y ELEGIDAS MANUALMENTE, EN TEORÍA DEBE SER ALEATORIO
0000150A                           664              ;MOVE.W  #30,(MNZPOSY)
0000150A                           665  
0000150A                           666  ; ------------------------------------------------------------------------------
0000150A                           667  APPLEUPD
0000150A                           668  ; Actualiza la posición de la manzana cuando la serpiente come
0000150A                           669  ; INPUT    : NONE 
0000150A                           670  ; OUTPUT   : NONE
0000150A                           671  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
0000150A                           672  ; ------------------------------------------------------------------------------
0000150A                           673  
0000150A                           674              ; Convierte las coordenadas actuales de la manzana a índice de la matriz
0000150A  4EB9 00001678            675              JSR     CINDMTRZ
00001510                           676  
00001510                           677              ; Marca la celda anterior como vacía
00001510  4EB9 000016DE            678              JSR     MCLDVCIA
00001516                           679  
00001516                           680              ; Llama a la función para generar una nueva posición aleatoria
00001516  4EB9 000015C6            681              JSR     GENPOSMNZ
0000151C                           682  
0000151C                           683              ; Convierte las nuevas coordenadas de la manzana a índice de la matriz
0000151C  4EB9 00001678            684              JSR     CINDMTRZ
00001522                           685  
00001522                           686  CHCKUPDT:
00001522  4EB9 00001772            687              JSR     CHECKCLD             ; Verifica si la celda está libre
00001528  6700 0010                688              BEQ     NEWMNZ               ; Si está libre
0000152C                           689  
0000152C                           690              ; Si la celda está ocupada
0000152C  4EB9 000015C6            691              JSR     GENPOSMNZ            ; Genera una nueva posición
00001532  4EB9 00001678            692              JSR     CINDMTRZ             ; Convierte las nuevas coordenadas
00001538  60E8                     693              BRA     CHCKUPDT             ; Repite la comprobación
0000153A                           694  
0000153A                           695  NEWMNZ:
0000153A                           696              ; Marca la celda como ocupada con la manzana (estado 4)
0000153A  4EB9 00001720            697              JSR     MNZOCPD
00001540                           698  
00001540                           699              ; Dibuja la nueva manzana en la pantalla
00001540  4EB9 00001548            700              JSR     APPLEPLOT
00001546                           701  
00001546  4E75                     702              RTS
00001548                           703              
00001548                           704  ; ------------------------------------------------------------------------------
00001548                           705  APPLEPLOT
00001548                           706  ; Dibuja la manzana
00001548                           707  ; INPUT    : NONE 
00001548                           708  ; OUTPUT   : NONE
00001548                           709  ; MODIFIES : NONE
00001548                           710  ; ------------------------------------------------------------------------------
00001548  3F00                     711              MOVE.W  D0,-(A7)
0000154A  3003                     712              MOVE.W  D3,D0
0000154C  4EB9 00001736            713              JSR     CNVICOOR
00001552  2F01                     714              MOVE.L  D1,-(A7)                ; PRIMERO DEBEMOS DIBUJAR EL FONDO Y LUEGO LA MANZANA
00001554                           715              
00001554  103C 0050                716              MOVE.B  #80,D0
00001558  223C 0090EE90            717              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
0000155E  4E4F                     718              TRAP    #15
00001560                           719              
00001560  103C 0051                720              MOVE.B  #81,D0
00001564  223C 0090EE90            721              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
0000156A  4E4F                     722              TRAP    #15
0000156C                           723              
0000156C  103C 0057                724              MOVE.B  #87,D0
00001570  221F                     725              MOVE.L  (A7)+,D1
00001572  3F03                     726              MOVE.W  D3,-(A7)
00001574  3601                     727              MOVE.W  D1,D3
00001576  0643 0014                728              ADD.W   #SIZECLDA,D3
0000157A  3802                     729              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
0000157C  0644 0014                730              ADD.W   #SIZECLDA,D4
00001580  4E4F                     731              TRAP    #15                     
00001582                           732                          
00001582  361F                     733              MOVE.W  (A7)+,D3  
00001584  301F                     734              MOVE.W  (A7)+,D0
00001586                           735  
00001586  3F00                     736              MOVE.W  D0,-(A7)
00001588  3003                     737              MOVE.W  D3,D0
0000158A  4EB9 00001736            738              JSR     CNVICOOR
00001590  2F01                     739              MOVE.L  D1,-(A7)
00001592                           740              
00001592  103C 0050                741              MOVE.B  #80,D0
00001596  223C 0000AAFF            742              MOVE.L  #MNZPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA MANZANA
0000159C  4E4F                     743              TRAP    #15
0000159E                           744              
0000159E  103C 0051                745              MOVE.B  #81,D0
000015A2  223C 000000FF            746              MOVE.L  #MNZFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA MANZANA
000015A8  4E4F                     747              TRAP    #15
000015AA                           748              
000015AA  103C 0058                749              MOVE.B  #88,D0
000015AE  221F                     750              MOVE.L  (A7)+,D1
000015B0  3F03                     751              MOVE.W  D3,-(A7)
000015B2  3601                     752              MOVE.W  D1,D3
000015B4  0643 0014                753              ADD.W   #SIZECLDA,D3
000015B8  3802                     754              MOVE.W  D2,D4                    ; DIBUJAMOS EL CIRCULO
000015BA  0644 0014                755              ADD.W   #SIZECLDA,D4
000015BE  4E4F                     756              TRAP    #15                     
000015C0                           757                          
000015C0  361F                     758              MOVE.W  (A7)+,D3  
000015C2  301F                     759              MOVE.W  (A7)+,D0
000015C4                           760  
000015C4                           761  
000015C4  4E75                     762              RTS
000015C6                           763  ; ----------------------------------------------------------------------------
000015C6                           764  GENPOSMNZ
000015C6                           765  ; Genera una posición aleatoria para la manzana
000015C6                           766  ; INPUT: NONE
000015C6                           767  ; OUTPUT:
000015C6                           768  ; MODIFIES: MNZPOSX, MNZPOSY
000015C6                           769  ; ----------------------------------------------------------------------------
000015C6                           770  
000015C6  48E7 8000                771              MOVEM.L D0,-(A7)
000015CA                           772  
000015CA                           773              ; Genera la coordenada X aleatoria
000015CA  4EB8 1128                774              JSR     UTLRAND
000015CE  0240 001F                775              ANDI.W  #NUMCLMNS-1, D0       ; Asegura que esté en [0, NUMCLMNS-1]
000015D2  C0FC 0014                776              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
000015D6  3200                     777              MOVE.W  D0,D1
000015D8  33C0 00001902            778              MOVE.W  D0, MNZPOSX           ; Guarda la coordenada X generada
000015DE                           779              
000015DE                           780              ; Generar coordenada Y aleatoria
000015DE  4EB8 1128                781              JSR     UTLRAND
000015E2  0240 0017                782              ANDI.W  #NUMFILAS-1, D0       ; Asegura que esté en el rango [0, NUMFILAS-1]
000015E6  C0FC 0014                783              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
000015EA  3400                     784              MOVE.W  D0,D2
000015EC  33C0 00001904            785              MOVE.W  D0, MNZPOSY           ; Guarda la coordenada Y generada
000015F2                           786              
000015F2  4CDF 0001                787              MOVEM.L (A7)+,D0
000015F6  4E75                     788              RTS 
000015F8                           789  
000015F8                           790  
000015F8                           791  
000015F8                           792  -------------------- end include --------------------
000015F8                           793              INCLUDE 'SCORE.X68'
000015F8                           794     
000015F8                           795  ; ------------------------------------------------------------------------------
000015F8                           796  SCOINIT
000015F8                           797  ; INICIALIZAR MARCADOR.
000015F8                           798  ; INPUT    : NONE 
000015F8                           799  ; OUTPUT   : NONE
000015F8                           800  ; MODIFIES : NONE
000015F8                           801  ; ------------------------------------------------------------------------------
000015F8  4E75                     802              RTS
000015FA                           803              
000015FA                           804  ; ------------------------------------------------------------------------------
000015FA                           805  SCOUPD
000015FA                           806  ; ACTUALIZAR MARCADOR.
000015FA                           807  ; INPUT    : NONE 
000015FA                           808  ; OUTPUT   : NONE
000015FA                           809  ; MODIFIES : NONE
000015FA                           810  ; ------------------------------------------------------------------------------
000015FA  4E75                     811              RTS
000015FC                           812              
000015FC                           813  ; ------------------------------------------------------------------------------
000015FC                           814  SCOPLOT
000015FC                           815  ; DIBUJAR MARCADOR.
000015FC                           816  ; INPUT    : NONE 
000015FC                           817  ; OUTPUT   : NONE
000015FC                           818  ; MODIFIES : NONE
000015FC                           819  ; ------------------------------------------------------------------------------
000015FC  4E75                     820              RTS
000015FE                           821  
000015FE                           822  
000015FE                           823  
000015FE                           824  
000015FE                           825  -------------------- end include --------------------
000015FE                           826              INCLUDE 'MATRIZ.X68'
000015FE                           827  ; ----------------------------------------------------------------------------
000015FE                           828  ; MATRIZ
000015FE                           829  ; ----------------------------------------------------------------------------
000015FE                           830  
000015FE                           831  ;-----------------------------------------------------------------------------
000015FE                           832  MTZINIT
000015FE                           833  ; INICIALIZA LA MATRIZ, AL PRINCIPIO ESTÁ VACÍA
000015FE                           834  ; INPUT    : NONE
000015FE                           835  ; OUTPUT   : NONE
000015FE                           836  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000015FE                           837  ; ----------------------------------------------------------------------------
000015FE                           838              
000015FE  48A7 E080                839              MOVEM.W D0-D2/A0,-(A7)
00001602                           840              
00001602  41F9 0000191C            841              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
00001608  303C 0300                842              MOVE.W #TCELDAS, D0    ; Número total de celdas
0000160C                           843  
0000160C                           844  CLNCLDS:
0000160C  4218                     845              CLR.B (A0)+            ; Coloca 0 en cada celda
0000160E  5340                     846              SUBI.W #1, D0          ; Decrementa el contador de celdas
00001610  66FA                     847              BNE CLNCLDS            ; Repite hasta que esten vacías
00001612                           848              
00001612                           849              
00001612  3239 00001906            850              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
00001618  3439 00001908            851              MOVE.W  CBZPOSY, D2
0000161E  4EB9 00001678            852              JSR     CINDMTRZ
00001624  4EB9 000016B2            853              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
0000162A                           854              
0000162A  3239 00001912            855              MOVE.W  SGMPOSX, D1
00001630  3439 00001914            856              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
00001636  4EB9 00001678            857              JSR     CINDMTRZ
0000163C  4EB9 000016F4            858              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
00001642                           859              
00001642  3239 0000190E            860              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
00001648  3439 00001910            861              MOVE.W  COLPOSY, D2
0000164E  4EB9 00001678            862              JSR     CINDMTRZ
00001654  4EB9 0000170A            863              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
0000165A                           864              
0000165A  3239 00001902            865              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
00001660  3439 00001904            866              MOVE.W  MNZPOSY, D2
00001666  4EB9 00001678            867              JSR     CINDMTRZ
0000166C  4EB9 00001720            868              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
00001672                           869              
00001672                           870              
00001672  4C9F 0107                871              MOVEM.W (A7)+,D0-D2/A0
00001676                           872  
00001676  4E75                     873              RTS
00001678                           874  
00001678                           875  ;-----------------------------------------------------------------------------
00001678                           876  CINDMTRZ
00001678                           877  ; CALCULA EL ÍNDICE DE UNA CELDA
00001678                           878  ; INPUT    : D1 = coordenada X pantalla, D2 = coordenada Y pantalla
00001678                           879  ; OUTPUT   : D0 = índice de la celda en ESTDCLDS
00001678                           880  ; MODIFIES : NONE
00001678                           881  ; ----------------------------------------------------------------------------
00001678                           882  
00001678  48A7 7000                883               MOVEM.W D1-D3,-(A7)     ; Guarda los registros D1-D3 en la pila
0000167C                           884  
0000167C                           885              ; Divide X por SIZECLDA
0000167C  3601                     886              MOVE.W  D1, D3          ; Copia X a D3
0000167E  4241                     887              CLR.W   D1              ; Inicializa el cociente de X
00001680                           888  
00001680  B67C 0014                889  DIVX:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
00001684  6D00 000A                890              BLT     ENDDIVX         ; Si D3 < SIZECLDA, salta a ENDDIVX
00001688  0443 0014                891              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
0000168C  5241                     892              ADDQ.W  #1, D1          ; Incrementa el cociente de X
0000168E  60F0                     893              BRA     DIVX            ; Repite el bucle
00001690                           894  
00001690                           895  ENDDIVX:
00001690                           896  
00001690                           897              ; Divide Y por SIZECLDA
00001690  3602                     898              MOVE.W  D2, D3          ; Copia Y a D3
00001692  4242                     899              CLR.W   D2              ; Inicializa el cociente de Y
00001694                           900  
00001694  B67C 0014                901  DIVY:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
00001698  6D00 000A                902              BLT     ENDDIVY         ; Si D3 < SIZECLDA, salta a ENDDIVY
0000169C  0443 0014                903              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
000016A0  5242                     904              ADDQ.W  #1, D2          ; Incrementa el cociente de Y
000016A2  60F0                     905              BRA     DIVY            ; Repite el bucle
000016A4                           906  
000016A4                           907  ENDDIVY:
000016A4                           908  
000016A4                           909              ; Calcula el índice
000016A4  4240                     910              CLR.W   D0
000016A6  3002                     911              MOVE.W  D2, D0          ; D0 = Y_CELDA
000016A8  EB40                     912              ASL.W   #5, D0          ; D0 = Y_CELDA * NUMCLMNS (32 = 2^5)
000016AA  D041                     913              ADD.W   D1, D0          ; D0 = Y_CELDA * NUMCLMNS + X_CELDA
000016AC                           914  
000016AC  4C9F 000E                915              MOVEM.W (A7)+,D1-D3     ; Restaura los registros D1-D3 desde la pila
000016B0                           916  
000016B0  4E75                     917              RTS  
000016B2                           918              
000016B2                           919  ;-----------------------------------------------------------------------------
000016B2                           920  CBZOCPD
000016B2                           921  ; MARCA UNA CELDA COMO OCUPADA POR LA CABEZA
000016B2                           922  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016B2                           923  ; OUTPUT   : NONE
000016B2                           924  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016B2                           925  ; ----------------------------------------------------------------------------
000016B2                           926  
000016B2  48A7 0080                927              MOVEM.W A0,-(A7)
000016B6                           928  
000016B6  41F9 0000191C            929              LEA     ESTDCLDS, A0                ; Dirección de la matriz en A0
000016BC  11B9 00001916 0000       930              MOVE.B  TRZPLOT, (A0, D0.W)           ; Marca la celda como ocupada
000016C4                           931              
000016C4  4C9F 0100                932              MOVEM.W (A7)+,A0
000016C8                           933              
000016C8  4E75                     934              RTS
000016CA                           935              
000016CA                           936              
000016CA                           937              
000016CA                           938  ;-----------------------------------------------------------------------------
000016CA                           939  RSTCLD
000016CA                           940  ; RESTA 1 A LA CELDA PASADA POR PARÁMETRO
000016CA                           941  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016CA                           942  ; OUTPUT   : NONE
000016CA                           943  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016CA                           944  ; ----------------------------------------------------------------------------
000016CA                           945  
000016CA  48A7 0080                946              MOVEM.W A0,-(A7)
000016CE                           947  
000016CE  41F9 0000191C            948              LEA     ESTDCLDS, A0                ; Dirección de la matriz en A0
000016D4  5330 0000                949              SUBQ.B   #1, (A0, D0.W)           ; Marca la celda como ocupada
000016D8                           950              
000016D8  4C9F 0100                951              MOVEM.W (A7)+,A0
000016DC                           952              
000016DC  4E75                     953              RTS
000016DE                           954             
000016DE                           955  ;-----------------------------------------------------------------------------
000016DE                           956  MCLDVCIA
000016DE                           957  ; MARCA UNA CELDA COMO VACÍA
000016DE                           958  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016DE                           959  ; OUTPUT   : NONE
000016DE                           960  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016DE                           961  ; ----------------------------------------------------------------------------
000016DE                           962  
000016DE  48A7 0080                963              MOVEM.W A0,-(A7)
000016E2                           964  
000016E2  41F9 0000191C            965              LEA ESTDCLDS, A0                ; Direccion de la matriz en A0
000016E8  11BC 0000 0000           966              MOVE.B #0, (A0, D0.W)           ; Marca la celda como vacía
000016EE                           967              
000016EE  4C9F 0100                968              MOVEM.W (A7)+,A0
000016F2                           969              
000016F2  4E75                     970              RTS
000016F4                           971  
000016F4                           972  ;-----------------------------------------------------------------------------
000016F4                           973  SGMOCPD
000016F4                           974  ; MARCA UNA CELDA COMO OCUPADA POR EL SEGMENTO
000016F4                           975  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016F4                           976  ; OUTPUT   : NONE
000016F4                           977  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016F4                           978  ; ----------------------------------------------------------------------------
000016F4                           979  
000016F4  48A7 0080                980              MOVEM.W A0,-(A7)
000016F8                           981  
000016F8  41F9 0000191C            982              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
000016FE  11BC 0002 0000           983              MOVE.B #2, (A0, D0.W)           ; Marca la celda como ocupada
00001704                           984              
00001704  4C9F 0100                985              MOVEM.W (A7)+,A0
00001708                           986              
00001708  4E75                     987              RTS
0000170A                           988              
0000170A                           989  ;-----------------------------------------------------------------------------
0000170A                           990  COLOCPD
0000170A                           991  ; MARCA UNA CELDA COMO OCUPADA POR LA COLA
0000170A                           992  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000170A                           993  ; OUTPUT   : NONE
0000170A                           994  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000170A                           995  ; ----------------------------------------------------------------------------
0000170A                           996  
0000170A  48A7 0080                997              MOVEM.W A0,-(A7)
0000170E                           998  
0000170E  41F9 0000191C            999              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
00001714  11BC 0001 0000          1000              MOVE.B #1, (A0, D0.W)           ; Marca la celda como ocupada
0000171A                          1001              
0000171A  4C9F 0100               1002              MOVEM.W (A7)+,A0
0000171E                          1003              
0000171E  4E75                    1004              RTS
00001720                          1005  
00001720                          1006  
00001720                          1007  ;-----------------------------------------------------------------------------
00001720                          1008  MNZOCPD
00001720                          1009  ; MARCA UNA CELDA COMO OCUPADA POR LA MANZANA
00001720                          1010  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001720                          1011  ; OUTPUT   : NONE
00001720                          1012  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001720                          1013  ; ----------------------------------------------------------------------------
00001720                          1014  
00001720  48A7 0080               1015              MOVEM.W A0,-(A7)
00001724                          1016  
00001724  41F9 0000191C           1017              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
0000172A  11BC 0004 0000          1018              MOVE.B #4, (A0, D0.W)           ; Marca la celda como ocupada
00001730                          1019              
00001730  4C9F 0100               1020              MOVEM.W (A7)+,A0
00001734                          1021              
00001734  4E75                    1022              RTS
00001736                          1023  
00001736                          1024              
00001736                          1025  ;-----------------------------------------------------------------------------
00001736                          1026  CNVICOOR
00001736                          1027  ; Convierte un índice de celda a coordenadas de pantalla (X, Y)
00001736                          1028  ; INPUT    : D0 = índice de la celda en ESTADO_CELDAS
00001736                          1029  ; OUTPUT   : D1 = coordenada X, D2 = coordenada Y
00001736                          1030  ; MODIFIES : NONE
00001736                          1031  ; ----------------------------------------------------------------------------
00001736                          1032  
00001736  48A7 9800               1033              MOVEM.W D0/D3-D4,-(A7)
0000173A                          1034  
0000173A  3400                    1035              MOVE.W  D0,D2         ; Copia índice a D2 para calcular la fila
0000173C  EA4A                    1036              LSR.W   #5,D2         ; D2 = índice / NUM_COLUMNAS (32 = 2^5)
0000173E  3200                    1037              MOVE.W  D0,D1         ; Copia índice a D1 para calcular la columna
00001740  C27C 001F               1038              AND.W   #$1F,D1       ; D1 = índice % NUM_COLUMNAS (31 = 0x1F) (CREO)
00001744                          1039  
00001744                          1040              ; Multiplica por TAMAÑO_CELDA = 10
00001744  363C 0014               1041              MOVE.W  #SIZECLDA, D3
00001748  3801                    1042              MOVE.W  D1,D4         ; Copia D1 para multiplicar por 10
0000174A  4241                    1043              CLR.W   D1            ; Inicializa resultado
0000174C                          1044  
0000174C                          1045  
0000174C                          1046  MULTLOOPX: 
0000174C  B87C 0000               1047              CMP.W   #0, D4        ; ¿Quedan iteraciones?
00001750  6700 0008               1048              BEQ     ENDMULTX
00001754  D243                    1049              ADD.W   D3,D1         ; Suma TAMANO_CELDA (10) repetidamente
00001756                          1050  
00001756  5344                    1051              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
00001758  60F2                    1052              BRA     MULTLOOPX     ; Repite mientras no sea 0
0000175A                          1053  ENDMULTX: 
0000175A  3802                    1054              MOVE.W  D2,D4         ; Copia D2 para multiplicar por 10
0000175C  4242                    1055              CLR.W   D2            ; Inicializa resultado
0000175E                          1056  
0000175E                          1057  MULTLOOPY: 
0000175E  B87C 0000               1058              CMP.W   #0, D4        ; ¿Quedan iteraciones?
00001762  6700 0008               1059              BEQ     ENDMULTY
00001766  D443                    1060              ADD.W   D3,D2         ; Suma TAMANO_CELDA (10) repetidamente
00001768  5344                    1061              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
0000176A  60F2                    1062              BRA     MULTLOOPY     ; Repite mientras no sea 0
0000176C                          1063  ENDMULTY:
0000176C  4C9F 0019               1064              MOVEM.W (A7)+,D0/D3-D4
00001770                          1065  
00001770  4E75                    1066              RTS
00001772                          1067  
00001772                          1068  ; ----------------------------------------------------------------------------
00001772                          1069  CHECKCLD
00001772                          1070  ; INPUT: D0 = índice de la celda
00001772                          1071  ; OUTPUT: D0 = 0 si está vacía, 1 si está ocupada
00001772                          1072  ; MODIFIES: Ninguno
00001772                          1073  ; ----------------------------------------------------------------------------
00001772                          1074  
00001772  41F9 0000191C           1075              LEA     ESTDCLDS, A0    ; Carga la dirección de la matriz ESTDCLDS
00001778  1230 0000               1076              MOVE.B  (A0, D0.W),D1   ; Carga el estado de la celda en D1
0000177C  B23C 0000               1077              CMP.B   #0, D1          ; Compara si está vacía (0)
00001780  6700 0008               1078              BEQ     CLDFREE         ; Si está vacía
00001784  303C 0001               1079              MOVE.W  #1, D0          ; Si está ocupada, devuelve 1 (ocupada)
00001788                          1080  
00001788  4E75                    1081              RTS
0000178A                          1082  
0000178A                          1083  CLDFREE:
0000178A  303C 0000               1084              MOVE.W  #0, D0                 ; Devuelve 0 (libre)
0000178E                          1085  
0000178E  4E75                    1086              RTS
00001790                          1087  
00001790                          1088  
00001790                          1089  ;-----------------------------------------------------------------------------
00001790                          1090  FONPLOT
00001790                          1091  ; DIBUJADO DEL FONDO
00001790                          1092  ; INPUT    : NONE
00001790                          1093  ; OUTPUT   : NONE
00001790                          1094  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001790                          1095  ; ----------------------------------------------------------------------------
00001790                          1096  
00001790  3F00                    1097              MOVE.W  D0,-(A7)
00001792  3003                    1098              MOVE.W  D3,D0
00001794  4EB8 1736               1099              JSR     CNVICOOR
00001798  2F01                    1100              MOVE.L  D1,-(A7)
0000179A                          1101              
0000179A  103C 0050               1102              MOVE.B  #80,D0
0000179E  223C 0090EE90           1103              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
000017A4  4E4F                    1104              TRAP    #15
000017A6                          1105              
000017A6  103C 0051               1106              MOVE.B  #81,D0
000017AA  223C 0090EE90           1107              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
000017B0  4E4F                    1108              TRAP    #15
000017B2                          1109              
000017B2  103C 0057               1110              MOVE.B  #87,D0
000017B6  221F                    1111              MOVE.L  (A7)+,D1
000017B8  3F03                    1112              MOVE.W  D3,-(A7)
000017BA  3601                    1113              MOVE.W  D1,D3
000017BC  0643 0014               1114              ADD.W   #SIZECLDA,D3
000017C0  3802                    1115              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
000017C2  0644 0014               1116              ADD.W   #SIZECLDA,D4
000017C6  4E4F                    1117              TRAP    #15                     
000017C8                          1118                          
000017C8  361F                    1119              MOVE.W  (A7)+,D3  
000017CA  301F                    1120              MOVE.W  (A7)+,D0
000017CC  4E75                    1121              RTS         
000017CE                          1122  
000017CE                          1123  
000017CE                          1124  
000017CE                          1125  ;-----------------------------------------------------------------------------
000017CE                          1126  MTZUPD
000017CE                          1127  ; ACTUALIZA LA MATRIZ CASILLA A CASILLA
000017CE                          1128  ; INPUT    : NONE
000017CE                          1129  ; OUTPUT   : NONE
000017CE                          1130  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000017CE                          1131  ; ----------------------------------------------------------------------------
000017CE                          1132  
000017CE                          1133  
000017CE  48A7 E080               1134              MOVEM.W D0-D2/A0,-(A7)
000017D2                          1135              
000017D2  41F9 0000191C           1136              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
000017D8  303C 0300               1137              MOVE.W #TCELDAS, D0    ; Número total de celdas
000017DC                          1138  
000017DC                          1139  .CLNCLDS:
000017DC  4218                    1140              CLR.B (A0)+            ; Coloca 0 en cada celda
000017DE  5340                    1141              SUBI.W #1, D0          ; Decrementa el contador de celdas
000017E0  66FA                    1142              BNE .CLNCLDS           ; Repite hasta que esten vacías
000017E2                          1143              
000017E2                          1144              
000017E2  3239 00001906           1145              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
000017E8  3439 00001908           1146              MOVE.W  CBZPOSY, D2
000017EE  4EB8 1678               1147              JSR     CINDMTRZ
000017F2  4EB8 16B2               1148              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
000017F6                          1149              
000017F6  3239 00001912           1150              MOVE.W  SGMPOSX, D1
000017FC  3439 00001914           1151              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
00001802  4EB8 1678               1152              JSR     CINDMTRZ
00001806  4EB8 16F4               1153              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
0000180A                          1154              
0000180A  3239 0000190E           1155              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
00001810  3439 00001910           1156              MOVE.W  COLPOSY, D2
00001816  4EB8 1678               1157              JSR     CINDMTRZ
0000181A  4EB8 170A               1158              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
0000181E                          1159              
0000181E  3239 00001902           1160              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
00001824  3439 00001904           1161              MOVE.W  MNZPOSY, D2
0000182A  4EB8 1678               1162              JSR     CINDMTRZ
0000182E  4EB8 1720               1163              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
00001832                          1164              
00001832                          1165              
00001832  4C9F 0107               1166              MOVEM.W (A7)+,D0-D2/A0
00001836                          1167  
00001836  4E75                    1168              RTS
00001838                          1169  
00001838                          1170  
00001838                          1171  
00001838                          1172  ;-----------------------------------------------------------------------------
00001838                          1173  MTZPLOT
00001838                          1174  ; DIBUJA LA MATRIZ CASILLA A CASILLA
00001838                          1175  ; INPUT    : NONE
00001838                          1176  ; OUTPUT   : NONE
00001838                          1177  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001838                          1178  ; ----------------------------------------------------------------------------
00001838  48E7 F080               1179              MOVEM.L D0-D3/A0,-(A7)
0000183C                          1180  
0000183C  4240                    1181              CLR.W   D0
0000183E  4243                    1182              CLR.W   D3
00001840  41F9 0000191C           1183              LEA     ESTDCLDS, A0            ; Apunta al inicio de ESTDCLDS
00001846  303C 0300               1184              MOVE.W  #TCELDAS, D0            ; Número total de celdas
0000184A  363C 0000               1185              MOVE.W  #0,D3                   ; LO UTILIZAMOS PARA SABER EL INDICE EN EL QUE NOS ENCONTRAMOS
0000184E  4241                    1186              CLR.W   D1
00001850  4242                    1187              CLR.W   D2
00001852                          1188              
00001852                          1189  
00001852                          1190  PLOTCLDS:
00001852  1218                    1191              MOVE.B  (A0)+,D1                ; MOVEMOS EL VALOR DE LA CELDA A D1
00001854  B23C 0000               1192              CMP.B   #0,D1
00001858  6700 0036               1193              BEQ     PLOTVAC                 ; SALTA A DIBUJAR POSICIÓN VACÍA
0000185C  B23C 0001               1194              CMP.B   #1,D1 
00001860  6700 0034               1195              BEQ     PLOTCOL                 ; SALTA A DIBUJAR COLA
00001864  B23C 0002               1196              CMP.B   #2,D1
00001868  6700 0032               1197              BEQ     PLOTSEG                 ; SALTA A DIBUJAR SEGMENTO
0000186C  B239 00001916           1198              CMP.B   TRZPLOT,D1
00001872  6700 0016               1199              BEQ     PLOTCBZ                 ; SALTA A DIBUJAR CABEZA
00001876  B23C 0004               1200              CMP.B   #4,D1                 
0000187A  6700 0026               1201              BEQ     PLOTAPPLE               ; SALTA A DIBUJAR MANZANA
0000187E                          1202    
0000187E                          1203  DONEPLOT            
0000187E  5243                    1204              ADDQ    #1,D3                   ; AUMENTAMOS EL INDICE DE CELDA PARA LA SIGUIENTE
00001880  5340                    1205              SUBI.W  #1, D0                  ; Decrementa el contador de celdas
00001882  66CE                    1206              BNE     PLOTCLDS                ; Repite hasta que esten vacías
00001884  4CDF 010F               1207              MOVEM.L (A7)+,D0-D3/A0
00001888  4E75                    1208              RTS
0000188A                          1209  PLOTCBZ:
0000188A  4EB8 1360               1210              JSR     HEADPLOT
0000188E  60EE                    1211              BRA     DONEPLOT
00001890                          1212  
00001890                          1213  PLOTVAC:    
00001890  4EB8 1790               1214              JSR     FONPLOT
00001894  60E8                    1215              BRA     DONEPLOT                ; DIBUJADO HECHO 
00001896                          1216  
00001896                          1217  PLOTCOL:   
00001896  4EB8 1498               1218              JSR     TAILPLOT 
0000189A  60E2                    1219              BRA     DONEPLOT                ; DIBUJADO HECHO 
0000189C                          1220              
0000189C                          1221  PLOTSEG:    
0000189C  4EB8 1424               1222              JSR     SEGPLOT
000018A0  60DC                    1223              BRA     DONEPLOT                ; DIBUJADO HECHO    
000018A2                          1224  
000018A2                          1225  PLOTAPPLE:
000018A2  4EB8 1548               1226              JSR     APPLEPLOT
000018A6  60D6                    1227              BRA     DONEPLOT            
000018A8                          1228  
000018A8                          1229  
000018A8                          1230  
000018A8                          1231  
000018A8                          1232  
000018A8                          1233  
000018A8                          1234  
000018A8                          1235  
000018A8                          1236  
000018A8                          1237  
000018A8                          1238  
000018A8                          1239  
000018A8                          1240  
000018A8                          1241  -------------------- end include --------------------
000018A8                          1242  START:
000018A8                          1243                  
000018A8                          1244  ; --- INIZIALIZACIÓN ---------------------------------------------------------
000018A8                          1245  
000018A8  4EB8 1000               1246              JSR     SYSINIT
000018AC  4EB8 1112               1247              JSR     UTLINIT
000018B0  4EB8 1066               1248              JSR     KBDINIT
000018B4  4EB8 15FE               1249              JSR     MTZINIT
000018B8  4EB8 1246               1250              JSR     HEADINIT                
000018BC  4EB8 13E4               1251              JSR     SEGINIT
000018C0  4EB8 1464               1252              JSR     TAILINIT
000018C4  4EB8 15F8               1253              JSR     SCOINIT
000018C8  4EB8 14D8               1254              JSR     APPLEINIT
000018CC                          1255              
000018CC                          1256  
000018CC                          1257  .LOOP
000018CC                          1258  
000018CC                          1259  ; --- ACTUALIZAR -------------------------------------------------------------
000018CC                          1260  
000018CC                          1261  ; LEER DISPOSITIVOS DE ENTRADA
000018CC                          1262  
000018CC  4E41                    1263              TRAP    #1
000018CE                          1264  
000018CE                          1265  ; ACTUALIZAR LÓGICA DEL JUEGO
000018CE                          1266  
000018CE  4EB8 1476               1267              JSR     TAILUPD
000018D2  4EB8 13F6               1268              JSR     SEGUPD
000018D6  4EB8 1274               1269              JSR     HEADUPD
000018DA                          1270              ;JSR     APPLEUPD  
000018DA  4EB8 17CE               1271              JSR     MTZUPD           
000018DE                          1272              
000018DE                          1273  ; --- SINCRONIZACIÓN ---------------------------------------------------------
000018DE                          1274              ; THE FOLLOWING SYNC STRATEGY IS ****WRONG****
000018DE  103C 0017               1275              MOVE.B  #23,D0
000018E2  7201                    1276              MOVE.L  #1,D1
000018E4  4E4F                    1277              TRAP    #15
000018E6                          1278  
000018E6                          1279  
000018E6                          1280  ;---DIBUJAR-------------------------------------------------------------------
000018E6  4EB8 1360               1281               JSR     HEADPLOT
000018EA  4EB8 1424               1282               JSR     SEGPLOT
000018EE  4EB8 1498               1283               JSR     TAILPLOT
000018F2  4EB8 1548               1284               JSR     APPLEPLOT
000018F6  4EB8 1838               1285               JSR     MTZPLOT
000018FA                          1286              
000018FA  4E40                    1287              TRAP    #0                      ; ACTUALIZA DOBLE BUFFER
000018FC                          1288  
000018FC                          1289  
000018FC  60CE                    1290              BRA     .LOOP
000018FE                          1291  
000018FE  FFFF FFFF               1292              SIMHALT
00001902                          1293              
00001902                          1294              INCLUDE 'VARS.X68'
00001902                          1295  ; ----------------------------------------------------------------------------
00001902                          1296  ; VARIABLES DEL JUEGO
00001902                          1297  ; ----------------------------------------------------------------------------
00001902                          1298  
00001902                          1299  ; --- VARIABLES DE LA MANZANA ------------------------------------------------
00001902                          1300  
00001902                          1301  MNZPOSX     DS.W    1                       ; COORDENADA X DE LA MANZANA
00001904                          1302  MNZPOSY     DS.W    1                       ; COORDENADA Y DE LA MANZANA
00001906                          1303  
00001906                          1304  ; --- VARIABLES DE LA SERPIENTE ----------------------------------------------
00001906                          1305  
00001906                          1306  CBZPOSX     DS.W    1                       ; COORDENADA X CABEZA
00001908                          1307  CBZPOSY     DS.W    1                       ; COORDENADA Y CABEZA
0000190A                          1308  CBZVELX     DS.W    1                       ; VELOCIDAD X CABEZA
0000190C                          1309  CBZVELY     DS.W    1                       ; VELOCIDAD Y CABEZA
0000190E                          1310  COLPOSX     DS.W    1                       ; COORDENADA X COLA
00001910                          1311  COLPOSY     DS.W    1                       ; COORDENADA Y COLA
00001912                          1312  SGMPOSX     DS.W    1                       ; COORDENADA X SEGMENTO
00001914                          1313  SGMPOSY     DS.W    1                       ; COORDENADA Y SEGMENTO
00001916                          1314  TRZPLOT     DS.B    1                       ; NÚMERO DE TROZOS A DIBUJAR
00001917                          1315  
00001917                          1316  ; --- VARIABLES DEL MARCADOR -------------------------------------------------
00001917                          1317  
00001918                          1318  JGOPNTS     DS.W    1                       ; PUNTUACIÓN DEL JUEGO
0000191A                          1319  
0000191A                          1320  
0000191A                          1321  
0000191A                          1322  
0000191A                          1323  -------------------- end include --------------------
0000191A                          1324              INCLUDE 'LIB/UTLVARS.X68'
0000191A                          1325  ; =============================================================================
0000191A                          1326  ; UTILITY VARIABLES
0000191A                          1327  ; =============================================================================
0000191A                          1328  
0000191A                          1329  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
0000191C                          1330              DS.W    0
0000191C                          1331  -------------------- end include --------------------
0000191C                          1332              INCLUDE 'SYSVARS.X68'
0000191C                          1333  ; ----------------------------------------------------------------------------
0000191C                          1334  ; VARIABLES DEL SISTEMA
0000191C                          1335  ; ----------------------------------------------------------------------------
0000191C                          1336  
0000191C                          1337  ; --- VARIABLES DE LA MATRIZ -------------------------------------------------
0000191C                          1338  
0000191C                          1339  ESTDCLDS    DS.B    TCELDAS                 ; ESTADO DE LAS CELDAS 0=VACÍO  1=COLA   2=SEGMENTO  TRZPLOT=CABEZA  4?=MANZANA    
00001C1C                          1340  ESTDCBZ     DS.B    1                       ; 0= DERECHA, 1=ARRIBA, 2=IZQUIERDA, 3=ABAJO
00001C1D                          1341  
00001C1D                          1342  ; --- VARIABLES DE TECLADO ---------------------------------------------------
00001C1D                          1343  
00001C1D                          1344  KBDVAL      DS.B    1                       ; KEY STATE
00001C1E                          1345  KBDEDGE     DS.B    1                       ; KEY EDGE
00001C20                          1346  LASTKEY     DS.L    1                       ; ÚLTIMO ESTADO DE LAS TECLAS
00001C24                          1347                              
00001C24                          1348  
00001C24                          1349  
00001C24                          1350  
00001C24                          1351  
00001C24                          1352  
00001C24                          1353  
00001C24                          1354  
00001C24                          1355  
00001C24                          1356  
00001C24                          1357  
00001C24                          1358  -------------------- end include --------------------
00001C24                          1359      
00001C24                          1360      
00001C24                          1361              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
ABA                 1100
APPLEINIT           14D8
APPLEPLOT           1548
APPLEUPD            150A
ARR                 10E8
CBZFCOL             AA00
CBZHEIGH            14
CBZOCPD             16B2
CBZPCOL             FF00
CBZPOSX             1906
CBZPOSY             1908
CBZVEL              14
CBZVELX             190A
CBZVELY             190C
CBZWIDTH            14
CHCKUPDT            1522
CHECK               14E4
CHECKCLD            1772
CINDMTRZ            1678
CLDFREE             178A
CLNCLDS             160C
CNVICOOR            1736
COLFCOL             AA00
COLFND              90EE90
COLHEIGH            A
COLOCPD             170A
COLPCOL             FF00
COLPOSX             190E
COLPOSY             1910
COLWIDTH            A
CONTINU             110C
DER                 10DC
DIVX                1680
DIVY                1694
DONEPLOT            187E
ENDDIVX             1690
ENDDIVY             16A4
ENDMULTX            175A
ENDMULTY            176C
ESTDCBZ             1C1C
ESTDCLDS            191C
FIN                 135A
FONPLOT             1790
GENPOSMNZ           15C6
HEADINIT            1246
HEADPLOT            1360
HEADUPD             1274
IZQ                 10F4
JGOPNTS             1918
KBDDOWN             28
KBDEDGE             1C1E
KBDINIT             1066
KBDLEFT             25
KBDRIGHT            27
KBDUP               26
KBDUPD              1074
KBDUPD:LOOP         108E
KBDVAL              1C1D
LASTKEY             1C20
LNGINI              1
MARKMNZ             14FC
MAXSGM              1
MCLDVCIA            16DE
MNZFCOL             FF
MNZHEIGH            14
MNZOCPD             1720
MNZPCOL             AAFF
MNZPOSX             1902
MNZPOSY             1904
MNZWIDTH            14
MTZINIT             15FE
MTZPLOT             1838
MTZUPD              17CE
MTZUPD:CLNCLDS      17DC
MULTLOOPX           174C
MULTLOOPY           175E
NEWMNZ              153A
NUMCLMNS            20
NUMFILAS            18
OJOFCOL             FFFFFF
OJOHEIGH            A
OJOPCOL             0
OJOWIDTH            A
PANHEIGH            1E0
PANWIDTH            280
PLOTAPPLE           18A2
PLOTCBZ             188A
PLOTCLDS            1852
PLOTCOL             1896
PLOTSEG             189C
PLOTVAC             1890
PNTSFCOL            1
PNTSTEXT            1
RSTCLD              16CA
SCOINIT             15F8
SCOPLOT             15FC
SCOUPD              15FA
SCRINIT             101E
SCRPLOT             104C
SEGINIT             13E4
SEGPLOT             1424
SEGUPD              13F6
SGMFCOL             AA00
SGMHEIGH            14
SGMOCPD             16F4
SGMPCOL             FF00
SGMPOSX             1912
SGMPOSY             1914
SGMWIDTH            14
SIGABA              1336
SIGARR              12EE
SIGDER              12CA
SIGIZQ              1312
SIZECLDA            14
START               18A8
START:LOOP          18CC
SYSINIT             1000
TAILINIT            1464
TAILPLOT            1498
TAILUPD             1476
TCELDAS             300
TRZPLOT             1916
UTLINIT             1112
UTLRAND             1128
UTLRAND:RANDVEC     1146
UTLRNDIX            191A
