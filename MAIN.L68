00001874 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 20/12/2024 20:13:17

00000000                             1  *-----------------------------------------------------------------------------
00000000                             2  * Title      : MAIN
00000000                             3  * Written by :
00000000                             4  * Date       :
00000000                             5  * Description:
00000000                             6  *-----------------------------------------------------------------------------
00000000                             7  
00001000                             8              ORG    $1000
00001000                             9              
00001000                            10              INCLUDE 'CONST.X68'
00001000                            11  ; ----------------------------------------------------------------------------
00001000                            12  ; CONSTANTES DEL JUEGO
00001000                            13  ; ----------------------------------------------------------------------------
00001000                            14     
00001000                            15  ; --- CONSTANTES DE LA MANZANA -----------------------------------------------
00001000                            16  
00001000  =00000014                 17  MNZWIDTH    EQU     20                      ; ANCHURA DE LA MANZANA (a determinar)
00001000  =00000014                 18  MNZHEIGH    EQU     20                      ; ALTURA DE LA MANZANA (a determinar)
00001000  =0000AAFF                 19  MNZPCOL     EQU     $0000AAFF               ; COLOR CONTORNO MANZANA (a determinar)
00001000  =000000FF                 20  MNZFCOL     EQU     $000000FF               ; COLOR RELLENO MANZANA (a determinar)
00001000                            21  
00001000                            22  ; --- CONSTANTES DE LA SERPIENTE ---------------------------------------------
00001000                            23  
00001000  =00000001                 24  MAXSGM      EQU     1                       ; TAMAÑO MÁXIMO DE SEGMENTOS (a determinar)
00001000  =00000001                 25  LNGINI      EQU     1                       ; LONGITUD INICIAL SERPIENTE (a determinar)
00001000  =00000014                 26  SGMWIDTH    EQU     20                      ; ANCHURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 27  SGMHEIGH    EQU     20                      ; ALTURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 28  CBZVEL      EQU     20                      ; VELOCIDAD DE LA CABEZA (a determinar)
00001000  =0000FF00                 29  SGMPCOL     EQU     $0000FF00               ; COLOR CONTORNO SEGMENTO (PROVISIONAL)
00001000  =0000AA00                 30  SGMFCOL     EQU     $0000AA00               ; COLOR RELLENO SEGMENTO (PROVISIONAL)
00001000  =0000000A                 31  COLWIDTH    EQU     10                      ; ANCHURA DE LA COLA (PROVISIONAL)
00001000  =0000000A                 32  COLHEIGH    EQU     10                      ; ALTURA DE LA COLA (PROVISIONAL)
00001000  =0000FF00                 33  COLPCOL     EQU     $0000FF00               ; COLOR CONTORNO COLA (PROVISIONAL)
00001000  =0000AA00                 34  COLFCOL     EQU     $0000AA00               ; COLOR RELLENO COLA (PROVISIONAL)
00001000  =00000014                 35  CBZWIDTH    EQU     20                      ; ANCHURA DE LA CABEZA (PROVISIONAL)
00001000  =00000014                 36  CBZHEIGH    EQU     20                      ; ALTURA DE LA CABEZA (PROVISIONAL)
00001000  =0000FF00                 37  CBZPCOL     EQU     $0000FF00               ; COLOR CONTORNO CABEZA (PROVISIONAL)
00001000  =0000AA00                 38  CBZFCOL     EQU     $0000AA00               ; COLOR RELLENO CABEZA (PROVISIONAL)
00001000  =0000000A                 39  OJOWIDTH    EQU     10                      ; ANCHURA DE OJO DE SERPIENTE
00001000  =0000000A                 40  OJOHEIGH    EQU     10                      ; ALTURA DE OJO DE SERPIENTE
00001000  =00000000                 41  OJOPCOL     EQU     $00000000               ; COLOR CONTORNO OJO
00001000  =00FFFFFF                 42  OJOFCOL     EQU     $00FFFFFF               ; COLOR RELLENO OJO
00001000                            43  
00001000                            44  
00001000                            45  
00001000                            46  ; --- CONSTANTES MARCADOR ----------------------------------------------------
00001000                            47  
00001000  =00000000                 48  PNTSFCOL    EQU     $00000000               ; COLOR FONDO MARCADOR (a determinar)
00001000  =00000065                 49  PNTSTEXT    EQU     0101                    ; COORDENADAS DEL MARCADOR (a determinar)
00001000                            50  
00001000                            51  
00001000                            52  
00001000                            53  
00001000                            54  
00001000                            55  
00001000                            56  
00001000                            57  -------------------- end include --------------------
00001000                            58              INCLUDE 'SYSCONST.X68'
00001000                            59  ; ----------------------------------------------------------------------------
00001000                            60  ; CONSTANTES DEL SISTEMA
00001000                            61  ; ----------------------------------------------------------------------------
00001000                            62  
00001000                            63  ; ---CONSTANTES DE LA PANTALLA------------------------------------------------
00001000                            64  
00001000  =00000280                 65  PANWIDTH    EQU     640                     ; ANCHO DE LA PANTALLA
00001000  =000001E0                 66  PANHEIGH    EQU     480                     ; ALTURA DE LA PANTALLA
00001000  =0090EE90                 67  COLFND      EQU     $90EE90                 ; COLOR DEL FONDO DE LA PANTALLA
00001000                            68  
00001000                            69  ; ---CONSTANTES DE LA MATRIZ--------------------------------------------------
00001000                            70  
00001000  =00000014                 71  SIZECLDA    EQU     20                      ; TAMAÑO DE CADA CELDA EN PIXELES
00001000  =00000020                 72  NUMCLMNS    EQU     32                      ; COLUMNAS DE CELDAS (640/10)
00001000  =00000018                 73  NUMFILAS    EQU     24                      ; FILAS DE CELDAS (480/10)
00001000  =00000300                 74  TCELDAS     EQU     768                     ; TOTAL DE CELDAS (64 * 48)
00001000                            75  
00001000                            76  ; ---CÓDIGOS DE TECLADO-------------------------------------------------------
00001000                            77  
00001000  =00000025                 78  KBDLEFT     EQU     $25
00001000  =00000026                 79  KBDUP       EQU     $26
00001000  =00000027                 80  KBDRIGHT    EQU     $27
00001000  =00000028                 81  KBDDOWN     EQU     $28
00001000                            82  
00001000                            83  
00001000                            84  -------------------- end include --------------------
00001000                            85              INCLUDE 'SYSTEM.X68'
00001000                            86   
00001000                            87   
00001000                            88  SYSINIT
00001000                            89  ; INICIA EL  SISTEMA
00001000                            90  ; INPUT    : NONE
00001000                            91  ; OUTPUT   : NONE
00001000                            92  ; MODIFIES : NONE
00001000                            93  ; ----------------------------------------------------------------------------
00001000  4EB9 0000101E             94              JSR     SCRINIT
00001006                            95              
00001006  21FC 0000104C 0080        96              MOVE.L  #SCRPLOT,($80)
0000100E  21FC 0000106E 0084        97              MOVE.L  #KBDUPD,($84)
00001016                            98              
00001016  40E7                      99              MOVE.W  SR,-(A7)
00001018  0257 DFFF                100              ANDI.W  #$DFFF,(A7)
0000101C                           101              
0000101C  4E73                     102              RTE
0000101E                           103              
0000101E                           104  ; ------------------------------------------------------------------------------
0000101E                           105  SCRINIT
0000101E                           106  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
0000101E                           107  ; ENABLE DOUBLE BUFFER.
0000101E                           108  ; INPUT    : NONE
0000101E                           109  ; OUTPUT   : NONE
0000101E                           110  ; MODIFIES : NONE
0000101E                           111  ; ------------------------------------------------------------------------------
0000101E                           112  
0000101E  48E7 C000                113              MOVEM.L D0-D1,-(A7)
00001022                           114  
00001022                           115              ; SET SCREEN RESOLUTION
00001022  103C 0021                116              MOVE.B  #33,D0
00001026  223C 028001E0            117              MOVE.L  #PANWIDTH<<16|PANHEIGH,D1
0000102C  4E4F                     118              TRAP    #15
0000102E                           119              
0000102E                           120              ; SET WINDOWED MODE
0000102E  7201                     121              MOVE.L  #1,D1
00001030  4E4F                     122              TRAP    #15
00001032                           123              
00001032                           124              ; CLEAR SCREEN
00001032  103C 000B                125              MOVE.B  #11,D0
00001036  323C FF00                126              MOVE.W  #$FF00,D1
0000103A  4E4F                     127              TRAP    #15
0000103C                           128              
0000103C                           129              ; ENABLE DOUBLE BUFFER
0000103C  103C 005C                130              MOVE.B  #92,D0
00001040  123C 0011                131              MOVE.B  #17,D1
00001044  4E4F                     132              TRAP    #15
00001046                           133              
00001046  4CDF 0003                134              MOVEM.L (A7)+,D0-D1
0000104A                           135              
0000104A  4E75                     136              RTS    
0000104C                           137  
0000104C                           138  ; ------------------------------------------------------------------------------
0000104C                           139  SCRPLOT
0000104C                           140  ; UPDATES DOUBLE BUFFER
0000104C                           141  ; INPUT    : NONE
0000104C                           142  ; OUTPUT   : NONE
0000104C                           143  ; MODIFIES : NONE
0000104C                           144  ; ------------------------------------------------------------------------------
0000104C                           145  
0000104C  48A7 C000                146              MOVEM.W D0-D1,-(A7)
00001050                           147              
00001050                           148              ; SWITCH BUFFERS
00001050  103C 005E                149              MOVE.B  #94,D0
00001054  4E4F                     150              TRAP    #15
00001056                           151              
00001056                           152              ; CLEAR HIDDEN BUFFER
00001056  103C 000B                153              MOVE.B  #11,D0
0000105A  323C FF00                154              MOVE.W  #$FF00,D1
0000105E  4E4F                     155              TRAP    #15
00001060                           156              
00001060  4C9F 0003                157              MOVEM.W (A7)+,D0-D1
00001064                           158              
00001064  4E73                     159              RTE
00001066                           160          
00001066                           161  ; ------------------------------------------------------------------------------
00001066                           162  KBDINIT
00001066                           163  ; INIT KEYBOARD
00001066                           164  ; INPUT    : NONE
00001066                           165  ; OUTPUT   : NONE
00001066                           166  ; MODIFIES : NONE
00001066                           167  ; ------------------------------------------------------------------------------
00001066                           168  
00001066  4239 00001BEE            169              CLR.B   (KBDEDGE)
0000106C  4E75                     170              RTS
0000106E                           171  
0000106E                           172  ; ------------------------------------------------------------------------------
0000106E                           173  KBDUPD
0000106E                           174  ; UPDATE KEYBOARD INFO.  
0000106E                           175  ; 7 -> PAUSE
0000106E                           176  ; 6 -> FIRE 3
0000106E                           177  ; 5 -> FIRE 2
0000106E                           178  ; 4 -> FIRE 1
0000106E                           179  ; 3 -> DOWN
0000106E                           180  ; 2 -> RIGHT
0000106E                           181  ; 1 -> UP
0000106E                           182  ; 0 -> LEFT
0000106E                           183  ; INPUT    : NONE
0000106E                           184  ; OUTPUT   : NONE
0000106E                           185  ; MODIFIES : NONE
0000106E                           186  ; ------------------------------------------------------------------------------
0000106E                           187  
0000106E  48E7 F000                188              MOVEM.L D0-D3,-(A7)
00001072                           189  
00001072                           190              ; LEE ESTADO DEL TECLADO
00001072  103C 0013                191              MOVE.B  #19,D0
00001076  223C 25262728            192              MOVE.L  #KBDLEFT<<24|KBDUP<<16|KBDRIGHT<<8|KBDDOWN,D1
0000107C  4E4F                     193              TRAP    #15                  ; Lee las teclas y guarda en D1
0000107E                           194  
0000107E                           195              ; CONVERT TO DESIRED FORMAT
0000107E  363C 0003                196              MOVE.W  #3,D3
00001082  E189                     197  .LOOP       LSL.L   #8,D1
00001084  E312                     198              ROXL.B  #1,D2
00001086  51CB FFFA                199              DBRA.W  D3,.LOOP
0000108A                           200  
0000108A                           201              ; PROCESA FLANCOS ASCENDENTES
0000108A  1039 00001BEE            202              MOVE.B  (KBDEDGE),D0         ; Estado anterior
00001090  4600                     203              NOT.B   D0                   ; Invertir bits (teclas no presionadas)
00001092  C002                     204              AND.B   D2,D0                ; Detectar flancos ascendentes
00001094  13C0 00001BEE            205              MOVE.B  D0,(KBDEDGE)         ; Almacena los flancos en KBDEDGE
0000109A                           206              
0000109A                           207              ; STORE KBDEDGE
0000109A  13C2 00001BEE            208              MOVE.B  D2,(KBDEDGE)
000010A0                           209  
000010A0  4CDF 000F                210              MOVEM.L (A7)+,D0-D3
000010A4  4E73                     211              RTE
000010A6                           212  
000010A6                           213  
000010A6                           214  
000010A6                           215  ; CODIGO ANTERIOR
000010A6                           216  
000010A6                           217  
000010A6                           218  
000010A6                           219  
000010A6                           220  
000010A6                           221  
000010A6                           222  
000010A6                           223  
000010A6                           224  
000010A6                           225  
000010A6                           226  
000010A6                           227  
000010A6                           228  
000010A6                           229  
000010A6                           230  
000010A6                           231  
000010A6                           232  
000010A6                           233  -------------------- end include --------------------
000010A6                           234              INCLUDE 'LIB/UTLCODE.X68'
000010A6                           235  ; =============================================================================
000010A6                           236  ; UTILITY CODE
000010A6                           237  ; =============================================================================
000010A6                           238  
000010A6                           239  ; -----------------------------------------------------------------------------
000010A6                           240  UTLINIT
000010A6                           241  ; INITIALIZES UTILITY CODE
000010A6                           242  ; INPUT    - NONE
000010A6                           243  ; OUTPUT   - NONE
000010A6                           244  ; MODIFIES - NONE
000010A6                           245  ; -----------------------------------------------------------------------------
000010A6  48E7 C000                246              MOVEM.L D0-D1,-(A7)
000010AA  103C 0008                247              MOVE.B  #8,D0
000010AE  4E4F                     248              TRAP    #15
000010B0  13C1 000018EA            249              MOVE.B  D1,(UTLRNDIX)
000010B6  4CDF 0003                250              MOVEM.L (A7)+,D0-D1
000010BA  4E75                     251              RTS
000010BC                           252  
000010BC                           253  ; -----------------------------------------------------------------------------
000010BC                           254  UTLRAND
000010BC                           255  ; PROVIDES A PSEUDO-RANDOM BYTE
000010BC                           256  ; INPUT    - NONE
000010BC                           257  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000010BC                           258  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010BC                           259  ; -----------------------------------------------------------------------------
000010BC  2F08                     260              MOVE.L  A0,-(A7)
000010BE  41F9 000010DA            261              LEA     .RANDVEC,A0
000010C4  4280                     262              CLR.L   D0
000010C6  1039 000018EA            263              MOVE.B  (UTLRNDIX),D0
000010CC  1030 0800                264              MOVE.B  (A0,D0.L),D0
000010D0  5239 000018EA            265              ADDQ.B  #1,(UTLRNDIX)
000010D6  205F                     266              MOVE.L  (A7)+,A0
000010D8  4E75                     267              RTS
000010DA                           268  
000010DA                           269  
000010DA= A2 EE 9A 0C F5 24 ...    270  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000010E2= 2A A3 51 26 E0 AC ...    271              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000010EA= 75 51 CA FD 33 EB ...    272              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000010F2= 60 CC E7 B8 9A EB ...    273              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000010FA= 1D 76 B5 95 B0 89 ...    274              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001102= 39 15 48 C9 6E CA ...    275              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
0000110A= 43 E7 E2 7C 37 25 ...    276              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001112= E9 94 CE E9 E4 52 ...    277              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
0000111A= 37 6D 9A 84 A2 28 ...    278              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001122= 19 E2 C6 77 80 D4 ...    279              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
0000112A= 0A 5A 32 67 33 C2 ...    280              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001132= 59 80 DC 0E 57 FC ...    281              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
0000113A= 8A AB BC F7 07 4D ...    282              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001142= EF D5 77 6E 1E BB ...    283              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
0000114A= D6 E0 2A 8F BD 28 ...    284              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001152= 13 4F 66 EC 0A 64 ...    285              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
0000115A= 56 52 9A 16 9B 90 ...    286              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001162= 06 8A A4 F7 01 DA ...    287              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
0000116A= F2 E7 77 28 B1 76 ...    288              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001172= A4 42 E3 81 B1 67 ...    289              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
0000117A= BF CE FA 16 BF 38 ...    290              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001182= D1 8B 50 0C 5F 49 ...    291              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
0000118A= DE 4C 14 A2 40 DC ...    292              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001192= B6 9B 0A 38 5D AB ...    293              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
0000119A= E2 1B DD 75 15 82 ...    294              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000011A2= 8A 26 51 30 9F 47 ...    295              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000011AA= 1E 8A BB 71 C6 6E ...    296              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000011B2= 9F 47 E5 34 94 27 ...    297              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000011BA= 7D 06 D6 BA 30 0F ...    298              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000011C2= EC 7F 7E 03 CF 2D ...    299              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000011CA= 94 5B 23 F2 8B CD ...    300              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000011D2= 74 33 EC B9 0F D5 ...    301              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000011D2= 74 33 EC B9 0F D5 ...    302  -------------------- end include --------------------
000011DA                           303              INCLUDE 'HEADSRP.X68'
000011DA                           304  
000011DA                           305  ; ------------------------------------------------------------------------------
000011DA                           306  HEADINIT
000011DA                           307  ; INICIALIZAR CABEZA.
000011DA                           308  ; INPUT    : NONE 
000011DA                           309  ; OUTPUT   : NONE
000011DA                           310  ; MODIFIES : NONE
000011DA                           311  ; ------------------------------------------------------------------------------
000011DA  33FC 0140 000018D6       312              MOVE.W  #PANWIDTH/2,(CBZPOSX)
000011E2  33FC 00F0 000018D8       313              MOVE.W  #PANHEIGH/2,(CBZPOSY)
000011EA  4279 000018E6            314              CLR     TRZPLOT
000011F0  13FC 0003 000018E6       315              MOVE.B  #3,TRZPLOT
000011F8  4279 00001BEC            316              CLR.W   ESTDCBZ
000011FE  33FC 0000 00001BEC       317              MOVE.W  #0,ESTDCBZ
00001206  4E75                     318              RTS
00001208                           319              
00001208                           320  ; ------------------------------------------------------------------------------
00001208                           321  HEADUPD
00001208                           322  ; ACTUALIZAR CABEZA.
00001208                           323  ; INPUT    : NONE 
00001208                           324  ; OUTPUT   : NONE
00001208                           325  ; MODIFIES : NONE
00001208                           326  ; ------------------------------------------------------------------------------
00001208  48A7 E000                327              MOVEM.W D0-D2,-(A7)
0000120C                           328                       
0000120C  4240                     329              CLR.W   D0
0000120E  4241                     330              CLR.W   D1
00001210  4242                     331              CLR.W   D2
00001212  3239 000018D6            332              MOVE.W  CBZPOSX,D1
00001218  33C1 000018E2            333              MOVE.W  D1,SGMPOSX
0000121E  3439 000018D8            334              MOVE.W  CBZPOSY,D2
00001224  33C2 000018E4            335              MOVE.W  D2,SGMPOSY
0000122A  4EB9 00001644            336              JSR     CINDMTRZ
00001230  4EB9 00001696            337              JSR     RSTCLD
00001236                           338              
00001236  4240                     339              CLR.W   D0
00001238  3039 00001BEC            340              MOVE.W  ESTDCBZ,D0
0000123E  B07C 0000                341              CMP.W   #0,D0
00001242  6700 001A                342              BEQ     SIGDER
00001246  B07C 0001                343              CMP.W   #1,D0
0000124A  6700 0036                344              BEQ     SIGARR
0000124E  B07C 0002                345              CMP.W   #2,D0
00001252  6700 0052                346              BEQ     SIGIZQ
00001256  B07C 0003                347              CMP.W   #3,D0
0000125A  6700 006E                348              BEQ     SIGABA
0000125E                           349              
0000125E  0679 0014 000018D6       350  SIGDER:     ADD.W   #CBZVEL,CBZPOSX               ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE 
00001266  3239 000018D6            351              MOVE.W  CBZPOSX,D1
0000126C  3439 000018D8            352              MOVE.W  CBZPOSY,D2
00001272  4EB9 00001644            353              JSR     CINDMTRZ
00001278  4EB9 0000167E            354              JSR     CBZOCPD  
0000127E  6000 006E                355              BRA     FIN
00001282                           356              
00001282  0479 0014 000018D8       357  SIGARR:     SUB.W   #CBZVEL,CBZPOSY              ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE
0000128A  3239 000018D6            358              MOVE.W  CBZPOSX,D1
00001290  3439 000018D8            359              MOVE.W  CBZPOSY,D2 
00001296  4EB9 00001644            360              JSR     CINDMTRZ
0000129C  4EB9 0000167E            361              JSR     CBZOCPD  
000012A2  6000 004A                362              BRA     FIN   
000012A6                           363    
000012A6  0479 0014 000018D6       364  SIGIZQ:     SUB.W   #CBZVEL,CBZPOSX              ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE 
000012AE  3239 000018D6            365              MOVE.W  CBZPOSX,D1
000012B4  3439 000018D8            366              MOVE.W  CBZPOSY,D2
000012BA  4EB9 00001644            367              JSR     CINDMTRZ
000012C0  4EB9 0000167E            368              JSR     CBZOCPD  
000012C6  6000 0026                369              BRA     FIN      
000012CA                           370  
000012CA  0679 0014 000018D8       371  SIGABA:     ADD.W   #CBZVEL,CBZPOSY               ;AUMENTAMOS LA POSICIÓN DE LA SERPIENTE 
000012D2  3239 000018D6            372              MOVE.W  CBZPOSX,D1
000012D8  3439 000018D8            373              MOVE.W  CBZPOSY,D2
000012DE  4EB9 00001644            374              JSR     CINDMTRZ 
000012E4  4EB9 0000167E            375              JSR     CBZOCPD  
000012EA  6000 0002                376              BRA     FIN      
000012EE                           377              
000012EE                           378  FIN:            
000012EE  4C9F 0007                379              MOVEM.W (A7)+,D0-D2
000012F2  4E75                     380              RTS
000012F4                           381              
000012F4                           382  ; ------------------------------------------------------------------------------
000012F4                           383  HEADPLOT
000012F4                           384  ; DIBUJAR CABEZA.
000012F4                           385  ; INPUT    : NONE 
000012F4                           386  ; OUTPUT   : NONE
000012F4                           387  ; MODIFIES : NONE
000012F4                           388  ; ------------------------------------------------------------------------------
000012F4  3F00                     389             MOVE.W  D0,-(A7)                ; GUARDAMOS D0
000012F6  3003                     390              MOVE.W  D3,D0                  ; PONEMOS EL INDICE DE LA CELDA EN D0 PARA CALCULAR SUS COORDENADAS
000012F8  4EB9 00001702            391              JSR     CNVICOOR
000012FE  2F01                     392              MOVE.L  D1,-(A7)
00001300                           393              
00001300                           394              ; SET COLOR DEL CONTORNO CABEZA
00001300  103C 0050                395              MOVE.B  #80,D0
00001304  223C 0000FF00            396              MOVE.L  #CBZPCOL,D1
0000130A  4E4F                     397              TRAP    #15
0000130C                           398              
0000130C                           399              ; SET COLOR DEL RELLENO CABEZA
0000130C  103C 0051                400              MOVE.B  #81,D0
00001310  223C 0000AA00            401              MOVE.L  #CBZFCOL,D1
00001316  4E4F                     402              TRAP    #15
00001318                           403              
00001318                           404              ; DIBUJAR CABEZA
00001318  103C 0057                405              MOVE.B  #87,D0
0000131C  221F                     406              MOVE.L  (A7)+,D1
0000131E  3F03                     407              MOVE.W  D3,-(A7)
00001320  3601                     408              MOVE.W  D1,D3
00001322  0643 0014                409              ADD.W   #CBZWIDTH,D3
00001326  3802                     410              MOVE.W  D2,D4
00001328  0644 0014                411              ADD.W   #CBZHEIGH,D4
0000132C  4E4F                     412              TRAP    #15
0000132E                           413              
0000132E  2F01                     414              MOVE.L  D1,-(A7)
00001330                           415              
00001330                           416              ; SET COLOR DEL CONTORNO OJO
00001330  103C 0050                417              MOVE.B  #80,D0
00001334  7200                     418              MOVE.L  #OJOPCOL,D1
00001336  4E4F                     419              TRAP    #15
00001338                           420              
00001338                           421              ; SET COLOR DEL RELLENO OJO
00001338  103C 0051                422              MOVE.B  #81,D0
0000133C  223C 00FFFFFF            423              MOVE.L  #OJOFCOL,D1
00001342  4E4F                     424              TRAP    #15
00001344                           425              
00001344                           426              ; DIBUJAR OJO
00001344  103C 0058                427              MOVE.B  #88,D0
00001348  221F                     428              MOVE.L  (A7)+,D1
0000134A  2F01                     429              MOVE.L  D1,-(A7)
0000134C  2F02                     430              MOVE.L  D2,-(A7)
0000134E  5A41                     431              ADD.W   #OJOWIDTH/2,D1            
00001350  3601                     432              MOVE.W  D1,D3
00001352  0643 000A                433              ADD.W   #OJOWIDTH,D3
00001356  5A42                     434              ADD.W   #OJOHEIGH/2,D2
00001358  3802                     435              MOVE.W  D2,D4
0000135A  0644 000A                436              ADD.W   #OJOHEIGH,D4
0000135E  4E4F                     437              TRAP    #15
00001360                           438  
00001360                           439              ; DEFINIR COORDENADAS IRIS
00001360  241F                     440              MOVE.L  (A7)+,D2
00001362  221F                     441              MOVE.L  (A7)+,D1
00001364  0641 000A                442              ADD.W   #OJOWIDTH,D1
00001368  0642 000A                443              ADD.W   #OJOHEIGH,D2
0000136C  103C 0052                444              MOVE.B  #82,D0
00001370  4E4F                     445              TRAP    #15
00001372                           446              
00001372                           447              
00001372  361F                     448              MOVE.W  (A7)+,D3
00001374  301F                     449              MOVE.W  (A7)+,D0
00001376                           450  
00001376                           451  
00001376  4E75                     452              RTS
00001378                           453  
00001378                           454  
00001378                           455  
00001378                           456  
00001378                           457  
00001378                           458  
00001378                           459  
00001378                           460  
00001378                           461  
00001378                           462  
00001378                           463  
00001378                           464  
00001378                           465  
00001378                           466  
00001378                           467  
00001378                           468  
00001378                           469  -------------------- end include --------------------
00001378                           470              INCLUDE 'SEGSRP.X68'
00001378                           471  
00001378                           472  ; ------------------------------------------------------------------------------
00001378                           473  SEGINIT
00001378                           474  ; INICIALIZAR SEGMENTO.
00001378                           475  ; INPUT    : NONE 
00001378                           476  ; OUTPUT   : NONE
00001378                           477  ; MODIFIES : NONE
00001378                           478  ; ------------------------------------------------------------------------------
00001378  33FC 012C 000018E2       479              MOVE.W  #(PANWIDTH/2)-CBZWIDTH,(SGMPOSX)
00001380  33FC 00F0 000018E4       480              MOVE.W  #PANHEIGH/2,(SGMPOSY)
00001388  4E75                     481              RTS
0000138A                           482              
0000138A                           483  ; ------------------------------------------------------------------------------
0000138A                           484  SEGUPD
0000138A                           485  ; ACTUALIZAR SEGMENTO.
0000138A                           486  ; INPUT    : NONE 
0000138A                           487  ; OUTPUT   : NONE
0000138A                           488  ; MODIFIES : NONE
0000138A                           489  ; ------------------------------------------------------------------------------
0000138A  48A7 6000                490              MOVEM.W D1-D2,-(A7)
0000138E                           491              
0000138E  3239 000018E2            492              MOVE.W  SGMPOSX,D1
00001394  33C1 000018DE            493              MOVE.W  D1,COLPOSX
0000139A  3439 000018E4            494              MOVE.W  SGMPOSY,D2
000013A0  33C2 000018E0            495              MOVE.W  D2,COLPOSY
000013A6  4EB9 00001644            496              JSR     CINDMTRZ
000013AC  4EB9 00001696            497              JSR     RSTCLD
000013B2                           498              
000013B2  4C9F 0006                499              MOVEM.W (A7)+,D1-D2            
000013B6  4E75                     500              RTS
000013B8                           501              
000013B8                           502  ; ------------------------------------------------------------------------------
000013B8                           503  SEGPLOT
000013B8                           504  ; DIBUJAR SEGMENTO.
000013B8                           505  ; INPUT    : NONE 
000013B8                           506  ; OUTPUT   : NONE
000013B8                           507  ; MODIFIES : NONE
000013B8                           508  ; ------------------------------------------------------------------------------
000013B8  3F00                     509              MOVE.W  D0,-(A7)
000013BA  3003                     510              MOVE.W  D3,D0
000013BC  4EB9 00001702            511              JSR     CNVICOOR
000013C2  2F01                     512              MOVE.L  D1,-(A7)
000013C4                           513              
000013C4  103C 0050                514              MOVE.B  #80,D0
000013C8  223C 0000FF00            515              MOVE.L  #SGMPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DEL SEGMENTO
000013CE  4E4F                     516              TRAP    #15
000013D0                           517              
000013D0  103C 0051                518              MOVE.B  #81,D0
000013D4  223C 0000AA00            519              MOVE.L  #SGMFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DEL SEGMENTO
000013DA  4E4F                     520              TRAP    #15
000013DC                           521              
000013DC  103C 0057                522              MOVE.B  #87,D0
000013E0  221F                     523              MOVE.L  (A7)+,D1
000013E2  3F03                     524              MOVE.W  D3,-(A7)
000013E4  3601                     525              MOVE.W  D1,D3
000013E6  0643 0014                526              ADD.W   #SIZECLDA,D3
000013EA  3802                     527              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
000013EC  0644 0014                528              ADD.W   #SIZECLDA,D4
000013F0  4E4F                     529              TRAP    #15                     
000013F2                           530                          
000013F2  361F                     531              MOVE.W  (A7)+,D3  
000013F4  301F                     532              MOVE.W  (A7)+,D0
000013F6                           533  
000013F6                           534  
000013F6  4E75                     535              RTS
000013F8                           536  
000013F8                           537  
000013F8                           538  
000013F8                           539  
000013F8                           540  
000013F8                           541  
000013F8                           542  
000013F8                           543  
000013F8                           544  
000013F8                           545  -------------------- end include --------------------
000013F8                           546              INCLUDE 'TAILSRP.X68'
000013F8                           547     
000013F8                           548  ; ------------------------------------------------------------------------------
000013F8                           549  TAILINIT
000013F8                           550  ; INICIALIZAR COLA.
000013F8                           551  ; INPUT    : NONE 
000013F8                           552  ; OUTPUT   : NONE
000013F8                           553  ; MODIFIES : NONE
000013F8                           554  ; ------------------------------------------------------------------------------
000013F8  33FC 011D 000018DE       555              MOVE.W  #(PANWIDTH/2)-CBZWIDTH-SGMWIDTH+(COLWIDTH/2),(COLPOSX)
00001400  33FC 00F0 000018E0       556              MOVE.W  #(PANHEIGH/2),(COLPOSY)
00001408  4E75                     557              RTS
0000140A                           558              
0000140A                           559              
0000140A                           560  ; ------------------------------------------------------------------------------
0000140A                           561  TAILUPD
0000140A                           562  ; ACTUALIZAR COLA.
0000140A                           563  ; INPUT    : NONE 
0000140A                           564  ; OUTPUT   : NONE
0000140A                           565  ; MODIFIES : NONE
0000140A                           566  ; ------------------------------------------------------------------------------
0000140A  48A7 6000                567              MOVEM.W D1-D2,-(A7)
0000140E                           568              
0000140E  3239 000018DE            569              MOVE.W  COLPOSX,D1
00001414  3439 000018E0            570              MOVE.W  COLPOSY,D2
0000141A  4EB9 00001644            571              JSR     CINDMTRZ
00001420  4EB9 00001696            572              JSR     RSTCLD 
00001426                           573              
00001426  4C9F 0006                574              MOVEM.W (A7)+,D1-D2            
0000142A  4E75                     575              RTS
0000142C                           576              
0000142C                           577  ; ------------------------------------------------------------------------------
0000142C                           578  TAILPLOT
0000142C                           579  ; DIBUJAR COLA
0000142C                           580  ; INPUT    : NONE 
0000142C                           581  ; OUTPUT   : NONE
0000142C                           582  ; MODIFIES : NONE
0000142C                           583  ; ------------------------------------------------------------------------------
0000142C  3F00                     584              MOVE.W  D0,-(A7)
0000142E  3003                     585              MOVE.W  D3,D0
00001430  4EB9 00001702            586              JSR     CNVICOOR
00001436  2F01                     587              MOVE.L  D1,-(A7)
00001438                           588              
00001438  103C 0050                589              MOVE.B  #80,D0
0000143C  223C 0000FF00            590              MOVE.L  #COLPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA COLA
00001442  4E4F                     591              TRAP    #15
00001444                           592              
00001444  103C 0051                593              MOVE.B  #81,D0
00001448  223C 0000AA00            594              MOVE.L  #COLFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA COLA
0000144E  4E4F                     595              TRAP    #15
00001450                           596              
00001450  103C 0057                597              MOVE.B  #87,D0
00001454  221F                     598              MOVE.L  (A7)+,D1
00001456  3F03                     599              MOVE.W  D3,-(A7)
00001458  3601                     600              MOVE.W  D1,D3
0000145A  0643 0014                601              ADD.W   #SIZECLDA,D3
0000145E  3802                     602              MOVE.W  D2,D4                    
00001460  0644 0014                603              ADD.W   #SIZECLDA,D4
00001464  4E4F                     604              TRAP    #15                    ; DIBUJAMOS EL CUADRADO 
00001466                           605                          
00001466  361F                     606              MOVE.W  (A7)+,D3  
00001468  301F                     607              MOVE.W  (A7)+,D0
0000146A                           608  
0000146A  4E75                     609              RTS
0000146C                           610  
0000146C                           611  
0000146C                           612  
0000146C                           613  
0000146C                           614  
0000146C                           615  
0000146C                           616  
0000146C                           617  
0000146C                           618  -------------------- end include --------------------
0000146C                           619              INCLUDE 'APPLE.X68'
0000146C                           620     
0000146C                           621  ; ------------------------------------------------------------------------------
0000146C                           622  APPLEINIT
0000146C                           623  ; Inicializa la manzana en una posición aleatoria
0000146C                           624  ; INPUT    : NONE 
0000146C                           625  ; OUTPUT   : NONE
0000146C                           626  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
0000146C                           627  ; ------------------------------------------------------------------------------
0000146C                           628  
0000146C                           629              ; Llama a la función para generar la posición aleatoria
0000146C  4EB9 0000155A            630              JSR     GENPOSMNZ
00001472                           631  
00001472                           632              ; Convierte las coordenadas de la manzana a índice de la matriz
00001472  4EB9 00001644            633              JSR     CINDMTRZ
00001478                           634  
00001478                           635              ; Verifica si la celda está ocupada o libre
00001478                           636  CHECK:
00001478  4EB9 0000173E            637              JSR     CHECKCLD
0000147E  6700 0010                638              BEQ     MARKMNZ                  ; Si está libre
00001482                           639  
00001482                           640              ; Si la celda está ocupada
00001482  4EB9 0000155A            641              JSR     GENPOSMNZ                ; Genera una nueva posición
00001488  4EB9 00001644            642              JSR     CINDMTRZ                 ; Convierte las nuevas coordenadas
0000148E  60E8                     643              BRA     CHECK                    ; Repite la comprobación
00001490                           644  
00001490                           645  MARKMNZ:
00001490                           646              ; Marca la celda como ocupada con la manzana (estado 4)
00001490  4EB9 000016EC            647              JSR     MNZOCPD
00001496                           648  
00001496                           649              ; Dibuja la manzana en la pantalla
00001496  4EB9 000014DC            650              JSR     APPLEPLOT
0000149C                           651  
0000149C  4E75                     652              RTS
0000149E                           653              
0000149E                           654              ;MOVE.W  #30,(MNZPOSX)   ;DE MOMENTO PONGO X E Y ELEGIDAS MANUALMENTE, EN TEORÍA DEBE SER ALEATORIO
0000149E                           655              ;MOVE.W  #30,(MNZPOSY)
0000149E                           656  
0000149E                           657  ; ------------------------------------------------------------------------------
0000149E                           658  APPLEUPD
0000149E                           659  ; Actualiza la posición de la manzana cuando la serpiente come
0000149E                           660  ; INPUT    : NONE 
0000149E                           661  ; OUTPUT   : NONE
0000149E                           662  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
0000149E                           663  ; ------------------------------------------------------------------------------
0000149E                           664  
0000149E                           665              ; Convierte las coordenadas actuales de la manzana a índice de la matriz
0000149E  4EB9 00001644            666              JSR     CINDMTRZ
000014A4                           667  
000014A4                           668              ; Marca la celda anterior como vacía
000014A4  4EB9 000016AA            669              JSR     MCLDVCIA
000014AA                           670  
000014AA                           671              ; Llama a la función para generar una nueva posición aleatoria
000014AA  4EB9 0000155A            672              JSR     GENPOSMNZ
000014B0                           673  
000014B0                           674              ; Convierte las nuevas coordenadas de la manzana a índice de la matriz
000014B0  4EB9 00001644            675              JSR     CINDMTRZ
000014B6                           676  
000014B6                           677  CHCKUPDT:
000014B6  4EB9 0000173E            678              JSR     CHECKCLD             ; Verifica si la celda está libre
000014BC  6700 0010                679              BEQ     NEWMNZ               ; Si está libre
000014C0                           680  
000014C0                           681              ; Si la celda está ocupada
000014C0  4EB9 0000155A            682              JSR     GENPOSMNZ            ; Genera una nueva posición
000014C6  4EB9 00001644            683              JSR     CINDMTRZ             ; Convierte las nuevas coordenadas
000014CC  60E8                     684              BRA     CHCKUPDT             ; Repite la comprobación
000014CE                           685  
000014CE                           686  NEWMNZ:
000014CE                           687              ; Marca la celda como ocupada con la manzana (estado 4)
000014CE  4EB9 000016EC            688              JSR     MNZOCPD
000014D4                           689  
000014D4                           690              ; Dibuja la nueva manzana en la pantalla
000014D4  4EB9 000014DC            691              JSR     APPLEPLOT
000014DA                           692  
000014DA  4E75                     693              RTS
000014DC                           694              
000014DC                           695  ; ------------------------------------------------------------------------------
000014DC                           696  APPLEPLOT
000014DC                           697  ; Dibuja la manzana
000014DC                           698  ; INPUT    : NONE 
000014DC                           699  ; OUTPUT   : NONE
000014DC                           700  ; MODIFIES : NONE
000014DC                           701  ; ------------------------------------------------------------------------------
000014DC  3F00                     702              MOVE.W  D0,-(A7)
000014DE  3003                     703              MOVE.W  D3,D0
000014E0  4EB9 00001702            704              JSR     CNVICOOR
000014E6  2F01                     705              MOVE.L  D1,-(A7)                ; PRIMERO DEBEMOS DIBUJAR EL FONDO Y LUEGO LA MANZANA
000014E8                           706              
000014E8  103C 0050                707              MOVE.B  #80,D0
000014EC  223C 0090EE90            708              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
000014F2  4E4F                     709              TRAP    #15
000014F4                           710              
000014F4  103C 0051                711              MOVE.B  #81,D0
000014F8  223C 0090EE90            712              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
000014FE  4E4F                     713              TRAP    #15
00001500                           714              
00001500  103C 0057                715              MOVE.B  #87,D0
00001504  221F                     716              MOVE.L  (A7)+,D1
00001506  3F03                     717              MOVE.W  D3,-(A7)
00001508  3601                     718              MOVE.W  D1,D3
0000150A  0643 0014                719              ADD.W   #SIZECLDA,D3
0000150E  3802                     720              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001510  0644 0014                721              ADD.W   #SIZECLDA,D4
00001514  4E4F                     722              TRAP    #15                     
00001516                           723                          
00001516  361F                     724              MOVE.W  (A7)+,D3  
00001518  301F                     725              MOVE.W  (A7)+,D0
0000151A                           726  
0000151A  3F00                     727              MOVE.W  D0,-(A7)
0000151C  3003                     728              MOVE.W  D3,D0
0000151E  4EB9 00001702            729              JSR     CNVICOOR
00001524  2F01                     730              MOVE.L  D1,-(A7)
00001526                           731              
00001526  103C 0050                732              MOVE.B  #80,D0
0000152A  223C 0000AAFF            733              MOVE.L  #MNZPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA MANZANA
00001530  4E4F                     734              TRAP    #15
00001532                           735              
00001532  103C 0051                736              MOVE.B  #81,D0
00001536  223C 000000FF            737              MOVE.L  #MNZFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA MANZANA
0000153C  4E4F                     738              TRAP    #15
0000153E                           739              
0000153E  103C 0058                740              MOVE.B  #88,D0
00001542  221F                     741              MOVE.L  (A7)+,D1
00001544  3F03                     742              MOVE.W  D3,-(A7)
00001546  3601                     743              MOVE.W  D1,D3
00001548  0643 0014                744              ADD.W   #SIZECLDA,D3
0000154C  3802                     745              MOVE.W  D2,D4                    ; DIBUJAMOS EL CIRCULO
0000154E  0644 0014                746              ADD.W   #SIZECLDA,D4
00001552  4E4F                     747              TRAP    #15                     
00001554                           748                          
00001554  361F                     749              MOVE.W  (A7)+,D3  
00001556  301F                     750              MOVE.W  (A7)+,D0
00001558                           751  
00001558                           752  
00001558  4E75                     753              RTS
0000155A                           754  ; ----------------------------------------------------------------------------
0000155A                           755  GENPOSMNZ
0000155A                           756  ; Genera una posición aleatoria para la manzana
0000155A                           757  ; INPUT: NONE
0000155A                           758  ; OUTPUT:
0000155A                           759  ; MODIFIES: MNZPOSX, MNZPOSY
0000155A                           760  ; ----------------------------------------------------------------------------
0000155A                           761  
0000155A  48E7 8000                762              MOVEM.L D0,-(A7)
0000155E                           763  
0000155E                           764              ; Genera la coordenada X aleatoria
0000155E  4EB8 10BC                765              JSR     UTLRAND
00001562  0240 001F                766              ANDI.W  #NUMCLMNS-1, D0       ; Asegura que esté en [0, NUMCLMNS-1]
00001566  C0FC 0014                767              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
0000156A  3200                     768              MOVE.W  D0,D1
0000156C  33C0 000018D2            769              MOVE.W  D0, MNZPOSX           ; Guarda la coordenada X generada
00001572                           770              
00001572                           771              ; Generar coordenada Y aleatoria
00001572  4EB8 10BC                772              JSR     UTLRAND
00001576  0240 0017                773              ANDI.W  #NUMFILAS-1, D0       ; Asegura que esté en el rango [0, NUMFILAS-1]
0000157A  C0FC 0014                774              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
0000157E  3400                     775              MOVE.W  D0,D2
00001580  33C0 000018D4            776              MOVE.W  D0, MNZPOSY           ; Guarda la coordenada Y generada
00001586                           777              
00001586  4CDF 0001                778              MOVEM.L (A7)+,D0
0000158A  4E75                     779              RTS 
0000158C                           780  
0000158C                           781  
0000158C                           782  
0000158C                           783  -------------------- end include --------------------
0000158C                           784              INCLUDE 'SCORE.X68'
0000158C                           785     
0000158C                           786  ; ------------------------------------------------------------------------------
0000158C                           787  SCOINIT
0000158C                           788  ; INICIALIZAR MARCADOR.
0000158C                           789  ; INPUT    : NONE 
0000158C                           790  ; OUTPUT   : NONE
0000158C                           791  ; MODIFIES : NONE
0000158C                           792  ; ------------------------------------------------------------------------------
0000158C  4279 000018E8            793              CLR.W   (JGOPNTS)
00001592  4E75                     794              RTS
00001594                           795              
00001594                           796  ; ------------------------------------------------------------------------------
00001594                           797  SCOUPD
00001594                           798  ; ACTUALIZAR MARCADOR.
00001594                           799  ; INPUT    : NONE 
00001594                           800  ; OUTPUT   : NONE
00001594                           801  ; MODIFIES : NONE
00001594                           802  ; ------------------------------------------------------------------------------
00001594  4E75                     803              RTS
00001596                           804              
00001596                           805  ; ------------------------------------------------------------------------------
00001596                           806  SCOPLOT
00001596                           807  ; DIBUJAR MARCADOR.
00001596                           808  ; INPUT    : NONE 
00001596                           809  ; OUTPUT   : NONE
00001596                           810  ; MODIFIES : NONE
00001596                           811  ; ------------------------------------------------------------------------------
00001596  48E7 C040                812             MOVEM.L  D0-D1/A1,-(A7)
0000159A                           813             ; SET COLOR DE FONDO
0000159A  103C 0051                814             MOVE.B   #81,D0
0000159E  223C 0090EE90            815             MOVE.L   #COLFND,D1
000015A4  4E4F                     816             TRAP     #15
000015A6                           817             
000015A6                           818             
000015A6                           819             
000015A6                           820             ; DIBUJAR LINEA DE PUNTUACIÓN
000015A6  43F9 000015C0            821              LEA     .TXT1,A1
000015AC  4281                     822              CLR.L   D1
000015AE  3239 000018E8            823              MOVE.W  (JGOPNTS),D1
000015B4  103C 0011                824              MOVE.B  #17,D0
000015B8  4E4F                     825              TRAP    #15
000015BA                           826              
000015BA  4CDF 0203                827              MOVEM.L (A7)+,D0-D1/A1
000015BE  4E75                     828              RTS
000015C0                           829  
000015C0                           830  
000015C0= 50 55 4E 54 4F 53 ...    831  .TXT1       DC.B    'PUNTOS : ',0
000015CA                           832  
000015CA                           833  
000015CA                           834  -------------------- end include --------------------
000015CA                           835              INCLUDE 'MATRIZ.X68'
000015CA                           836  ; ----------------------------------------------------------------------------
000015CA                           837  ; MATRIZ
000015CA                           838  ; ----------------------------------------------------------------------------
000015CA                           839  
000015CA                           840  ;-----------------------------------------------------------------------------
000015CA                           841  MTZINIT
000015CA                           842  ; INICIALIZA LA MATRIZ, AL PRINCIPIO ESTÁ VACÍA
000015CA                           843  ; INPUT    : NONE
000015CA                           844  ; OUTPUT   : NONE
000015CA                           845  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000015CA                           846  ; ----------------------------------------------------------------------------
000015CA                           847              
000015CA  48A7 E080                848              MOVEM.W D0-D2/A0,-(A7)
000015CE                           849              
000015CE  41F9 000018EC            850              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
000015D4  303C 0300                851              MOVE.W #TCELDAS, D0    ; Número total de celdas
000015D8                           852  
000015D8                           853  CLNCLDS:
000015D8  4218                     854              CLR.B (A0)+            ; Coloca 0 en cada celda
000015DA  5340                     855              SUBI.W #1, D0          ; Decrementa el contador de celdas
000015DC  66FA                     856              BNE CLNCLDS            ; Repite hasta que esten vacías
000015DE                           857              
000015DE                           858              
000015DE  3239 000018D6            859              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
000015E4  3439 000018D8            860              MOVE.W  CBZPOSY, D2
000015EA  4EB9 00001644            861              JSR     CINDMTRZ
000015F0  4EB9 0000167E            862              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
000015F6                           863              
000015F6  3239 000018E2            864              MOVE.W  SGMPOSX, D1
000015FC  3439 000018E4            865              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
00001602  4EB9 00001644            866              JSR     CINDMTRZ
00001608  4EB9 000016C0            867              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
0000160E                           868              
0000160E  3239 000018DE            869              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
00001614  3439 000018E0            870              MOVE.W  COLPOSY, D2
0000161A  4EB9 00001644            871              JSR     CINDMTRZ
00001620  4EB9 000016D6            872              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
00001626                           873              
00001626  3239 000018D2            874              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
0000162C  3439 000018D4            875              MOVE.W  MNZPOSY, D2
00001632  4EB9 00001644            876              JSR     CINDMTRZ
00001638  4EB9 000016EC            877              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
0000163E                           878              
0000163E                           879              
0000163E  4C9F 0107                880              MOVEM.W (A7)+,D0-D2/A0
00001642                           881  
00001642  4E75                     882              RTS
00001644                           883  
00001644                           884  ;-----------------------------------------------------------------------------
00001644                           885  CINDMTRZ
00001644                           886  ; CALCULA EL ÍNDICE DE UNA CELDA
00001644                           887  ; INPUT    : D1 = coordenada X pantalla, D2 = coordenada Y pantalla
00001644                           888  ; OUTPUT   : D0 = índice de la celda en ESTDCLDS
00001644                           889  ; MODIFIES : NONE
00001644                           890  ; ----------------------------------------------------------------------------
00001644                           891  
00001644  48A7 7000                892               MOVEM.W D1-D3,-(A7)     ; Guarda los registros D1-D3 en la pila
00001648                           893  
00001648                           894              ; Divide X por SIZECLDA
00001648  3601                     895              MOVE.W  D1, D3          ; Copia X a D3
0000164A  4241                     896              CLR.W   D1              ; Inicializa el cociente de X
0000164C                           897  
0000164C  B67C 0014                898  DIVX:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
00001650  6D00 000A                899              BLT     ENDDIVX         ; Si D3 < SIZECLDA, salta a ENDDIVX
00001654  0443 0014                900              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
00001658  5241                     901              ADDQ.W  #1, D1          ; Incrementa el cociente de X
0000165A  60F0                     902              BRA     DIVX            ; Repite el bucle
0000165C                           903  
0000165C                           904  ENDDIVX:
0000165C                           905  
0000165C                           906              ; Divide Y por SIZECLDA
0000165C  3602                     907              MOVE.W  D2, D3          ; Copia Y a D3
0000165E  4242                     908              CLR.W   D2              ; Inicializa el cociente de Y
00001660                           909  
00001660  B67C 0014                910  DIVY:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
00001664  6D00 000A                911              BLT     ENDDIVY         ; Si D3 < SIZECLDA, salta a ENDDIVY
00001668  0443 0014                912              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
0000166C  5242                     913              ADDQ.W  #1, D2          ; Incrementa el cociente de Y
0000166E  60F0                     914              BRA     DIVY            ; Repite el bucle
00001670                           915  
00001670                           916  ENDDIVY:
00001670                           917  
00001670                           918              ; Calcula el índice
00001670  4240                     919              CLR.W   D0
00001672  3002                     920              MOVE.W  D2, D0          ; D0 = Y_CELDA
00001674  EB40                     921              ASL.W   #5, D0          ; D0 = Y_CELDA * NUMCLMNS (32 = 2^5)
00001676  D041                     922              ADD.W   D1, D0          ; D0 = Y_CELDA * NUMCLMNS + X_CELDA
00001678                           923  
00001678  4C9F 000E                924              MOVEM.W (A7)+,D1-D3     ; Restaura los registros D1-D3 desde la pila
0000167C                           925  
0000167C  4E75                     926              RTS  
0000167E                           927              
0000167E                           928  ;-----------------------------------------------------------------------------
0000167E                           929  CBZOCPD
0000167E                           930  ; MARCA UNA CELDA COMO OCUPADA POR LA CABEZA
0000167E                           931  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000167E                           932  ; OUTPUT   : NONE
0000167E                           933  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000167E                           934  ; ----------------------------------------------------------------------------
0000167E                           935  
0000167E  48A7 0080                936              MOVEM.W A0,-(A7)
00001682                           937  
00001682  41F9 000018EC            938              LEA     ESTDCLDS, A0                ; Dirección de la matriz en A0
00001688  11B9 000018E6 0000       939              MOVE.B  TRZPLOT, (A0, D0.W)           ; Marca la celda como ocupada
00001690                           940              
00001690  4C9F 0100                941              MOVEM.W (A7)+,A0
00001694                           942              
00001694  4E75                     943              RTS
00001696                           944              
00001696                           945              
00001696                           946              
00001696                           947  ;-----------------------------------------------------------------------------
00001696                           948  RSTCLD
00001696                           949  ; RESTA 1 A LA CELDA PASADA POR PARÁMETRO
00001696                           950  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001696                           951  ; OUTPUT   : NONE
00001696                           952  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001696                           953  ; ----------------------------------------------------------------------------
00001696                           954  
00001696  48A7 0080                955              MOVEM.W A0,-(A7)
0000169A                           956  
0000169A  41F9 000018EC            957              LEA     ESTDCLDS, A0              ; Dirección de la matriz en A0
000016A0  5330 0000                958              SUBQ.B   #1, (A0, D0.W)           ; Marca la celda como ocupada
000016A4                           959              
000016A4  4C9F 0100                960              MOVEM.W (A7)+,A0
000016A8                           961              
000016A8  4E75                     962              RTS
000016AA                           963             
000016AA                           964  ;-----------------------------------------------------------------------------
000016AA                           965  MCLDVCIA
000016AA                           966  ; MARCA UNA CELDA COMO VACÍA
000016AA                           967  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016AA                           968  ; OUTPUT   : NONE
000016AA                           969  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016AA                           970  ; ----------------------------------------------------------------------------
000016AA                           971  
000016AA  48A7 0080                972              MOVEM.W A0,-(A7)
000016AE                           973  
000016AE  41F9 000018EC            974              LEA ESTDCLDS, A0                ; Direccion de la matriz en A0
000016B4  11BC 0000 0000           975              MOVE.B #0, (A0, D0.W)           ; Marca la celda como vacía
000016BA                           976              
000016BA  4C9F 0100                977              MOVEM.W (A7)+,A0
000016BE                           978              
000016BE  4E75                     979              RTS
000016C0                           980  
000016C0                           981  ;-----------------------------------------------------------------------------
000016C0                           982  SGMOCPD
000016C0                           983  ; MARCA UNA CELDA COMO OCUPADA POR EL SEGMENTO
000016C0                           984  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016C0                           985  ; OUTPUT   : NONE
000016C0                           986  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016C0                           987  ; ----------------------------------------------------------------------------
000016C0                           988  
000016C0  48A7 0080                989              MOVEM.W A0,-(A7)
000016C4                           990  
000016C4  41F9 000018EC            991              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
000016CA  11BC 0002 0000           992              MOVE.B #2, (A0, D0.W)           ; Marca la celda como ocupada
000016D0                           993              
000016D0  4C9F 0100                994              MOVEM.W (A7)+,A0
000016D4                           995              
000016D4  4E75                     996              RTS
000016D6                           997              
000016D6                           998  ;-----------------------------------------------------------------------------
000016D6                           999  COLOCPD
000016D6                          1000  ; MARCA UNA CELDA COMO OCUPADA POR LA COLA
000016D6                          1001  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016D6                          1002  ; OUTPUT   : NONE
000016D6                          1003  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016D6                          1004  ; ----------------------------------------------------------------------------
000016D6                          1005  
000016D6  48A7 0080               1006              MOVEM.W A0,-(A7)
000016DA                          1007  
000016DA  41F9 000018EC           1008              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
000016E0  11BC 0001 0000          1009              MOVE.B #1, (A0, D0.W)           ; Marca la celda como ocupada
000016E6                          1010              
000016E6  4C9F 0100               1011              MOVEM.W (A7)+,A0
000016EA                          1012              
000016EA  4E75                    1013              RTS
000016EC                          1014  
000016EC                          1015  
000016EC                          1016  ;-----------------------------------------------------------------------------
000016EC                          1017  MNZOCPD
000016EC                          1018  ; MARCA UNA CELDA COMO OCUPADA POR LA MANZANA
000016EC                          1019  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016EC                          1020  ; OUTPUT   : NONE
000016EC                          1021  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016EC                          1022  ; ----------------------------------------------------------------------------
000016EC                          1023  
000016EC  48A7 0080               1024              MOVEM.W A0,-(A7)
000016F0                          1025  
000016F0  41F9 000018EC           1026              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
000016F6  11BC 0004 0000          1027              MOVE.B #4, (A0, D0.W)           ; Marca la celda como ocupada
000016FC                          1028              
000016FC  4C9F 0100               1029              MOVEM.W (A7)+,A0
00001700                          1030              
00001700  4E75                    1031              RTS
00001702                          1032  
00001702                          1033              
00001702                          1034  ;-----------------------------------------------------------------------------
00001702                          1035  CNVICOOR
00001702                          1036  ; Convierte un índice de celda a coordenadas de pantalla (X, Y)
00001702                          1037  ; INPUT    : D0 = índice de la celda en ESTADO_CELDAS
00001702                          1038  ; OUTPUT   : D1 = coordenada X, D2 = coordenada Y
00001702                          1039  ; MODIFIES : NONE
00001702                          1040  ; ----------------------------------------------------------------------------
00001702                          1041  
00001702  48A7 9800               1042              MOVEM.W D0/D3-D4,-(A7)
00001706                          1043  
00001706  3400                    1044              MOVE.W  D0,D2         ; Copia índice a D2 para calcular la fila
00001708  EA4A                    1045              LSR.W   #5,D2         ; D2 = índice / NUM_COLUMNAS (32 = 2^5)
0000170A  3200                    1046              MOVE.W  D0,D1         ; Copia índice a D1 para calcular la columna
0000170C  C27C 001F               1047              AND.W   #$1F,D1       ; D1 = índice % NUM_COLUMNAS (31 = 0x1F) (CREO)
00001710                          1048  
00001710                          1049              ; Multiplica por TAMAÑO_CELDA = 10
00001710  363C 0014               1050              MOVE.W  #SIZECLDA, D3
00001714  3801                    1051              MOVE.W  D1,D4         ; Copia D1 para multiplicar por 10
00001716  4241                    1052              CLR.W   D1            ; Inicializa resultado
00001718                          1053  
00001718                          1054  
00001718                          1055  MULTLOOPX: 
00001718  B87C 0000               1056              CMP.W   #0, D4        ; ¿Quedan iteraciones?
0000171C  6700 0008               1057              BEQ     ENDMULTX
00001720  D243                    1058              ADD.W   D3,D1         ; Suma TAMANO_CELDA (10) repetidamente
00001722                          1059  
00001722  5344                    1060              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
00001724  60F2                    1061              BRA     MULTLOOPX     ; Repite mientras no sea 0
00001726                          1062  ENDMULTX: 
00001726  3802                    1063              MOVE.W  D2,D4         ; Copia D2 para multiplicar por 10
00001728  4242                    1064              CLR.W   D2            ; Inicializa resultado
0000172A                          1065  
0000172A                          1066  MULTLOOPY: 
0000172A  B87C 0000               1067              CMP.W   #0, D4        ; ¿Quedan iteraciones?
0000172E  6700 0008               1068              BEQ     ENDMULTY
00001732  D443                    1069              ADD.W   D3,D2         ; Suma TAMANO_CELDA (10) repetidamente
00001734  5344                    1070              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
00001736  60F2                    1071              BRA     MULTLOOPY     ; Repite mientras no sea 0
00001738                          1072  ENDMULTY:
00001738  4C9F 0019               1073              MOVEM.W (A7)+,D0/D3-D4
0000173C                          1074  
0000173C  4E75                    1075              RTS
0000173E                          1076  
0000173E                          1077  ; ----------------------------------------------------------------------------
0000173E                          1078  CHECKCLD
0000173E                          1079  ; INPUT: D0 = índice de la celda
0000173E                          1080  ; OUTPUT: D0 = 0 si está vacía, 1 si está ocupada
0000173E                          1081  ; MODIFIES: Ninguno
0000173E                          1082  ; ----------------------------------------------------------------------------
0000173E                          1083  
0000173E  41F9 000018EC           1084              LEA     ESTDCLDS, A0    ; Carga la dirección de la matriz ESTDCLDS
00001744  1230 0000               1085              MOVE.B  (A0, D0.W),D1   ; Carga el estado de la celda en D1
00001748  B23C 0000               1086              CMP.B   #0, D1          ; Compara si está vacía (0)
0000174C  6700 0008               1087              BEQ     CLDFREE         ; Si está vacía
00001750  303C 0001               1088              MOVE.W  #1, D0          ; Si está ocupada, devuelve 1 (ocupada)
00001754                          1089  
00001754  4E75                    1090              RTS
00001756                          1091  
00001756                          1092  CLDFREE:
00001756  303C 0000               1093              MOVE.W  #0, D0                 ; Devuelve 0 (libre)
0000175A                          1094  
0000175A  4E75                    1095              RTS
0000175C                          1096  
0000175C                          1097  
0000175C                          1098  ;-----------------------------------------------------------------------------
0000175C                          1099  FONPLOT
0000175C                          1100  ; DIBUJADO DEL FONDO
0000175C                          1101  ; INPUT    : NONE
0000175C                          1102  ; OUTPUT   : NONE
0000175C                          1103  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
0000175C                          1104  ; ----------------------------------------------------------------------------
0000175C                          1105  
0000175C  3F00                    1106              MOVE.W  D0,-(A7)
0000175E  3003                    1107              MOVE.W  D3,D0
00001760  4EB8 1702               1108              JSR     CNVICOOR
00001764  2F01                    1109              MOVE.L  D1,-(A7)
00001766                          1110              
00001766  103C 0050               1111              MOVE.B  #80,D0
0000176A  223C 0090EE90           1112              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001770  4E4F                    1113              TRAP    #15
00001772                          1114              
00001772  103C 0051               1115              MOVE.B  #81,D0
00001776  223C 0090EE90           1116              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
0000177C  4E4F                    1117              TRAP    #15
0000177E                          1118              
0000177E  103C 0057               1119              MOVE.B  #87,D0
00001782  221F                    1120              MOVE.L  (A7)+,D1
00001784  3F03                    1121              MOVE.W  D3,-(A7)
00001786  3601                    1122              MOVE.W  D1,D3
00001788  0643 0014               1123              ADD.W   #SIZECLDA,D3
0000178C  3802                    1124              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
0000178E  0644 0014               1125              ADD.W   #SIZECLDA,D4
00001792  4E4F                    1126              TRAP    #15                     
00001794                          1127                          
00001794  361F                    1128              MOVE.W  (A7)+,D3  
00001796  301F                    1129              MOVE.W  (A7)+,D0
00001798  4E75                    1130              RTS         
0000179A                          1131  
0000179A                          1132  
0000179A                          1133  
0000179A                          1134  ;-----------------------------------------------------------------------------
0000179A                          1135  MTZUPD
0000179A                          1136  ; ACTUALIZA LA MATRIZ CASILLA A CASILLA
0000179A                          1137  ; INPUT    : NONE
0000179A                          1138  ; OUTPUT   : NONE
0000179A                          1139  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
0000179A                          1140  ; ----------------------------------------------------------------------------
0000179A                          1141  
0000179A                          1142  
0000179A  48A7 E080               1143              MOVEM.W D0-D2/A0,-(A7)
0000179E                          1144              
0000179E  41F9 000018EC           1145              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
000017A4  303C 0300               1146              MOVE.W #TCELDAS, D0    ; Número total de celdas
000017A8                          1147  
000017A8                          1148  .CLNCLDS:
000017A8  4218                    1149              CLR.B (A0)+            ; Coloca 0 en cada celda
000017AA  5340                    1150              SUBI.W #1, D0          ; Decrementa el contador de celdas
000017AC  66FA                    1151              BNE .CLNCLDS           ; Repite hasta que esten vacías
000017AE                          1152              
000017AE                          1153              
000017AE  3239 000018D6           1154              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
000017B4  3439 000018D8           1155              MOVE.W  CBZPOSY, D2
000017BA  4EB8 1644               1156              JSR     CINDMTRZ
000017BE  4EB8 167E               1157              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
000017C2                          1158              
000017C2  3239 000018E2           1159              MOVE.W  SGMPOSX, D1
000017C8  3439 000018E4           1160              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
000017CE  4EB8 1644               1161              JSR     CINDMTRZ
000017D2  4EB8 16C0               1162              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
000017D6                          1163              
000017D6  3239 000018DE           1164              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
000017DC  3439 000018E0           1165              MOVE.W  COLPOSY, D2
000017E2  4EB8 1644               1166              JSR     CINDMTRZ
000017E6  4EB8 16D6               1167              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
000017EA                          1168              
000017EA  3239 000018D2           1169              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
000017F0  3439 000018D4           1170              MOVE.W  MNZPOSY, D2
000017F6  4EB8 1644               1171              JSR     CINDMTRZ
000017FA  4EB8 16EC               1172              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
000017FE                          1173              
000017FE                          1174              
000017FE  4C9F 0107               1175              MOVEM.W (A7)+,D0-D2/A0
00001802                          1176  
00001802  4E75                    1177              RTS
00001804                          1178  
00001804                          1179  
00001804                          1180  
00001804                          1181  ;-----------------------------------------------------------------------------
00001804                          1182  MTZPLOT
00001804                          1183  ; DIBUJA LA MATRIZ CASILLA A CASILLA
00001804                          1184  ; INPUT    : NONE
00001804                          1185  ; OUTPUT   : NONE
00001804                          1186  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001804                          1187  ; ----------------------------------------------------------------------------
00001804  48E7 F080               1188              MOVEM.L D0-D3/A0,-(A7)
00001808                          1189  
00001808  4240                    1190              CLR.W   D0
0000180A  4243                    1191              CLR.W   D3
0000180C  41F9 000018EC           1192              LEA     ESTDCLDS, A0            ; Apunta al inicio de ESTDCLDS
00001812  303C 0300               1193              MOVE.W  #TCELDAS, D0            ; Número total de celdas
00001816  363C 0000               1194              MOVE.W  #0,D3                   ; LO UTILIZAMOS PARA SABER EL INDICE EN EL QUE NOS ENCONTRAMOS
0000181A  4241                    1195              CLR.W   D1
0000181C  4242                    1196              CLR.W   D2
0000181E                          1197              
0000181E                          1198  
0000181E                          1199  PLOTCLDS:
0000181E  1218                    1200              MOVE.B  (A0)+,D1                ; MOVEMOS EL VALOR DE LA CELDA A D1
00001820  B23C 0000               1201              CMP.B   #0,D1
00001824  6700 0036               1202              BEQ     PLOTVAC                 ; SALTA A DIBUJAR POSICIÓN VACÍA
00001828  B23C 0001               1203              CMP.B   #1,D1 
0000182C  6700 0034               1204              BEQ     PLOTCOL                 ; SALTA A DIBUJAR COLA
00001830  B23C 0002               1205              CMP.B   #2,D1
00001834  6700 0032               1206              BEQ     PLOTSEG                 ; SALTA A DIBUJAR SEGMENTO
00001838  B239 000018E6           1207              CMP.B   TRZPLOT,D1
0000183E  6700 0016               1208              BEQ     PLOTCBZ                 ; SALTA A DIBUJAR CABEZA
00001842  B23C 0004               1209              CMP.B   #4,D1                 
00001846  6700 0026               1210              BEQ     PLOTAPPLE               ; SALTA A DIBUJAR MANZANA
0000184A                          1211    
0000184A                          1212  DONEPLOT            
0000184A  5243                    1213              ADDQ    #1,D3                   ; AUMENTAMOS EL INDICE DE CELDA PARA LA SIGUIENTE
0000184C  5340                    1214              SUBI.W  #1, D0                  ; Decrementa el contador de celdas
0000184E  66CE                    1215              BNE     PLOTCLDS                ; Repite hasta que esten vacías
00001850  4CDF 010F               1216              MOVEM.L (A7)+,D0-D3/A0
00001854  4E75                    1217              RTS
00001856                          1218  PLOTCBZ:
00001856  4EB8 12F4               1219              JSR     HEADPLOT
0000185A  60EE                    1220              BRA     DONEPLOT
0000185C                          1221  
0000185C                          1222  PLOTVAC:    
0000185C  4EB8 175C               1223              JSR     FONPLOT
00001860  60E8                    1224              BRA     DONEPLOT                ; DIBUJADO HECHO 
00001862                          1225  
00001862                          1226  PLOTCOL:   
00001862  4EB8 142C               1227              JSR     TAILPLOT 
00001866  60E2                    1228              BRA     DONEPLOT                ; DIBUJADO HECHO 
00001868                          1229              
00001868                          1230  PLOTSEG:    
00001868  4EB8 13B8               1231              JSR     SEGPLOT
0000186C  60DC                    1232              BRA     DONEPLOT                ; DIBUJADO HECHO    
0000186E                          1233  
0000186E                          1234  PLOTAPPLE:
0000186E  4EB8 14DC               1235              JSR     APPLEPLOT
00001872  60D6                    1236              BRA     DONEPLOT            
00001874                          1237  
00001874                          1238  
00001874                          1239  
00001874                          1240  
00001874                          1241  
00001874                          1242  
00001874                          1243  
00001874                          1244  
00001874                          1245  
00001874                          1246  
00001874                          1247  
00001874                          1248  
00001874                          1249  
00001874                          1250  
00001874                          1251  -------------------- end include --------------------
00001874                          1252  START:
00001874                          1253                  
00001874                          1254  ; --- INIZIALIZACIÓN ---------------------------------------------------------
00001874                          1255  
00001874  4EB8 1000               1256              JSR     SYSINIT
00001878  4EB8 10A6               1257              JSR     UTLINIT
0000187C  4EB8 1066               1258              JSR     KBDINIT
00001880  4EB8 15CA               1259              JSR     MTZINIT
00001884  4EB8 11DA               1260              JSR     HEADINIT                
00001888  4EB8 1378               1261              JSR     SEGINIT
0000188C  4EB8 13F8               1262              JSR     TAILINIT
00001890  4EB8 158C               1263              JSR     SCOINIT
00001894  4EB8 146C               1264              JSR     APPLEINIT
00001898                          1265              
00001898                          1266  
00001898                          1267  .LOOP
00001898                          1268  
00001898                          1269  ; --- ACTUALIZAR -------------------------------------------------------------
00001898                          1270  
00001898                          1271  ; LEER DISPOSITIVOS DE ENTRADA
00001898                          1272  
00001898  4E41                    1273              TRAP    #1
0000189A                          1274  
0000189A                          1275  ; ACTUALIZAR LÓGICA DEL JUEGO
0000189A                          1276              
0000189A  4EB8 140A               1277              JSR     TAILUPD
0000189E  4EB8 138A               1278              JSR     SEGUPD
000018A2  4EB8 1208               1279              JSR     HEADUPD
000018A6                          1280              ;JSR     APPLEUPD  
000018A6  4EB8 179A               1281              JSR     MTZUPD
000018AA                          1282              
000018AA                          1283  ; --- SINCRONIZACIÓN ---------------------------------------------------------
000018AA                          1284              ; THE FOLLOWING SYNC STRATEGY IS ****WRONG****
000018AA  103C 0017               1285              MOVE.B  #23,D0
000018AE  7201                    1286              MOVE.L  #1,D1
000018B0  4E4F                    1287              TRAP    #15
000018B2                          1288  
000018B2                          1289  
000018B2                          1290  ;---DIBUJAR-------------------------------------------------------------------
000018B2  4EB8 12F4               1291               JSR    HEADPLOT
000018B6  4EB8 13B8               1292               JSR    SEGPLOT
000018BA  4EB8 142C               1293               JSR    TAILPLOT
000018BE  4EB8 14DC               1294               JSR    APPLEPLOT
000018C2  4EB8 1804               1295               JSR    MTZPLOT
000018C6  4EB8 1596               1296               JSR    SCOPLOT
000018CA                          1297              
000018CA  4E40                    1298              TRAP    #0                      ; ACTUALIZA DOBLE BUFFER
000018CC                          1299  
000018CC                          1300  
000018CC  60CA                    1301              BRA     .LOOP
000018CE                          1302  
000018CE  FFFF FFFF               1303              SIMHALT
000018D2                          1304              
000018D2                          1305              INCLUDE 'VARS.X68'
000018D2                          1306  ; ----------------------------------------------------------------------------
000018D2                          1307  ; VARIABLES DEL JUEGO
000018D2                          1308  ; ----------------------------------------------------------------------------
000018D2                          1309  
000018D2                          1310  ; --- VARIABLES DE LA MANZANA ------------------------------------------------
000018D2                          1311  
000018D2                          1312  MNZPOSX     DS.W    1                       ; COORDENADA X DE LA MANZANA
000018D4                          1313  MNZPOSY     DS.W    1                       ; COORDENADA Y DE LA MANZANA
000018D6                          1314  
000018D6                          1315  ; --- VARIABLES DE LA SERPIENTE ----------------------------------------------
000018D6                          1316  
000018D6                          1317  CBZPOSX     DS.W    1                       ; COORDENADA X CABEZA
000018D8                          1318  CBZPOSY     DS.W    1                       ; COORDENADA Y CABEZA
000018DA                          1319  CBZVELX     DS.W    1                       ; VELOCIDAD X CABEZA
000018DC                          1320  CBZVELY     DS.W    1                       ; VELOCIDAD Y CABEZA
000018DE                          1321  COLPOSX     DS.W    1                       ; COORDENADA X COLA
000018E0                          1322  COLPOSY     DS.W    1                       ; COORDENADA Y COLA
000018E2                          1323  SGMPOSX     DS.W    1                       ; COORDENADA X SEGMENTO
000018E4                          1324  SGMPOSY     DS.W    1                       ; COORDENADA Y SEGMENTO
000018E6                          1325  TRZPLOT     DS.B    1                       ; NÚMERO DE TROZOS A DIBUJAR
000018E7                          1326  
000018E7                          1327  ; --- VARIABLES DEL MARCADOR -------------------------------------------------
000018E7                          1328  
000018E8                          1329  JGOPNTS     DS.W    1                       ; PUNTUACIÓN DEL JUEGO
000018EA                          1330  
000018EA                          1331  
000018EA                          1332  
000018EA                          1333  
000018EA                          1334  -------------------- end include --------------------
000018EA                          1335              INCLUDE 'LIB/UTLVARS.X68'
000018EA                          1336  ; =============================================================================
000018EA                          1337  ; UTILITY VARIABLES
000018EA                          1338  ; =============================================================================
000018EA                          1339  
000018EA                          1340  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000018EC                          1341              DS.W    0
000018EC                          1342  -------------------- end include --------------------
000018EC                          1343              INCLUDE 'SYSVARS.X68'
000018EC                          1344  ; ----------------------------------------------------------------------------
000018EC                          1345  ; VARIABLES DEL SISTEMA
000018EC                          1346  ; ----------------------------------------------------------------------------
000018EC                          1347  
000018EC                          1348  ; --- VARIABLES DE LA MATRIZ -------------------------------------------------
000018EC                          1349  
000018EC                          1350  ESTDCLDS    DS.B    TCELDAS                 ; ESTADO DE LAS CELDAS 0=VACÍO  1=COLA   2=SEGMENTO  TRZPLOT=CABEZA  4?=MANZANA    
00001BEC                          1351  ESTDCBZ     DS.B    1                       ; 0= DERECHA, 1=ARRIBA, 2=IZQUIERDA, 3=ABAJO
00001BED                          1352  
00001BED                          1353  ; --- VARIABLES DE TECLADO ---------------------------------------------------
00001BED                          1354  
00001BED                          1355  KBDVAL      DS.B    1
00001BEE                          1356  KBDEDGE     DS.B    1                       ; KEY EDGE
00001BF0                          1357  LASTKEY     DS.L    1                       
00001BF4                          1358  
00001BF4                          1359  
00001BF4                          1360  
00001BF4                          1361  
00001BF4                          1362  
00001BF4                          1363  
00001BF4                          1364  
00001BF4                          1365  
00001BF4                          1366  
00001BF4                          1367  
00001BF4                          1368  
00001BF4                          1369  
00001BF4                          1370  
00001BF4                          1371  
00001BF4                          1372  
00001BF4                          1373  
00001BF4                          1374  -------------------- end include --------------------
00001BF4                          1375      
00001BF4                          1376      
00001BF4                          1377              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
APPLEINIT           146C
APPLEPLOT           14DC
APPLEUPD            149E
CBZFCOL             AA00
CBZHEIGH            14
CBZOCPD             167E
CBZPCOL             FF00
CBZPOSX             18D6
CBZPOSY             18D8
CBZVEL              14
CBZVELX             18DA
CBZVELY             18DC
CBZWIDTH            14
CHCKUPDT            14B6
CHECK               1478
CHECKCLD            173E
CINDMTRZ            1644
CLDFREE             1756
CLNCLDS             15D8
CNVICOOR            1702
COLFCOL             AA00
COLFND              90EE90
COLHEIGH            A
COLOCPD             16D6
COLPCOL             FF00
COLPOSX             18DE
COLPOSY             18E0
COLWIDTH            A
DIVX                164C
DIVY                1660
DONEPLOT            184A
ENDDIVX             165C
ENDDIVY             1670
ENDMULTX            1726
ENDMULTY            1738
ESTDCBZ             1BEC
ESTDCLDS            18EC
FIN                 12EE
FONPLOT             175C
GENPOSMNZ           155A
HEADINIT            11DA
HEADPLOT            12F4
HEADUPD             1208
JGOPNTS             18E8
KBDDOWN             28
KBDEDGE             1BEE
KBDINIT             1066
KBDLEFT             25
KBDRIGHT            27
KBDUP               26
KBDUPD              106E
KBDUPD:LOOP         1082
KBDVAL              1BED
LASTKEY             1BF0
LNGINI              1
MARKMNZ             1490
MAXSGM              1
MCLDVCIA            16AA
MNZFCOL             FF
MNZHEIGH            14
MNZOCPD             16EC
MNZPCOL             AAFF
MNZPOSX             18D2
MNZPOSY             18D4
MNZWIDTH            14
MTZINIT             15CA
MTZPLOT             1804
MTZUPD              179A
MTZUPD:CLNCLDS      17A8
MULTLOOPX           1718
MULTLOOPY           172A
NEWMNZ              14CE
NUMCLMNS            20
NUMFILAS            18
OJOFCOL             FFFFFF
OJOHEIGH            A
OJOPCOL             0
OJOWIDTH            A
PANHEIGH            1E0
PANWIDTH            280
PLOTAPPLE           186E
PLOTCBZ             1856
PLOTCLDS            181E
PLOTCOL             1862
PLOTSEG             1868
PLOTVAC             185C
PNTSFCOL            0
PNTSTEXT            65
RSTCLD              1696
SCOINIT             158C
SCOPLOT             1596
SCOPLOT:TXT1        15C0
SCOUPD              1594
SCRINIT             101E
SCRPLOT             104C
SEGINIT             1378
SEGPLOT             13B8
SEGUPD              138A
SGMFCOL             AA00
SGMHEIGH            14
SGMOCPD             16C0
SGMPCOL             FF00
SGMPOSX             18E2
SGMPOSY             18E4
SGMWIDTH            14
SIGABA              12CA
SIGARR              1282
SIGDER              125E
SIGIZQ              12A6
SIZECLDA            14
START               1874
START:LOOP          1898
SYSINIT             1000
TAILINIT            13F8
TAILPLOT            142C
TAILUPD             140A
TCELDAS             300
TRZPLOT             18E6
UTLINIT             10A6
UTLRAND             10BC
UTLRAND:RANDVEC     10DA
UTLRNDIX            18EA
