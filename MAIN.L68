0000190A Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 27/12/2024 10:04:25

00000000                             1  *-----------------------------------------------------------------------------
00000000                             2  * Title      : MAIN
00000000                             3  * Written by :
00000000                             4  * Date       :
00000000                             5  * Description:
00000000                             6  *-----------------------------------------------------------------------------
00000000                             7  
00001000                             8              ORG    $1000
00001000                             9              
00001000                            10              INCLUDE 'CONST.X68'
00001000                            11  ; ----------------------------------------------------------------------------
00001000                            12  ; CONSTANTES DEL JUEGO
00001000                            13  ; ----------------------------------------------------------------------------
00001000                            14     
00001000                            15  ; --- CONSTANTES DE LA MANZANA -----------------------------------------------
00001000                            16  
00001000  =00000014                 17  MNZWIDTH    EQU     20                      ; ANCHURA DE LA MANZANA (a determinar)
00001000  =00000014                 18  MNZHEIGH    EQU     20                      ; ALTURA DE LA MANZANA (a determinar)
00001000  =0000AAFF                 19  MNZPCOL     EQU     $0000AAFF               ; COLOR CONTORNO MANZANA (a determinar)
00001000  =000000FF                 20  MNZFCOL     EQU     $000000FF               ; COLOR RELLENO MANZANA (a determinar)
00001000                            21  
00001000                            22  ; --- CONSTANTES DE LA SERPIENTE ---------------------------------------------
00001000                            23  
00001000  =00000001                 24  MAXSGM      EQU     1                       ; TAMAÑO MÁXIMO DE SEGMENTOS (a determinar)
00001000  =00000001                 25  LNGINI      EQU     1                       ; LONGITUD INICIAL SERPIENTE (a determinar)
00001000  =00000014                 26  SGMWIDTH    EQU     20                      ; ANCHURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 27  SGMHEIGH    EQU     20                      ; ALTURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 28  CBZVEL      EQU     20                      ; VELOCIDAD DE LA CABEZA (a determinar)
00001000  =0000FF00                 29  SGMPCOL     EQU     $0000FF00               ; COLOR CONTORNO SEGMENTO (PROVISIONAL)
00001000  =0000AA00                 30  SGMFCOL     EQU     $0000AA00               ; COLOR RELLENO SEGMENTO (PROVISIONAL)
00001000  =0000000A                 31  COLWIDTH    EQU     10                      ; ANCHURA DE LA COLA (PROVISIONAL)
00001000  =0000000A                 32  COLHEIGH    EQU     10                      ; ALTURA DE LA COLA (PROVISIONAL)
00001000  =0000FF00                 33  COLPCOL     EQU     $0000FF00               ; COLOR CONTORNO COLA (PROVISIONAL)
00001000  =0000AA00                 34  COLFCOL     EQU     $0000AA00               ; COLOR RELLENO COLA (PROVISIONAL)
00001000  =00000014                 35  CBZWIDTH    EQU     20                      ; ANCHURA DE LA CABEZA (PROVISIONAL)
00001000  =00000014                 36  CBZHEIGH    EQU     20                      ; ALTURA DE LA CABEZA (PROVISIONAL)
00001000  =0000FF00                 37  CBZPCOL     EQU     $0000FF00               ; COLOR CONTORNO CABEZA (PROVISIONAL)
00001000  =0000AA00                 38  CBZFCOL     EQU     $0000AA00               ; COLOR RELLENO CABEZA (PROVISIONAL)
00001000  =0000000A                 39  OJOWIDTH    EQU     10                      ; ANCHURA DE OJO DE SERPIENTE
00001000  =0000000A                 40  OJOHEIGH    EQU     10                      ; ALTURA DE OJO DE SERPIENTE
00001000  =00000000                 41  OJOPCOL     EQU     $00000000               ; COLOR CONTORNO OJO
00001000  =00FFFFFF                 42  OJOFCOL     EQU     $00FFFFFF               ; COLOR RELLENO OJO
00001000                            43  
00001000                            44  
00001000                            45  
00001000                            46  ; --- CONSTANTES MARCADOR ----------------------------------------------------
00001000                            47  
00001000  =00000000                 48  PNTSFCOL    EQU     $00000000               ; COLOR FONDO MARCADOR (a determinar)
00001000  =00000065                 49  PNTSTEXT    EQU     0101                    ; COORDENADAS DEL MARCADOR (a determinar)
00001000                            50  
00001000                            51  
00001000                            52  
00001000                            53  
00001000                            54  
00001000                            55  
00001000                            56  
00001000                            57  -------------------- end include --------------------
00001000                            58              INCLUDE 'SYSCONST.X68'
00001000                            59  ; ----------------------------------------------------------------------------
00001000                            60  ; CONSTANTES DEL SISTEMA
00001000                            61  ; ----------------------------------------------------------------------------
00001000                            62  
00001000                            63  ; ---CONSTANTES DE LA PANTALLA------------------------------------------------
00001000                            64  
00001000  =00000280                 65  PANWIDTH    EQU     640                     ; ANCHO DE LA PANTALLA
00001000  =000001E0                 66  PANHEIGH    EQU     480                     ; ALTURA DE LA PANTALLA
00001000  =0090EE90                 67  COLFND      EQU     $90EE90                 ; COLOR DEL FONDO DE LA PANTALLA
00001000                            68  
00001000                            69  ; ---CONSTANTES DE LA MATRIZ--------------------------------------------------
00001000                            70  
00001000  =00000014                 71  SIZECLDA    EQU     20                      ; TAMAÑO DE CADA CELDA EN PIXELES
00001000  =00000020                 72  NUMCLMNS    EQU     32                      ; COLUMNAS DE CELDAS (640/10)
00001000  =00000018                 73  NUMFILAS    EQU     24                      ; FILAS DE CELDAS (480/10)
00001000  =00000300                 74  TCELDAS     EQU     768                     ; TOTAL DE CELDAS (64 * 48)
00001000                            75  
00001000                            76  ; ---CÓDIGOS DE TECLADO-------------------------------------------------------
00001000                            77  
00001000  =00000025                 78  KBDLEFT     EQU     $25
00001000  =00000026                 79  KBDUP       EQU     $26
00001000  =00000027                 80  KBDRIGHT    EQU     $27
00001000  =00000028                 81  KBDDOWN     EQU     $28
00001000                            82  
00001000                            83  
00001000                            84  -------------------- end include --------------------
00001000                            85              INCLUDE 'SYSTEM.X68'
00001000                            86   
00001000                            87   
00001000                            88  SYSINIT
00001000                            89  ; INICIA EL  SISTEMA
00001000                            90  ; INPUT    : NONE
00001000                            91  ; OUTPUT   : NONE
00001000                            92  ; MODIFIES : NONE
00001000                            93  ; ----------------------------------------------------------------------------
00001000                            94              
00001000  21FC 00001072 0080        95              MOVE.L  #SCRPLOT,($80)
00001008  21FC 0000109A 0084        96              MOVE.L  #KBDUPD,($84)
00001010  21FC 0000106A 0064        97              MOVE.L  #SCRTIM,($64)
00001018                            98              
00001018  4EB9 00001026             99              JSR     SCRINIT
0000101E  40E7                     100              MOVE.W  SR,-(A7)
00001020  0257 D8FF                101              ANDI.W  #$D8FF,(A7)
00001024                           102              
00001024  4E73                     103              RTE
00001026                           104              
00001026                           105  ; ------------------------------------------------------------------------------
00001026                           106  SCRINIT
00001026                           107  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001026                           108  ; ENABLE DOUBLE BUFFER, ENABLED TIMED INTERRUPT.
00001026                           109  ; INPUT    : NONE
00001026                           110  ; OUTPUT   : NONE
00001026                           111  ; MODIFIES : NONE
00001026                           112  ; ------------------------------------------------------------------------------
00001026                           113  
00001026  48E7 C000                114              MOVEM.L D0-D1,-(A7)
0000102A                           115  
0000102A                           116              ; SET SCREEN RESOLUTION
0000102A  103C 0021                117              MOVE.B  #33,D0
0000102E  223C 028001E0            118              MOVE.L  #PANWIDTH<<16|PANHEIGH,D1
00001034  4E4F                     119              TRAP    #15
00001036                           120              
00001036                           121              ; SET WINDOWED MODE
00001036  7201                     122              MOVE.L  #1,D1
00001038  4E4F                     123              TRAP    #15
0000103A                           124              
0000103A                           125              ; CLEAR SCREEN
0000103A  103C 000B                126              MOVE.B  #11,D0
0000103E  323C FF00                127              MOVE.W  #$FF00,D1
00001042  4E4F                     128              TRAP    #15
00001044                           129              
00001044                           130              ; ENABLE DOUBLE BUFFER
00001044  103C 005C                131              MOVE.B  #92,D0
00001048  123C 0011                132              MOVE.B  #17,D1
0000104C  4E4F                     133              TRAP    #15
0000104E                           134              
0000104E                           135              ; ENABLE TIMED INTERRUPT
0000104E  103C 0020                136              MOVE.B  #32,D0
00001052  123C 0006                137              MOVE.B  #6,D1
00001056  143C 0081                138              MOVE.B  #$81,D2
0000105A  760A                     139              MOVE.L  #10,D3                  ; CON 20 SE CONSIUGUEN 50 FPS
0000105C  4E4F                     140              TRAP    #15
0000105E                           141              
0000105E                           142              ; CLEAR INTERRUPT COUNTER
0000105E  4239 00001C94            143              CLR.B   (SCRINTCT)
00001064                           144              
00001064  4CDF 0003                145              MOVEM.L (A7)+,D0-D1
00001068                           146              
00001068  4E75                     147              RTS    
0000106A                           148              
0000106A                           149  ; ------------------------------------------------------------------------------
0000106A                           150  SCRTIM
0000106A                           151  ; TIMED INTERRUPT SERVICE ROUTINE
0000106A                           152  ; INPUT    : NONE
0000106A                           153  ; OUTPUT   : NONE
0000106A                           154  ; MODIFIES : NONE
0000106A                           155  ; ------------------------------------------------------------------------------
0000106A  5239 00001C94            156              ADDQ.B  #1,(SCRINTCT)
00001070  4E73                     157              RTE
00001072                           158              
00001072                           159  
00001072                           160  ; ------------------------------------------------------------------------------
00001072                           161  SCRPLOT
00001072                           162  ; UPDATES DOUBLE BUFFER
00001072                           163  ; INPUT    : NONE
00001072                           164  ; OUTPUT   : NONE
00001072                           165  ; MODIFIES : NONE
00001072                           166  ; ------------------------------------------------------------------------------
00001072                           167  
00001072  48A7 C000                168              MOVEM.W D0-D1,-(A7)
00001076                           169              
00001076                           170              ; SWITCH BUFFERS
00001076  103C 005E                171              MOVE.B  #94,D0
0000107A  4E4F                     172              TRAP    #15
0000107C                           173              
0000107C                           174              ; CLEAR HIDDEN BUFFER
0000107C  103C 000B                175              MOVE.B  #11,D0
00001080  323C FF00                176              MOVE.W  #$FF00,D1
00001084  4E4F                     177              TRAP    #15
00001086                           178              
00001086  4C9F 0003                179              MOVEM.W (A7)+,D0-D1
0000108A                           180              
0000108A  4E73                     181              RTE
0000108C                           182          
0000108C                           183  ; ------------------------------------------------------------------------------
0000108C                           184  KBDINIT
0000108C                           185  ; INIT KEYBOARD
0000108C                           186  ; INPUT    : NONE
0000108C                           187  ; OUTPUT   : NONE
0000108C                           188  ; MODIFIES : NONE
0000108C                           189  ; ------------------------------------------------------------------------------
0000108C                           190  
0000108C  4239 00001C8D            191              CLR.B   (KBDVAL)
00001092  4239 00001C8E            192              CLR.B   (KBDEDGE)
00001098  4E75                     193              RTS
0000109A                           194  
0000109A                           195  ; ------------------------------------------------------------------------------
0000109A                           196  KBDUPD
0000109A                           197  ; UPDATE KEYBOARD INFO.  
0000109A                           198  ; 7 -> PAUSE
0000109A                           199  ; 6 -> FIRE 3
0000109A                           200  ; 5 -> FIRE 2
0000109A                           201  ; 4 -> FIRE 1
0000109A                           202  ; 3 -> DOWN
0000109A                           203  ; 2 -> RIGHT
0000109A                           204  ; 1 -> UP
0000109A                           205  ; 0 -> LEFT
0000109A                           206  ; INPUT    : NONE
0000109A                           207  ; OUTPUT   : NONE
0000109A                           208  ; MODIFIES : NONE
0000109A                           209  ; ------------------------------------------------------------------------------
0000109A                           210  
0000109A  48E7 C000                211              MOVEM.L D0-D1,-(A7)
0000109E                           212  
0000109E                           213              ; LEE ESTADO DEL TECLADO
0000109E  103C 0013                214              MOVE.B  #19,D0
000010A2  223C 25262728            215              MOVE.L  #KBDLEFT<<24|KBDUP<<16|KBDRIGHT<<8|KBDDOWN,D1
000010A8  4E4F                     216              TRAP    #15                  ; Lee las teclas y guarda en D1
000010AA                           217  
000010AA  B2BC 000000FF            218              CMP.L   #$000000FF,D1
000010B0  6700 0048                219              BEQ     DWN
000010B4  B2BC 0000FF00            220              CMP.L   #$0000FF00,D1
000010BA  6700 001A                221              BEQ     DER
000010BE  B2BC 00FF0000            222              CMP.L   #$00FF0000,D1
000010C4  6700 001C                223              BEQ     ARR
000010C8  B2BC FF000000            224              CMP.L   #$FF000000,D1
000010CE  6700 001E                225              BEQ     IZQ
000010D2                           226  
000010D2                           227              ; Si no hay pulsaciones, mantener estado
000010D2  6000 002E                228              BRA     CONTINU
000010D6                           229  
000010D6  33FC 0000 00001C8C       230  DER:        MOVE.W  #0,(ESTDCBZ)           ; Actualiza estado a DERECHA
000010DE  6000 0022                231              BRA     CONTINU
000010E2                           232              
000010E2  33FC 0001 00001C8C       233  ARR:        MOVE.W  #1,(ESTDCBZ)           ; Actualiza estado a ARRIBA
000010EA  6000 0016                234              BRA     CONTINU
000010EE                           235  
000010EE  33FC 0002 00001C8C       236  IZQ:        MOVE.W  #2,(ESTDCBZ)           ; Actualiza estado a IZQUIERDA
000010F6  6000 000A                237              BRA     CONTINU                    
000010FA                           238  
000010FA  33FC 0003 00001C8C       239  DWN:        MOVE.W  #3,(ESTDCBZ)           ; Actualiza estado a ABAJO
00001102                           240  
00001102                           241  CONTINU:
00001102  4CDF 0003                242              MOVEM.L (A7)+,D0-D1
00001106  4E73                     243              RTE
00001108                           244              
00001108                           245  ; RESIDUOS CODIGO ANTERIOR 
00001108                           246  
00001108                           247              ;MOVE.B  D2,(KBDVAL)
00001108                           248              
00001108                           249  
00001108                           250  
00001108                           251  
00001108                           252  
00001108                           253  ; CODIGO ANTERIOR ANTERIOR
00001108                           254  
00001108                           255  
00001108                           256  
00001108                           257  
00001108                           258  
00001108                           259  
00001108                           260  
00001108                           261  
00001108                           262  
00001108                           263  
00001108                           264  
00001108                           265  
00001108                           266  
00001108                           267  
00001108                           268  
00001108                           269  
00001108                           270  
00001108                           271  
00001108                           272  
00001108                           273  
00001108                           274  
00001108                           275  
00001108                           276  
00001108                           277  
00001108                           278  
00001108                           279  
00001108                           280  
00001108                           281  
00001108                           282  
00001108                           283  
00001108                           284  
00001108                           285  
00001108                           286  
00001108                           287  
00001108                           288  
00001108                           289  
00001108                           290  
00001108                           291  
00001108                           292  
00001108                           293  -------------------- end include --------------------
00001108                           294              INCLUDE 'LIB/UTLCODE.X68'
00001108                           295  ; =============================================================================
00001108                           296  ; UTILITY CODE
00001108                           297  ; =============================================================================
00001108                           298  
00001108                           299  ; -----------------------------------------------------------------------------
00001108                           300  UTLINIT
00001108                           301  ; INITIALIZES UTILITY CODE
00001108                           302  ; INPUT    - NONE
00001108                           303  ; OUTPUT   - NONE
00001108                           304  ; MODIFIES - NONE
00001108                           305  ; -----------------------------------------------------------------------------
00001108  48E7 C000                306              MOVEM.L D0-D1,-(A7)
0000110C  103C 0008                307              MOVE.B  #8,D0
00001110  4E4F                     308              TRAP    #15
00001112  13C1 0000198A            309              MOVE.B  D1,(UTLRNDIX)
00001118  4CDF 0003                310              MOVEM.L (A7)+,D0-D1
0000111C  4E75                     311              RTS
0000111E                           312  
0000111E                           313  ; -----------------------------------------------------------------------------
0000111E                           314  UTLRAND
0000111E                           315  ; PROVIDES A PSEUDO-RANDOM BYTE
0000111E                           316  ; INPUT    - NONE
0000111E                           317  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
0000111E                           318  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000111E                           319  ; -----------------------------------------------------------------------------
0000111E  2F08                     320              MOVE.L  A0,-(A7)
00001120  41F9 0000113C            321              LEA     .RANDVEC,A0
00001126  4280                     322              CLR.L   D0
00001128  1039 0000198A            323              MOVE.B  (UTLRNDIX),D0
0000112E  1030 0800                324              MOVE.B  (A0,D0.L),D0
00001132  5239 0000198A            325              ADDQ.B  #1,(UTLRNDIX)
00001138  205F                     326              MOVE.L  (A7)+,A0
0000113A  4E75                     327              RTS
0000113C                           328  
0000113C                           329  
0000113C= A2 EE 9A 0C F5 24 ...    330  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001144= 2A A3 51 26 E0 AC ...    331              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
0000114C= 75 51 CA FD 33 EB ...    332              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001154= 60 CC E7 B8 9A EB ...    333              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
0000115C= 1D 76 B5 95 B0 89 ...    334              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001164= 39 15 48 C9 6E CA ...    335              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
0000116C= 43 E7 E2 7C 37 25 ...    336              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001174= E9 94 CE E9 E4 52 ...    337              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
0000117C= 37 6D 9A 84 A2 28 ...    338              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001184= 19 E2 C6 77 80 D4 ...    339              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
0000118C= 0A 5A 32 67 33 C2 ...    340              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001194= 59 80 DC 0E 57 FC ...    341              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
0000119C= 8A AB BC F7 07 4D ...    342              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000011A4= EF D5 77 6E 1E BB ...    343              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000011AC= D6 E0 2A 8F BD 28 ...    344              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000011B4= 13 4F 66 EC 0A 64 ...    345              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000011BC= 56 52 9A 16 9B 90 ...    346              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
000011C4= 06 8A A4 F7 01 DA ...    347              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000011CC= F2 E7 77 28 B1 76 ...    348              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
000011D4= A4 42 E3 81 B1 67 ...    349              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000011DC= BF CE FA 16 BF 38 ...    350              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000011E4= D1 8B 50 0C 5F 49 ...    351              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
000011EC= DE 4C 14 A2 40 DC ...    352              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
000011F4= B6 9B 0A 38 5D AB ...    353              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
000011FC= E2 1B DD 75 15 82 ...    354              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001204= 8A 26 51 30 9F 47 ...    355              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
0000120C= 1E 8A BB 71 C6 6E ...    356              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001214= 9F 47 E5 34 94 27 ...    357              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
0000121C= 7D 06 D6 BA 30 0F ...    358              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001224= EC 7F 7E 03 CF 2D ...    359              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
0000122C= 94 5B 23 F2 8B CD ...    360              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001234= 74 33 EC B9 0F D5 ...    361              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001234= 74 33 EC B9 0F D5 ...    362  -------------------- end include --------------------
0000123C                           363              INCLUDE 'HEADSRP.X68'
0000123C                           364  
0000123C                           365  ; ------------------------------------------------------------------------------
0000123C                           366  HEADINIT
0000123C                           367  ; INICIALIZAR CABEZA.
0000123C                           368  ; INPUT    : NONE 
0000123C                           369  ; OUTPUT   : NONE
0000123C                           370  ; MODIFIES : NONE
0000123C                           371  ; ------------------------------------------------------------------------------
0000123C  33FC 0140 00001976       372              MOVE.W  #PANWIDTH/2,(CBZPOSX)
00001244  33FC 00F0 00001978       373              MOVE.W  #PANHEIGH/2,(CBZPOSY)
0000124C  4279 00001986            374              CLR     (TRZPLOT)
00001252  13FC 0003 00001986       375              MOVE.B  #3,(TRZPLOT)
0000125A  4279 00001C8C            376              CLR.W   (ESTDCBZ)
00001260  33FC 0000 00001C8C       377              MOVE.W  #0,(ESTDCBZ)
00001268  4E75                     378              RTS
0000126A                           379              
0000126A                           380  ; ------------------------------------------------------------------------------
0000126A                           381  HEADUPD
0000126A                           382  ; ACTUALIZAR CABEZA.
0000126A                           383  ; INPUT    : NONE 
0000126A                           384  ; OUTPUT   : NONE
0000126A                           385  ; MODIFIES : NONE
0000126A                           386  ; ------------------------------------------------------------------------------
0000126A                           387  
0000126A  48A7 E000                388              MOVEM.W D0-D2,-(A7)            ; Guardar registros
0000126E                           389  
0000126E                           390  
0000126E                           391              ; Marcar celda actual como vacía
0000126E  3239 00001976            392              MOVE.W  (CBZPOSX),D1
00001274  3439 00001978            393              MOVE.W  (CBZPOSY),D2
0000127A  4EB9 000016DA            394              JSR     CINDMTRZ
00001280  4EB9 00001740            395              JSR     MCLDVCIA               ; RESTAMOS 1 A LA CELDA ACTUAL
00001286                           396              
00001286                           397              
00001286                           398              ; Actualiza la posición de la cabeza según ESTDCBZ
00001286                           399              ;CLR.W   D0
00001286  3039 00001C8C            400              MOVE.W  (ESTDCBZ),D0
0000128C  B07C 0000                401              CMP.W   #0,D0
00001290  6700 001E                402              BEQ     SIGDER
00001294  B07C 0001                403              CMP.W   #1,D0
00001298  6700 0022                404              BEQ     SIGARR
0000129C  B07C 0002                405              CMP.W   #2,D0
000012A0  6700 0026                406              BEQ     SIGIZQ
000012A4  B07C 0003                407              CMP.W   #3,D0
000012A8  6700 002A                408              BEQ     SIGABA
000012AC                           409  
000012AC                           410  
000012AC                           411  
000012AC                           412              ; Si no hay dirección válida, sale
000012AC  6000 0072                413              BRA     FIN
000012B0                           414  
000012B0                           415  SIGDER:
000012B0  0679 0014 00001976       416              ADD.W   #CBZVEL,(CBZPOSX)
000012B8  6000 0022                417              BRA     CHKCOL
000012BC                           418  
000012BC                           419  SIGARR:
000012BC  0479 0014 00001978       420              SUB.W   #CBZVEL,(CBZPOSY)
000012C4  6000 0016                421              BRA     CHKCOL
000012C8                           422  
000012C8                           423  SIGIZQ:
000012C8  0479 0014 00001976       424              SUB.W   #CBZVEL,(CBZPOSX)
000012D0  6000 000A                425              BRA     CHKCOL
000012D4                           426  
000012D4                           427  SIGABA:
000012D4  0679 0014 00001978       428              ADD.W   #CBZVEL,(CBZPOSY)
000012DC                           429              
000012DC                           430  CHKCOL:
000012DC                           431              ; Verifica la colisión con la manzana
000012DC  3239 00001976            432              MOVE.W  (CBZPOSX),D1
000012E2  3439 00001978            433              MOVE.W  (CBZPOSY),D2
000012E8  B279 00001972            434              CMP.W   (MNZPOSX),D1
000012EE  6600 0018                435              BNE     NOCOL
000012F2  B479 00001974            436              CMP.W   (MNZPOSY),D2
000012F8  6600 000E                437              BNE     NOCOL
000012FC                           438              
000012FC                           439              ; Colisión detectada
000012FC  4EB9 0000151C            440              JSR     APPLEUPD
00001302  4EB9 00001612            441              JSR     SCOUPD
00001308                           442              ;JSR     SEGADD
00001308                           443              
00001308                           444  
00001308                           445  NOCOL:
00001308                           446              ; Convierte la posición nueva a índice
00001308  3239 00001976            447              MOVE.W  (CBZPOSX),D1
0000130E  3439 00001978            448              MOVE.W  (CBZPOSY),D2
00001314  4EB9 000016DA            449              JSR     CINDMTRZ
0000131A  4EB9 00001714            450              JSR     CBZOCPD                 ; Marca la celda como ocupada
00001320                           451  
00001320                           452  
00001320                           453  FIN:
00001320  4C9F 0007                454              MOVEM.W (A7)+,D0-D2
00001324                           455  
00001324  4E75                     456              RTS
00001326                           457              
00001326                           458  ; ------------------------------------------------------------------------------
00001326                           459  HEADPLOT
00001326                           460  ; DIBUJAR CABEZA.
00001326                           461  ; INPUT    : NONE 
00001326                           462  ; OUTPUT   : NONE
00001326                           463  ; MODIFIES : NONE
00001326                           464  ; ------------------------------------------------------------------------------
00001326                           465                         
00001326  3F00                     466              MOVE.W  D0,-(A7)               ; GUARDAMOS D0
00001328  3003                     467              MOVE.W  D3,D0                  ; PONEMOS EL INDICE DE LA CELDA EN D0 PARA CALCULAR SUS COORDENADAS
0000132A  4EB9 00001798            468              JSR     CNVICOOR
00001330  2F01                     469              MOVE.L  D1,-(A7)
00001332                           470              
00001332                           471              ; SET COLOR DEL CONTORNO CABEZA
00001332  103C 0050                472              MOVE.B  #80,D0
00001336  223C 0000FF00            473              MOVE.L  #CBZPCOL,D1
0000133C  4E4F                     474              TRAP    #15
0000133E                           475              
0000133E                           476              ; SET COLOR DEL RELLENO CABEZA
0000133E  103C 0051                477              MOVE.B  #81,D0
00001342  223C 0000AA00            478              MOVE.L  #CBZFCOL,D1
00001348  4E4F                     479              TRAP    #15
0000134A                           480              
0000134A                           481              ; DIBUJAR CABEZA
0000134A  103C 0057                482              MOVE.B  #87,D0
0000134E  221F                     483              MOVE.L  (A7)+,D1
00001350  3F03                     484              MOVE.W  D3,-(A7)
00001352  3601                     485              MOVE.W  D1,D3
00001354  0643 0014                486              ADD.W   #CBZWIDTH,D3
00001358  3802                     487              MOVE.W  D2,D4
0000135A  0644 0014                488              ADD.W   #CBZHEIGH,D4
0000135E  4E4F                     489              TRAP    #15
00001360                           490              
00001360  2F01                     491              MOVE.L  D1,-(A7)
00001362                           492              
00001362                           493              ; SET COLOR DEL CONTORNO OJO
00001362  103C 0050                494              MOVE.B  #80,D0
00001366  7200                     495              MOVE.L  #OJOPCOL,D1
00001368  4E4F                     496              TRAP    #15
0000136A                           497              
0000136A                           498              ; SET COLOR DEL RELLENO OJO
0000136A  103C 0051                499              MOVE.B  #81,D0
0000136E  223C 00FFFFFF            500              MOVE.L  #OJOFCOL,D1
00001374  4E4F                     501              TRAP    #15
00001376                           502              
00001376                           503              ; DIBUJAR OJO
00001376  103C 0058                504              MOVE.B  #88,D0
0000137A  221F                     505              MOVE.L  (A7)+,D1
0000137C  2F01                     506              MOVE.L  D1,-(A7)
0000137E  2F02                     507              MOVE.L  D2,-(A7)
00001380  5A41                     508              ADD.W   #OJOWIDTH/2,D1            
00001382  3601                     509              MOVE.W  D1,D3
00001384  0643 000A                510              ADD.W   #OJOWIDTH,D3
00001388  5A42                     511              ADD.W   #OJOHEIGH/2,D2
0000138A  3802                     512              MOVE.W  D2,D4
0000138C  0644 000A                513              ADD.W   #OJOHEIGH,D4
00001390  4E4F                     514              TRAP    #15                     ; DIBUJAMOS EL PRIMER OJO
00001392                           515              
00001392                           516  
00001392                           517              ; DEFINIR COORDENADAS IRIS
00001392  241F                     518              MOVE.L  (A7)+,D2
00001394  221F                     519              MOVE.L  (A7)+,D1
00001396  0641 000A                520              ADD.W   #OJOWIDTH,D1
0000139A  0642 000A                521              ADD.W   #OJOHEIGH,D2
0000139E  103C 0052                522              MOVE.B  #82,D0
000013A2  4E4F                     523              TRAP    #15                     ; DIBUJAMOS EL PRIMER IRIS
000013A4                           524              
000013A4  361F                     525              MOVE.W  (A7)+,D3
000013A6  301F                     526              MOVE.W  (A7)+,D0
000013A8                           527  
000013A8  4E75                     528              RTS
000013AA                           529  
000013AA                           530  
000013AA                           531  
000013AA                           532  
000013AA                           533  
000013AA                           534  
000013AA                           535  
000013AA                           536  
000013AA                           537  
000013AA                           538  
000013AA                           539  
000013AA                           540  
000013AA                           541  
000013AA                           542  
000013AA                           543  
000013AA                           544  
000013AA                           545  
000013AA                           546  
000013AA                           547  
000013AA                           548  
000013AA                           549  
000013AA                           550  
000013AA                           551  
000013AA                           552  
000013AA                           553  
000013AA                           554  
000013AA                           555  
000013AA                           556  
000013AA                           557  
000013AA                           558  
000013AA                           559  
000013AA                           560  -------------------- end include --------------------
000013AA                           561              INCLUDE 'SEGSRP.X68'
000013AA                           562  
000013AA                           563  ; ------------------------------------------------------------------------------
000013AA                           564  SEGINIT
000013AA                           565  ; INICIALIZAR SEGMENTO.
000013AA                           566  ; INPUT    : NONE 
000013AA                           567  ; OUTPUT   : NONE
000013AA                           568  ; MODIFIES : NONE
000013AA                           569  ; ------------------------------------------------------------------------------
000013AA  33FC 012C 00001982       570              MOVE.W  #(PANWIDTH/2)-CBZWIDTH,(SGMPOSX)
000013B2  33FC 00F0 00001984       571              MOVE.W  #PANHEIGH/2,(SGMPOSY)
000013BA  4E75                     572              RTS
000013BC                           573              
000013BC                           574  ; ------------------------------------------------------------------------------
000013BC                           575  SEGUPD
000013BC                           576  ; ACTUALIZAR SEGMENTO.
000013BC                           577  ; INPUT    : NONE 
000013BC                           578  ; OUTPUT   : NONE
000013BC                           579  ; MODIFIES : NONE
000013BC                           580  ; ------------------------------------------------------------------------------
000013BC                           581  
000013BC  48A7 6000                582              MOVEM.W D1-D2,-(A7)
000013C0                           583              
000013C0                           584              ; Marcar posición anterior del segmento como vacía
000013C0  3239 00001982            585              MOVE.W  (SGMPOSX),D1             ; Cargar posición X actual del segmento
000013C6  3439 00001984            586              MOVE.W  (SGMPOSY),D2             ; Cargar posición Y actual del segmento
000013CC  4EB9 000016DA            587              JSR     CINDMTRZ                ; Obtener índice de celda en D0
000013D2  4EB9 00001740            588              JSR     MCLDVCIA                ; Marcar celda como vacía
000013D8                           589              
000013D8                           590              ; Actualizar posición del segmento para seguir a la cabeza
000013D8  33F9 00001976 00001982   591              MOVE.W  (CBZPOSX),(SGMPOSX)        ; Actualizar X del segmento con la X de la cabeza
000013E2  33F9 00001978 00001984   592              MOVE.W  (CBZPOSY),(SGMPOSY)        ; Actualizar Y del segmento con la Y de la cabeza
000013EC                           593  
000013EC                           594              ; Marcar nueva posición del segmento como ocupada
000013EC  3239 00001982            595              MOVE.W  (SGMPOSX),D1             ; Cargar nueva posición X
000013F2  3439 00001984            596              MOVE.W  (SGMPOSY),D2             ; Cargar nueva posición Y
000013F8  4EB9 000016DA            597              JSR     CINDMTRZ                ; Obtener índice de celda en D0
000013FE  4EB9 00001756            598              JSR     SGMOCPD                 ; Marcar celda como ocupada por segmento
00001404                           599              
00001404  4C9F 0006                600              MOVEM.W (A7)+,D1-D2            
00001408  4E75                     601              RTS
0000140A                           602  
0000140A                           603   ;INTENTO DE AUMENTO SERPIENTE
0000140A                           604  
0000140A                           605  
0000140A                           606  ;CODIGO ANTIGUO
0000140A                           607              
0000140A                           608              
0000140A                           609              
0000140A                           610  ; ------------------------------------------------------------------------------
0000140A                           611  SEGPLOT
0000140A                           612  ; DIBUJAR SEGMENTO.
0000140A                           613  ; INPUT    : NONE 
0000140A                           614  ; OUTPUT   : NONE
0000140A                           615  ; MODIFIES : NONE
0000140A                           616  ; ------------------------------------------------------------------------------
0000140A  3F00                     617              MOVE.W  D0,-(A7)
0000140C  3003                     618              MOVE.W  D3,D0
0000140E  4EB9 00001798            619              JSR     CNVICOOR
00001414  2F01                     620              MOVE.L  D1,-(A7)
00001416                           621              
00001416  103C 0050                622              MOVE.B  #80,D0
0000141A  223C 0000FF00            623              MOVE.L  #SGMPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DEL SEGMENTO
00001420  4E4F                     624              TRAP    #15
00001422                           625              
00001422  103C 0051                626              MOVE.B  #81,D0
00001426  223C 0000AA00            627              MOVE.L  #SGMFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DEL SEGMENTO
0000142C  4E4F                     628              TRAP    #15
0000142E                           629              
0000142E  103C 0057                630              MOVE.B  #87,D0
00001432  221F                     631              MOVE.L  (A7)+,D1
00001434  3F03                     632              MOVE.W  D3,-(A7)
00001436  3601                     633              MOVE.W  D1,D3
00001438  0643 0014                634              ADD.W   #SIZECLDA,D3
0000143C  3802                     635              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
0000143E  0644 0014                636              ADD.W   #SIZECLDA,D4
00001442  4E4F                     637              TRAP    #15                     
00001444                           638                          
00001444  361F                     639              MOVE.W  (A7)+,D3  
00001446  301F                     640              MOVE.W  (A7)+,D0
00001448                           641  
00001448  4E75                     642              RTS
0000144A                           643              
0000144A                           644  
0000144A                           645  
0000144A                           646  
0000144A                           647  
0000144A                           648  
0000144A                           649  
0000144A                           650  
0000144A                           651  
0000144A                           652  
0000144A                           653  
0000144A                           654  
0000144A                           655  
0000144A                           656  -------------------- end include --------------------
0000144A                           657              INCLUDE 'TAILSRP.X68'
0000144A                           658     
0000144A                           659  ; ------------------------------------------------------------------------------
0000144A                           660  TAILINIT
0000144A                           661  ; INICIALIZAR COLA.
0000144A                           662  ; INPUT    : NONE 
0000144A                           663  ; OUTPUT   : NONE
0000144A                           664  ; MODIFIES : NONE
0000144A                           665  ; ------------------------------------------------------------------------------
0000144A                           666  
0000144A  33FC 011D 0000197E       667              MOVE.W  #(PANWIDTH/2)-CBZWIDTH-SGMWIDTH+(COLWIDTH/2),(COLPOSX)
00001452  33FC 00F0 00001980       668              MOVE.W  #(PANHEIGH/2),(COLPOSY)
0000145A                           669              
0000145A  4E75                     670              RTS
0000145C                           671              
0000145C                           672              
0000145C                           673  ; ------------------------------------------------------------------------------
0000145C                           674  TAILUPD
0000145C                           675  ; ACTUALIZAR COLA.
0000145C                           676  ; INPUT    : NONE 
0000145C                           677  ; OUTPUT   : NONE
0000145C                           678  ; MODIFIES : NONE
0000145C                           679  ; ------------------------------------------------------------------------------
0000145C  48A7 6000                680              MOVEM.W D1-D2,-(A7)
00001460                           681              
00001460                           682              ; Marca la posición actual de la cola como vacía
00001460  3239 0000197E            683              MOVE.W  (COLPOSX),D1
00001466  3439 00001980            684              MOVE.W  (COLPOSY),D2
0000146C  4EB9 000016DA            685              JSR     CINDMTRZ
00001472  4EB9 00001740            686              JSR     MCLDVCIA
00001478                           687              ; Actualiza la posición de la cola para seguir al último segmento
00001478  33F9 00001982 0000197E   688              MOVE.W  (SGMPOSX),(COLPOSX)
00001482  33F9 00001984 00001980   689              MOVE.W  (SGMPOSY),(COLPOSY)
0000148C                           690  
0000148C                           691              ; Marca la nueva posición como cola
0000148C  3239 0000197E            692              MOVE.W  (COLPOSX),D1
00001492  3439 00001980            693              MOVE.W  (COLPOSY),D2
00001498  4EB9 000016DA            694              JSR     CINDMTRZ
0000149E  4EB9 0000176C            695              JSR     COLOCPD
000014A4                           696  
000014A4                           697  ; CRECER SEGMENTOS
000014A4                           698              
000014A4                           699  
000014A4                           700  FINUPD
000014A4  4C9F 0006                701              MOVEM.W (A7)+,D1-D2
000014A8  4E75                     702              RTS
000014AA                           703              
000014AA                           704  ; ------------------------------------------------------------------------------
000014AA                           705  TAILPLOT
000014AA                           706  ; DIBUJAR COLA
000014AA                           707  ; INPUT    : NONE 
000014AA                           708  ; OUTPUT   : NONE
000014AA                           709  ; MODIFIES : NONE
000014AA                           710  ; ------------------------------------------------------------------------------
000014AA                           711  
000014AA  3F00                     712              MOVE.W  D0,-(A7)
000014AC  3003                     713              MOVE.W  D3,D0
000014AE  4EB9 00001798            714              JSR     CNVICOOR
000014B4  2F01                     715              MOVE.L  D1,-(A7)
000014B6                           716              
000014B6  103C 0050                717              MOVE.B  #80,D0
000014BA  223C 0000FF00            718              MOVE.L  #COLPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA COLA
000014C0  4E4F                     719              TRAP    #15
000014C2                           720              
000014C2  103C 0051                721              MOVE.B  #81,D0
000014C6  223C 0000AA00            722              MOVE.L  #COLFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA COLA
000014CC  4E4F                     723              TRAP    #15
000014CE                           724              
000014CE  103C 0057                725              MOVE.B  #87,D0
000014D2  221F                     726              MOVE.L  (A7)+,D1
000014D4  3F03                     727              MOVE.W  D3,-(A7)
000014D6  3601                     728              MOVE.W  D1,D3
000014D8  0643 0014                729              ADD.W   #SIZECLDA,D3
000014DC  3802                     730              MOVE.W  D2,D4                    
000014DE  0644 0014                731              ADD.W   #SIZECLDA,D4
000014E2  4E4F                     732              TRAP    #15                    ; DIBUJAMOS EL CUADRADO 
000014E4                           733                          
000014E4  361F                     734              MOVE.W  (A7)+,D3  
000014E6  301F                     735              MOVE.W  (A7)+,D0
000014E8                           736  
000014E8  4E75                     737              RTS
000014EA                           738  
000014EA                           739  
000014EA                           740              ; Itera sobre cada segmento de la cola y lo dibuja
000014EA                           741              ; Convierte la posición de segmento actual a coordenadas
000014EA                           742  
000014EA                           743              ; Dibuja segmento actual
000014EA                           744  
000014EA                           745              ; Ir al siguiente segmento
000014EA                           746              ; (Lógica de iteración según cómo estén almacenados los segmentos)
000014EA                           747  
000014EA                           748  
000014EA                           749  
000014EA                           750  
000014EA                           751  
000014EA                           752  
000014EA                           753  
000014EA                           754  
000014EA                           755  
000014EA                           756  
000014EA                           757  
000014EA                           758  
000014EA                           759  
000014EA                           760  
000014EA                           761  
000014EA                           762  
000014EA                           763  
000014EA                           764  
000014EA                           765  
000014EA                           766  
000014EA                           767  
000014EA                           768  -------------------- end include --------------------
000014EA                           769              INCLUDE 'APPLE.X68'
000014EA                           770     
000014EA                           771  ; ------------------------------------------------------------------------------
000014EA                           772  APPLEINIT
000014EA                           773  ; Inicializa la manzana en una posición aleatoria
000014EA                           774  ; INPUT    : NONE 
000014EA                           775  ; OUTPUT   : NONE
000014EA                           776  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
000014EA                           777  ; ------------------------------------------------------------------------------
000014EA                           778  
000014EA                           779              ; Llama a la función para generar la posición aleatoria
000014EA  4EB9 000015D8            780              JSR     GENPOSMNZ
000014F0                           781  
000014F0                           782              ; Convierte las coordenadas de la manzana a índice de la matriz
000014F0  4EB9 000016DA            783              JSR     CINDMTRZ
000014F6                           784  
000014F6                           785              ; Verifica si la celda está ocupada o libre
000014F6                           786  CHECK:
000014F6  4EB9 000017D4            787              JSR     CHECKCLD
000014FC  6700 0010                788              BEQ     MARKMNZ                  ; Si está libre
00001500                           789  
00001500                           790              ; Si la celda está ocupada
00001500  4EB9 000015D8            791              JSR     GENPOSMNZ                ; Genera una nueva posición
00001506  4EB9 000016DA            792              JSR     CINDMTRZ                 ; Convierte las nuevas coordenadas
0000150C  60E8                     793              BRA     CHECK                    ; Repite la comprobación
0000150E                           794  
0000150E                           795  MARKMNZ:
0000150E                           796              ; Marca la celda como ocupada con la manzana (estado 4)
0000150E  4EB9 00001782            797              JSR     MNZOCPD
00001514                           798  
00001514                           799              ; Dibuja la manzana en la pantalla
00001514  4EB9 0000155A            800              JSR     APPLEPLOT
0000151A                           801  
0000151A  4E75                     802              RTS
0000151C                           803  
0000151C                           804  ; ------------------------------------------------------------------------------
0000151C                           805  APPLEUPD
0000151C                           806  ; Actualiza la posición de la manzana cuando la serpiente come
0000151C                           807  ; INPUT    : NONE 
0000151C                           808  ; OUTPUT   : NONE
0000151C                           809  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
0000151C                           810  ; ------------------------------------------------------------------------------
0000151C                           811  
0000151C                           812  
0000151C                           813              ; Convierte las coordenadas actuales de la manzana a índice de la matriz
0000151C  4EB9 000016DA            814              JSR     CINDMTRZ
00001522                           815  
00001522                           816              ; Marca la celda anterior como vacía
00001522  4EB9 00001740            817              JSR     MCLDVCIA
00001528                           818  
00001528                           819              ; Llama a la función para generar una nueva posición aleatoria
00001528  4EB9 000015D8            820              JSR     GENPOSMNZ
0000152E                           821  
0000152E                           822              ; Convierte las nuevas coordenadas de la manzana a índice de la matriz
0000152E  4EB9 000016DA            823              JSR     CINDMTRZ
00001534                           824  
00001534                           825  CHCKUPDT:
00001534  4EB9 000017D4            826              JSR     CHECKCLD             ; Verifica si la celda está libre
0000153A  6700 0010                827              BEQ     NEWMNZ               ; Si está libre
0000153E                           828  
0000153E                           829              ; Si la celda está ocupada
0000153E  4EB9 000015D8            830              JSR     GENPOSMNZ            ; Genera una nueva posición
00001544  4EB9 000016DA            831              JSR     CINDMTRZ             ; Convierte las nuevas coordenadas
0000154A  60E8                     832              BRA     CHCKUPDT             ; Repite la comprobación
0000154C                           833  
0000154C                           834  NEWMNZ:
0000154C                           835              ; Marca la celda como ocupada con la manzana (estado 4)
0000154C  4EB9 00001782            836              JSR     MNZOCPD
00001552                           837  
00001552                           838              ; Dibuja la nueva manzana en la pantalla
00001552  4EB9 0000155A            839              JSR     APPLEPLOT
00001558                           840  
00001558  4E75                     841              RTS
0000155A                           842              
0000155A                           843  ; ------------------------------------------------------------------------------
0000155A                           844  APPLEPLOT
0000155A                           845  ; Dibuja la manzana
0000155A                           846  ; INPUT    : NONE 
0000155A                           847  ; OUTPUT   : NONE
0000155A                           848  ; MODIFIES : NONE
0000155A                           849  ; ------------------------------------------------------------------------------
0000155A  3F00                     850              MOVE.W  D0,-(A7)
0000155C  3003                     851              MOVE.W  D3,D0
0000155E  4EB9 00001798            852              JSR     CNVICOOR
00001564  2F01                     853              MOVE.L  D1,-(A7)                ; PRIMERO DEBEMOS DIBUJAR EL FONDO Y LUEGO LA MANZANA
00001566                           854              
00001566  103C 0050                855              MOVE.B  #80,D0
0000156A  223C 0090EE90            856              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001570  4E4F                     857              TRAP    #15
00001572                           858              
00001572  103C 0051                859              MOVE.B  #81,D0
00001576  223C 0090EE90            860              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
0000157C  4E4F                     861              TRAP    #15
0000157E                           862              
0000157E  103C 0057                863              MOVE.B  #87,D0
00001582  221F                     864              MOVE.L  (A7)+,D1
00001584  3F03                     865              MOVE.W  D3,-(A7)
00001586  3601                     866              MOVE.W  D1,D3
00001588  0643 0014                867              ADD.W   #SIZECLDA,D3
0000158C  3802                     868              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
0000158E  0644 0014                869              ADD.W   #SIZECLDA,D4
00001592  4E4F                     870              TRAP    #15                     
00001594                           871                          
00001594  361F                     872              MOVE.W  (A7)+,D3  
00001596  301F                     873              MOVE.W  (A7)+,D0
00001598                           874  
00001598  3F00                     875              MOVE.W  D0,-(A7)
0000159A  3003                     876              MOVE.W  D3,D0
0000159C  4EB9 00001798            877              JSR     CNVICOOR
000015A2  2F01                     878              MOVE.L  D1,-(A7)
000015A4                           879              
000015A4  103C 0050                880              MOVE.B  #80,D0
000015A8  223C 0000AAFF            881              MOVE.L  #MNZPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA MANZANA
000015AE  4E4F                     882              TRAP    #15
000015B0                           883              
000015B0  103C 0051                884              MOVE.B  #81,D0
000015B4  223C 000000FF            885              MOVE.L  #MNZFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA MANZANA
000015BA  4E4F                     886              TRAP    #15
000015BC                           887              
000015BC  103C 0058                888              MOVE.B  #88,D0
000015C0  221F                     889              MOVE.L  (A7)+,D1
000015C2  3F03                     890              MOVE.W  D3,-(A7)
000015C4  3601                     891              MOVE.W  D1,D3
000015C6  0643 0014                892              ADD.W   #SIZECLDA,D3
000015CA  3802                     893              MOVE.W  D2,D4                    ; DIBUJAMOS EL CIRCULO
000015CC  0644 0014                894              ADD.W   #SIZECLDA,D4
000015D0  4E4F                     895              TRAP    #15                     
000015D2                           896                          
000015D2  361F                     897              MOVE.W  (A7)+,D3  
000015D4  301F                     898              MOVE.W  (A7)+,D0
000015D6                           899  
000015D6                           900  
000015D6  4E75                     901              RTS
000015D8                           902  ; ----------------------------------------------------------------------------
000015D8                           903  GENPOSMNZ
000015D8                           904  ; Genera una posición aleatoria para la manzana
000015D8                           905  ; INPUT: NONE
000015D8                           906  ; OUTPUT:
000015D8                           907  ; MODIFIES: MNZPOSX, MNZPOSY
000015D8                           908  ; ----------------------------------------------------------------------------
000015D8                           909  
000015D8  48E7 8000                910              MOVEM.L D0,-(A7)
000015DC                           911  
000015DC                           912              ; Genera la coordenada X aleatoria
000015DC  4EB8 111E                913              JSR     UTLRAND
000015E0  0240 001F                914              ANDI.W  #NUMCLMNS-1, D0       ; Asegura que esté en [0, NUMCLMNS-1]
000015E4  C0FC 0014                915              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
000015E8  3200                     916              MOVE.W  D0,D1
000015EA  33C0 00001972            917              MOVE.W  D0, MNZPOSX           ; Guarda la coordenada X generada
000015F0                           918              
000015F0                           919              ; Generar coordenada Y aleatoria
000015F0  4EB8 111E                920              JSR     UTLRAND
000015F4  0240 0017                921              ANDI.W  #NUMFILAS-1, D0       ; Asegura que esté en el rango [0, NUMFILAS-1]
000015F8  C0FC 0014                922              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
000015FC  3400                     923              MOVE.W  D0,D2
000015FE  33C0 00001974            924              MOVE.W  D0, MNZPOSY           ; Guarda la coordenada Y generada
00001604                           925              
00001604  4CDF 0001                926              MOVEM.L (A7)+,D0
00001608  4E75                     927              RTS 
0000160A                           928  
0000160A                           929  
0000160A                           930  
0000160A                           931  
0000160A                           932  
0000160A                           933  
0000160A                           934  -------------------- end include --------------------
0000160A                           935              INCLUDE 'SCORE.X68'
0000160A                           936     
0000160A                           937  ; ------------------------------------------------------------------------------
0000160A                           938  SCOINIT
0000160A                           939  ; INICIALIZAR MARCADOR.
0000160A                           940  ; INPUT    : NONE 
0000160A                           941  ; OUTPUT   : NONE
0000160A                           942  ; MODIFIES : NONE
0000160A                           943  ; ------------------------------------------------------------------------------
0000160A  4279 00001988            944              CLR.W   (JGOPNTS)
00001610  4E75                     945              RTS
00001612                           946              
00001612                           947  ; ------------------------------------------------------------------------------
00001612                           948  SCOUPD
00001612                           949  ; ACTUALIZAR MARCADOR.
00001612                           950  ; INPUT    : NONE 
00001612                           951  ; OUTPUT   : NONE
00001612                           952  ; MODIFIES : NONE
00001612                           953  ; ------------------------------------------------------------------------------
00001612                           954              
00001612  48E7 8000                955              MOVEM.L D0,-(A7)
00001616                           956              
00001616                           957              ;Incrementa el marcador
00001616  3039 00001988            958              MOVE.W  (JGOPNTS),D0
0000161C  0640 0019                959              ADD.W  #25,D0
00001620  33C0 00001988            960              MOVE.W  D0,(JGOPNTS)
00001626                           961              
00001626  4CDF 0001                962              MOVEM.L (A7)+,D0
0000162A                           963  
0000162A  4E75                     964              RTS
0000162C                           965              
0000162C                           966  ; ------------------------------------------------------------------------------
0000162C                           967  SCOPLOT
0000162C                           968  ; DIBUJAR MARCADOR.
0000162C                           969  ; INPUT    : NONE 
0000162C                           970  ; OUTPUT   : NONE
0000162C                           971  ; MODIFIES : NONE
0000162C                           972  ; ------------------------------------------------------------------------------
0000162C  48E7 C040                973             MOVEM.L  D0-D1/A1,-(A7)
00001630                           974             ; SET COLOR DE FONDO
00001630  103C 0051                975             MOVE.B   #81,D0
00001634  223C 0090EE90            976             MOVE.L   #COLFND,D1
0000163A  4E4F                     977             TRAP     #15
0000163C                           978             
0000163C                           979             
0000163C                           980             
0000163C                           981             ; DIBUJAR LINEA DE PUNTUACIÓN
0000163C  43F9 00001656            982              LEA     .TXT1,A1
00001642  4281                     983              CLR.L   D1
00001644  3239 00001988            984              MOVE.W  (JGOPNTS),D1
0000164A  103C 0011                985              MOVE.B  #17,D0
0000164E  4E4F                     986              TRAP    #15
00001650                           987              
00001650  4CDF 0203                988              MOVEM.L (A7)+,D0-D1/A1
00001654  4E75                     989              RTS
00001656                           990  
00001656                           991  
00001656= 50 55 4E 54 4F 53 ...    992  .TXT1       DC.B    'PUNTOS : ',0
00001660                           993  
00001660                           994  
00001660                           995  
00001660                           996  
00001660                           997  -------------------- end include --------------------
00001660                           998              INCLUDE 'MATRIZ.X68'
00001660                           999  ; ----------------------------------------------------------------------------
00001660                          1000  ; MATRIZ
00001660                          1001  ; ----------------------------------------------------------------------------
00001660                          1002  
00001660                          1003  ;-----------------------------------------------------------------------------
00001660                          1004  MTZINIT
00001660                          1005  ; INICIALIZA LA MATRIZ, AL PRINCIPIO ESTÁ VACÍA
00001660                          1006  ; INPUT    : NONE
00001660                          1007  ; OUTPUT   : NONE
00001660                          1008  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001660                          1009  ; ----------------------------------------------------------------------------
00001660                          1010              
00001660  48A7 E080               1011              MOVEM.W D0-D2/A0,-(A7)
00001664                          1012              
00001664  41F9 0000198C           1013              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
0000166A  303C 0300               1014              MOVE.W #TCELDAS, D0    ; Número total de celdas
0000166E                          1015  
0000166E                          1016  CLNCLDS:
0000166E  4218                    1017              CLR.B (A0)+            ; Coloca 0 en cada celda
00001670  5340                    1018              SUBI.W #1, D0          ; Decrementa el contador de celdas
00001672  66FA                    1019              BNE CLNCLDS            ; Repite hasta que esten vacías
00001674                          1020              
00001674                          1021              
00001674  3239 00001976           1022              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
0000167A  3439 00001978           1023              MOVE.W  CBZPOSY, D2
00001680  4EB9 000016DA           1024              JSR     CINDMTRZ
00001686  4EB9 00001714           1025              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
0000168C                          1026              
0000168C  3239 00001982           1027              MOVE.W  SGMPOSX, D1
00001692  3439 00001984           1028              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
00001698  4EB9 000016DA           1029              JSR     CINDMTRZ
0000169E  4EB9 00001756           1030              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
000016A4                          1031              
000016A4  3239 0000197E           1032              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
000016AA  3439 00001980           1033              MOVE.W  COLPOSY, D2
000016B0  4EB9 000016DA           1034              JSR     CINDMTRZ
000016B6  4EB9 0000176C           1035              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
000016BC                          1036              
000016BC  3239 00001972           1037              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
000016C2  3439 00001974           1038              MOVE.W  MNZPOSY, D2
000016C8  4EB9 000016DA           1039              JSR     CINDMTRZ
000016CE  4EB9 00001782           1040              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
000016D4                          1041              
000016D4                          1042              
000016D4  4C9F 0107               1043              MOVEM.W (A7)+,D0-D2/A0
000016D8                          1044  
000016D8  4E75                    1045              RTS
000016DA                          1046  
000016DA                          1047  ;-----------------------------------------------------------------------------
000016DA                          1048  CINDMTRZ
000016DA                          1049  ; CALCULA EL ÍNDICE DE UNA CELDA
000016DA                          1050  ; INPUT    : D1 = coordenada X pantalla, D2 = coordenada Y pantalla
000016DA                          1051  ; OUTPUT   : D0 = índice de la celda en ESTDCLDS
000016DA                          1052  ; MODIFIES : NONE
000016DA                          1053  ; ----------------------------------------------------------------------------
000016DA                          1054  
000016DA  48A7 7000               1055               MOVEM.W D1-D3,-(A7)     ; Guarda los registros D1-D3 en la pila
000016DE                          1056  
000016DE                          1057              ; Divide X por SIZECLDA
000016DE  3601                    1058              MOVE.W  D1, D3          ; Copia X a D3
000016E0  4241                    1059              CLR.W   D1              ; Inicializa el cociente de X
000016E2                          1060  
000016E2  B67C 0014               1061  DIVX:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
000016E6  6D00 000A               1062              BLT     ENDDIVX         ; Si D3 < SIZECLDA, salta a ENDDIVX
000016EA  0443 0014               1063              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
000016EE  5241                    1064              ADDQ.W  #1, D1          ; Incrementa el cociente de X
000016F0  60F0                    1065              BRA     DIVX            ; Repite el bucle
000016F2                          1066  
000016F2                          1067  ENDDIVX:
000016F2                          1068  
000016F2                          1069              ; Divide Y por SIZECLDA
000016F2  3602                    1070              MOVE.W  D2, D3          ; Copia Y a D3
000016F4  4242                    1071              CLR.W   D2              ; Inicializa el cociente de Y
000016F6                          1072  
000016F6  B67C 0014               1073  DIVY:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
000016FA  6D00 000A               1074              BLT     ENDDIVY         ; Si D3 < SIZECLDA, salta a ENDDIVY
000016FE  0443 0014               1075              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
00001702  5242                    1076              ADDQ.W  #1, D2          ; Incrementa el cociente de Y
00001704  60F0                    1077              BRA     DIVY            ; Repite el bucle
00001706                          1078  
00001706                          1079  ENDDIVY:
00001706                          1080  
00001706                          1081              ; Calcula el índice
00001706  4240                    1082              CLR.W   D0
00001708  3002                    1083              MOVE.W  D2, D0          ; D0 = Y_CELDA
0000170A  EB40                    1084              ASL.W   #5, D0          ; D0 = Y_CELDA * NUMCLMNS (32 = 2^5)
0000170C  D041                    1085              ADD.W   D1, D0          ; D0 = Y_CELDA * NUMCLMNS + X_CELDA
0000170E                          1086  
0000170E  4C9F 000E               1087              MOVEM.W (A7)+,D1-D3     ; Restaura los registros D1-D3 desde la pila
00001712                          1088  
00001712  4E75                    1089              RTS  
00001714                          1090              
00001714                          1091  ;-----------------------------------------------------------------------------
00001714                          1092  CBZOCPD
00001714                          1093  ; MARCA UNA CELDA COMO OCUPADA POR LA CABEZA
00001714                          1094  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001714                          1095  ; OUTPUT   : NONE
00001714                          1096  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001714                          1097  ; ----------------------------------------------------------------------------
00001714                          1098  
00001714  48A7 0080               1099              MOVEM.W A0,-(A7)
00001718                          1100  
00001718  41F9 0000198C           1101              LEA     ESTDCLDS, A0                ; Dirección de la matriz en A0
0000171E  11B9 00001986 0000      1102              MOVE.B  TRZPLOT, (A0, D0.W)           ; Marca la celda como ocupada
00001726                          1103              
00001726  4C9F 0100               1104              MOVEM.W (A7)+,A0
0000172A                          1105              
0000172A  4E75                    1106              RTS
0000172C                          1107              
0000172C                          1108              
0000172C                          1109              
0000172C                          1110  ;-----------------------------------------------------------------------------
0000172C                          1111  RSTCLD
0000172C                          1112  ; RESTA 1 A LA CELDA PASADA POR PARÁMETRO
0000172C                          1113  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000172C                          1114  ; OUTPUT   : NONE
0000172C                          1115  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000172C                          1116  ; ----------------------------------------------------------------------------
0000172C                          1117  
0000172C  48A7 0080               1118              MOVEM.W A0,-(A7)
00001730                          1119  
00001730  41F9 0000198C           1120              LEA     ESTDCLDS, A0              ; Dirección de la matriz en A0
00001736  5330 0000               1121              SUBQ.B   #1, (A0, D0.W)           ; Marca la celda como ocupada
0000173A                          1122              
0000173A  4C9F 0100               1123              MOVEM.W (A7)+,A0
0000173E                          1124              
0000173E  4E75                    1125              RTS
00001740                          1126             
00001740                          1127  ;-----------------------------------------------------------------------------
00001740                          1128  MCLDVCIA
00001740                          1129  ; MARCA UNA CELDA COMO VACÍA
00001740                          1130  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001740                          1131  ; OUTPUT   : NONE
00001740                          1132  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001740                          1133  ; ----------------------------------------------------------------------------
00001740                          1134  
00001740  48A7 0080               1135              MOVEM.W A0,-(A7)
00001744                          1136  
00001744  41F9 0000198C           1137              LEA ESTDCLDS, A0                ; Direccion de la matriz en A0
0000174A  11BC 0000 0000          1138              MOVE.B #0, (A0, D0.W)           ; Marca la celda como vacía
00001750                          1139              
00001750  4C9F 0100               1140              MOVEM.W (A7)+,A0
00001754                          1141              
00001754  4E75                    1142              RTS
00001756                          1143  
00001756                          1144  ;-----------------------------------------------------------------------------
00001756                          1145  SGMOCPD
00001756                          1146  ; MARCA UNA CELDA COMO OCUPADA POR EL SEGMENTO
00001756                          1147  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001756                          1148  ; OUTPUT   : NONE
00001756                          1149  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001756                          1150  ; ----------------------------------------------------------------------------
00001756                          1151  
00001756  48A7 0080               1152              MOVEM.W A0,-(A7)
0000175A                          1153  
0000175A  41F9 0000198C           1154              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
00001760  11BC 0002 0000          1155              MOVE.B #2, (A0, D0.W)           ; Marca la celda como ocupada
00001766                          1156              
00001766  4C9F 0100               1157              MOVEM.W (A7)+,A0
0000176A                          1158              
0000176A  4E75                    1159              RTS
0000176C                          1160              
0000176C                          1161  ;-----------------------------------------------------------------------------
0000176C                          1162  COLOCPD
0000176C                          1163  ; MARCA UNA CELDA COMO OCUPADA POR LA COLA
0000176C                          1164  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000176C                          1165  ; OUTPUT   : NONE
0000176C                          1166  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000176C                          1167  ; ----------------------------------------------------------------------------
0000176C                          1168  
0000176C  48A7 0080               1169              MOVEM.W A0,-(A7)
00001770                          1170  
00001770  41F9 0000198C           1171              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
00001776  11BC 0001 0000          1172              MOVE.B #1, (A0, D0.W)           ; Marca la celda como ocupada
0000177C                          1173              
0000177C  4C9F 0100               1174              MOVEM.W (A7)+,A0
00001780                          1175              
00001780  4E75                    1176              RTS
00001782                          1177  
00001782                          1178  
00001782                          1179  ;-----------------------------------------------------------------------------
00001782                          1180  MNZOCPD
00001782                          1181  ; MARCA UNA CELDA COMO OCUPADA POR LA MANZANA
00001782                          1182  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001782                          1183  ; OUTPUT   : NONE
00001782                          1184  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001782                          1185  ; ----------------------------------------------------------------------------
00001782                          1186  
00001782  48A7 0080               1187              MOVEM.W A0,-(A7)
00001786                          1188  
00001786  41F9 0000198C           1189              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
0000178C  11BC 0004 0000          1190              MOVE.B #4, (A0, D0.W)           ; Marca la celda como ocupada
00001792                          1191              
00001792  4C9F 0100               1192              MOVEM.W (A7)+,A0
00001796                          1193              
00001796  4E75                    1194              RTS
00001798                          1195  
00001798                          1196              
00001798                          1197  ;-----------------------------------------------------------------------------
00001798                          1198  CNVICOOR
00001798                          1199  ; Convierte un índice de celda a coordenadas de pantalla (X, Y)
00001798                          1200  ; INPUT    : D0 = índice de la celda en ESTADO_CELDAS
00001798                          1201  ; OUTPUT   : D1 = coordenada X, D2 = coordenada Y
00001798                          1202  ; MODIFIES : NONE
00001798                          1203  ; ----------------------------------------------------------------------------
00001798                          1204  
00001798  48A7 9800               1205              MOVEM.W D0/D3-D4,-(A7)
0000179C                          1206  
0000179C  3400                    1207              MOVE.W  D0,D2         ; Copia índice a D2 para calcular la fila
0000179E  EA4A                    1208              LSR.W   #5,D2         ; D2 = índice / NUM_COLUMNAS (32 = 2^5)
000017A0  3200                    1209              MOVE.W  D0,D1         ; Copia índice a D1 para calcular la columna
000017A2  C27C 001F               1210              AND.W   #$1F,D1       ; D1 = índice % NUM_COLUMNAS (31 = 0x1F) (CREO)
000017A6                          1211  
000017A6                          1212              ; Multiplica por TAMAÑO_CELDA = 10
000017A6  363C 0014               1213              MOVE.W  #SIZECLDA, D3
000017AA  3801                    1214              MOVE.W  D1,D4         ; Copia D1 para multiplicar por 10
000017AC  4241                    1215              CLR.W   D1            ; Inicializa resultado
000017AE                          1216  
000017AE                          1217  
000017AE                          1218  MULTLOOPX: 
000017AE  B87C 0000               1219              CMP.W   #0, D4        ; ¿Quedan iteraciones?
000017B2  6700 0008               1220              BEQ     ENDMULTX
000017B6  D243                    1221              ADD.W   D3,D1         ; Suma TAMANO_CELDA (10) repetidamente
000017B8                          1222  
000017B8  5344                    1223              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
000017BA  60F2                    1224              BRA     MULTLOOPX     ; Repite mientras no sea 0
000017BC                          1225  ENDMULTX: 
000017BC  3802                    1226              MOVE.W  D2,D4         ; Copia D2 para multiplicar por 10
000017BE  4242                    1227              CLR.W   D2            ; Inicializa resultado
000017C0                          1228  
000017C0                          1229  MULTLOOPY: 
000017C0  B87C 0000               1230              CMP.W   #0, D4        ; ¿Quedan iteraciones?
000017C4  6700 0008               1231              BEQ     ENDMULTY
000017C8  D443                    1232              ADD.W   D3,D2         ; Suma TAMANO_CELDA (10) repetidamente
000017CA  5344                    1233              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
000017CC  60F2                    1234              BRA     MULTLOOPY     ; Repite mientras no sea 0
000017CE                          1235  ENDMULTY:
000017CE  4C9F 0019               1236              MOVEM.W (A7)+,D0/D3-D4
000017D2                          1237  
000017D2  4E75                    1238              RTS
000017D4                          1239  
000017D4                          1240  ; ----------------------------------------------------------------------------
000017D4                          1241  CHECKCLD
000017D4                          1242  ; INPUT: D0 = índice de la celda
000017D4                          1243  ; OUTPUT: D0 = 0 si está vacía, 1 si está ocupada
000017D4                          1244  ; MODIFIES: Ninguno
000017D4                          1245  ; ----------------------------------------------------------------------------
000017D4                          1246  
000017D4  41F9 0000198C           1247              LEA     ESTDCLDS, A0    ; Carga la dirección de la matriz ESTDCLDS
000017DA  1230 0000               1248              MOVE.B  (A0, D0.W),D1   ; Carga el estado de la celda en D1
000017DE  B23C 0000               1249              CMP.B   #0, D1          ; Compara si está vacía (0)
000017E2  6700 0008               1250              BEQ     CLDFREE         ; Si está vacía
000017E6  303C 0001               1251              MOVE.W  #1, D0          ; Si está ocupada, devuelve 1 (ocupada)
000017EA                          1252  
000017EA  4E75                    1253              RTS
000017EC                          1254  
000017EC                          1255  CLDFREE:
000017EC  303C 0000               1256              MOVE.W  #0, D0                 ; Devuelve 0 (libre)
000017F0                          1257  
000017F0  4E75                    1258              RTS
000017F2                          1259  
000017F2                          1260  
000017F2                          1261  ;-----------------------------------------------------------------------------
000017F2                          1262  FONPLOT
000017F2                          1263  ; DIBUJADO DEL FONDO
000017F2                          1264  ; INPUT    : NONE
000017F2                          1265  ; OUTPUT   : NONE
000017F2                          1266  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000017F2                          1267  ; ----------------------------------------------------------------------------
000017F2                          1268  
000017F2  3F00                    1269              MOVE.W  D0,-(A7)
000017F4  3003                    1270              MOVE.W  D3,D0
000017F6  4EB8 1798               1271              JSR     CNVICOOR
000017FA  2F01                    1272              MOVE.L  D1,-(A7)
000017FC                          1273              
000017FC  103C 0050               1274              MOVE.B  #80,D0
00001800  223C 0090EE90           1275              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001806  4E4F                    1276              TRAP    #15
00001808                          1277              
00001808  103C 0051               1278              MOVE.B  #81,D0
0000180C  223C 0090EE90           1279              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001812  4E4F                    1280              TRAP    #15
00001814                          1281              
00001814  103C 0057               1282              MOVE.B  #87,D0
00001818  221F                    1283              MOVE.L  (A7)+,D1
0000181A  3F03                    1284              MOVE.W  D3,-(A7)
0000181C  3601                    1285              MOVE.W  D1,D3
0000181E  0643 0014               1286              ADD.W   #SIZECLDA,D3
00001822  3802                    1287              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001824  0644 0014               1288              ADD.W   #SIZECLDA,D4
00001828  4E4F                    1289              TRAP    #15                     
0000182A                          1290                          
0000182A  361F                    1291              MOVE.W  (A7)+,D3  
0000182C  301F                    1292              MOVE.W  (A7)+,D0
0000182E  4E75                    1293              RTS         
00001830                          1294  
00001830                          1295  
00001830                          1296  
00001830                          1297  ;-----------------------------------------------------------------------------
00001830                          1298  MTZUPD
00001830                          1299  ; ACTUALIZA LA MATRIZ CASILLA A CASILLA
00001830                          1300  ; INPUT    : NONE
00001830                          1301  ; OUTPUT   : NONE
00001830                          1302  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001830                          1303  ; ----------------------------------------------------------------------------
00001830                          1304  
00001830                          1305  
00001830  48A7 E080               1306              MOVEM.W D0-D2/A0,-(A7)
00001834                          1307              
00001834  41F9 0000198C           1308              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
0000183A  303C 0300               1309              MOVE.W #TCELDAS, D0    ; Número total de celdas
0000183E                          1310  
0000183E                          1311  .CLNCLDS:
0000183E  4218                    1312              CLR.B (A0)+            ; Coloca 0 en cada celda
00001840  5340                    1313              SUBI.W #1, D0          ; Decrementa el contador de celdas
00001842  66FA                    1314              BNE .CLNCLDS           ; Repite hasta que esten vacías
00001844                          1315              
00001844                          1316              
00001844  3239 00001976           1317              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
0000184A  3439 00001978           1318              MOVE.W  CBZPOSY, D2
00001850  4EB8 16DA               1319              JSR     CINDMTRZ
00001854  4EB8 1714               1320              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
00001858                          1321              
00001858  3239 00001982           1322              MOVE.W  SGMPOSX, D1
0000185E  3439 00001984           1323              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
00001864  4EB8 16DA               1324              JSR     CINDMTRZ
00001868  4EB8 1756               1325              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
0000186C                          1326              
0000186C  3239 0000197E           1327              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
00001872  3439 00001980           1328              MOVE.W  COLPOSY, D2
00001878  4EB8 16DA               1329              JSR     CINDMTRZ
0000187C  4EB8 176C               1330              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
00001880                          1331              
00001880  3239 00001972           1332              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
00001886  3439 00001974           1333              MOVE.W  MNZPOSY, D2
0000188C  4EB8 16DA               1334              JSR     CINDMTRZ
00001890  4EB8 1782               1335              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
00001894                          1336              
00001894                          1337              
00001894  4C9F 0107               1338              MOVEM.W (A7)+,D0-D2/A0
00001898                          1339  
00001898  4E75                    1340              RTS
0000189A                          1341  
0000189A                          1342  
0000189A                          1343  
0000189A                          1344  ;-----------------------------------------------------------------------------
0000189A                          1345  MTZPLOT
0000189A                          1346  ; DIBUJA LA MATRIZ CASILLA A CASILLA
0000189A                          1347  ; INPUT    : NONE
0000189A                          1348  ; OUTPUT   : NONE
0000189A                          1349  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
0000189A                          1350  ; ----------------------------------------------------------------------------
0000189A  48E7 F080               1351              MOVEM.L D0-D3/A0,-(A7)
0000189E                          1352  
0000189E  4240                    1353              CLR.W   D0
000018A0  4243                    1354              CLR.W   D3
000018A2  41F9 0000198C           1355              LEA     ESTDCLDS, A0            ; Apunta al inicio de ESTDCLDS
000018A8  303C 0300               1356              MOVE.W  #TCELDAS, D0            ; Número total de celdas
000018AC  363C 0000               1357              MOVE.W  #0,D3                   ; LO UTILIZAMOS PARA SABER EL INDICE EN EL QUE NOS ENCONTRAMOS
000018B0  4241                    1358              CLR.W   D1
000018B2  4242                    1359              CLR.W   D2
000018B4                          1360              
000018B4                          1361  
000018B4                          1362  PLOTCLDS:
000018B4  1218                    1363              MOVE.B  (A0)+,D1                ; MOVEMOS EL VALOR DE LA CELDA A D1
000018B6  B23C 0000               1364              CMP.B   #0,D1
000018BA  6700 0036               1365              BEQ     PLOTVAC                 ; SALTA A DIBUJAR POSICIÓN VACÍA
000018BE  B23C 0001               1366              CMP.B   #1,D1 
000018C2  6700 0034               1367              BEQ     PLOTCOL                 ; SALTA A DIBUJAR COLA
000018C6  B23C 0002               1368              CMP.B   #2,D1
000018CA  6700 0032               1369              BEQ     PLOTSEG                 ; SALTA A DIBUJAR SEGMENTO
000018CE  B239 00001986           1370              CMP.B   TRZPLOT,D1
000018D4  6700 0016               1371              BEQ     PLOTCBZ                 ; SALTA A DIBUJAR CABEZA
000018D8  B23C 0004               1372              CMP.B   #4,D1                 
000018DC  6700 0026               1373              BEQ     PLOTAPPLE               ; SALTA A DIBUJAR MANZANA
000018E0                          1374    
000018E0                          1375  DONEPLOT            
000018E0  5243                    1376              ADDQ    #1,D3                   ; AUMENTAMOS EL INDICE DE CELDA PARA LA SIGUIENTE
000018E2  5340                    1377              SUBI.W  #1, D0                  ; Decrementa el contador de celdas
000018E4  66CE                    1378              BNE     PLOTCLDS                ; Repite hasta que esten vacías
000018E6  4CDF 010F               1379              MOVEM.L (A7)+,D0-D3/A0
000018EA  4E75                    1380              RTS
000018EC                          1381  PLOTCBZ:
000018EC  4EB8 1326               1382              JSR     HEADPLOT
000018F0  60EE                    1383              BRA     DONEPLOT
000018F2                          1384  
000018F2                          1385  PLOTVAC:    
000018F2  4EB8 17F2               1386              JSR     FONPLOT
000018F6  60E8                    1387              BRA     DONEPLOT                ; DIBUJADO HECHO 
000018F8                          1388  
000018F8                          1389  PLOTCOL:   
000018F8  4EB8 14AA               1390              JSR     TAILPLOT 
000018FC  60E2                    1391              BRA     DONEPLOT                ; DIBUJADO HECHO 
000018FE                          1392              
000018FE                          1393  PLOTSEG:    
000018FE  4EB8 140A               1394              JSR     SEGPLOT
00001902  60DC                    1395              BRA     DONEPLOT                ; DIBUJADO HECHO    
00001904                          1396  
00001904                          1397  PLOTAPPLE:
00001904  4EB8 155A               1398              JSR     APPLEPLOT
00001908  60D6                    1399              BRA     DONEPLOT            
0000190A                          1400  
0000190A                          1401  
0000190A                          1402  
0000190A                          1403  
0000190A                          1404  
0000190A                          1405  
0000190A                          1406  
0000190A                          1407  
0000190A                          1408  
0000190A                          1409  
0000190A                          1410  
0000190A                          1411  
0000190A                          1412  
0000190A                          1413  
0000190A                          1414  -------------------- end include --------------------
0000190A                          1415  START:
0000190A                          1416                  
0000190A                          1417  ; --- INIZIALIZACIÓN ---------------------------------------------------------
0000190A                          1418  
0000190A  007C 0700               1419              ORI.W   #$0700,SR
0000190E  4EB8 1000               1420              JSR     SYSINIT
00001912  4EB8 1108               1421              JSR     UTLINIT
00001916  4EB8 108C               1422              JSR     KBDINIT
0000191A  4EB8 1660               1423              JSR     MTZINIT
0000191E  4EB8 123C               1424              JSR     HEADINIT                
00001922  4EB8 13AA               1425              JSR     SEGINIT
00001926  4EB8 144A               1426              JSR     TAILINIT
0000192A  4EB8 160A               1427              JSR     SCOINIT
0000192E  4EB8 14EA               1428              JSR     APPLEINIT
00001932                          1429              
00001932                          1430  
00001932                          1431  .LOOP
00001932                          1432  
00001932                          1433  ; --- ACTUALIZAR -------------------------------------------------------------
00001932                          1434  
00001932                          1435  ; LEER DISPOSITIVOS DE ENTRADA
00001932                          1436  
00001932  4E41                    1437              TRAP    #1
00001934                          1438  
00001934                          1439  ; ACTUALIZAR LÓGICA DEL JUEGO
00001934                          1440              
00001934  4EB8 145C               1441              JSR     TAILUPD
00001938  4EB8 13BC               1442              JSR     SEGUPD
0000193C  4EB8 126A               1443              JSR     HEADUPD
00001940                          1444              ;JSR     APPLEUPD  
00001940  4EB8 1830               1445              JSR     MTZUPD
00001944                          1446              ;JSR     SCOUPD
00001944                          1447              
00001944                          1448  ; --- SINCRONIZACIÓN ---------------------------------------------------------
00001944                          1449              
00001944  4A39 00001C94           1450  .WINT       TST.B   (SCRINTCT)
0000194A  67F8                    1451              BEQ     .WINT   
0000194C  4239 00001C94           1452              CLR.B   (SCRINTCT)         
00001952                          1453  
00001952                          1454  
00001952                          1455  ;---DIBUJAR-------------------------------------------------------------------
00001952  4EB8 1326               1456               JSR    HEADPLOT
00001956  4EB8 140A               1457               JSR    SEGPLOT
0000195A  4EB8 14AA               1458               JSR    TAILPLOT
0000195E  4EB8 155A               1459               JSR    APPLEPLOT
00001962  4EB8 189A               1460               JSR    MTZPLOT
00001966  4EB8 162C               1461               JSR    SCOPLOT
0000196A                          1462              
0000196A  4E40                    1463              TRAP    #0                      ; ACTUALIZA DOBLE BUFFER
0000196C                          1464  
0000196C                          1465  
0000196C  60C4                    1466              BRA     .LOOP
0000196E                          1467  
0000196E  FFFF FFFF               1468              SIMHALT
00001972                          1469              
00001972                          1470              INCLUDE 'VARS.X68'
00001972                          1471  ; ----------------------------------------------------------------------------
00001972                          1472  ; VARIABLES DEL JUEGO
00001972                          1473  ; ----------------------------------------------------------------------------
00001972                          1474  
00001972                          1475  ; --- VARIABLES DE LA MANZANA ------------------------------------------------
00001972                          1476  
00001972                          1477  MNZPOSX     DS.W    1                       ; COORDENADA X DE LA MANZANA
00001974                          1478  MNZPOSY     DS.W    1                       ; COORDENADA Y DE LA MANZANA
00001976                          1479  
00001976                          1480  ; --- VARIABLES DE LA SERPIENTE ----------------------------------------------
00001976                          1481  
00001976                          1482  CBZPOSX     DS.W    1                       ; COORDENADA X CABEZA
00001978                          1483  CBZPOSY     DS.W    1                       ; COORDENADA Y CABEZA
0000197A                          1484  CBZVELX     DS.W    1                       ; VELOCIDAD X CABEZA
0000197C                          1485  CBZVELY     DS.W    1                       ; VELOCIDAD Y CABEZA
0000197E                          1486  COLPOSX     DS.W    1                       ; COORDENADA X COLA
00001980                          1487  COLPOSY     DS.W    1                       ; COORDENADA Y COLA
00001982                          1488  SGMPOSX     DS.W    1                       ; COORDENADA X SEGMENTO
00001984                          1489  SGMPOSY     DS.W    1                       ; COORDENADA Y SEGMENTO
00001986                          1490  TRZPLOT     DS.B    1                       ; NÚMERO DE TROZOS A DIBUJAR
00001987                          1491  
00001987                          1492  
00001987                          1493  
00001987                          1494  
00001987                          1495  ; --- VARIABLES DEL MARCADOR -------------------------------------------------
00001987                          1496  
00001988                          1497  JGOPNTS     DS.W    1                       ; PUNTUACIÓN DEL JUEGO
0000198A                          1498  
0000198A                          1499  
0000198A                          1500  
0000198A                          1501  
0000198A                          1502  
0000198A                          1503  
0000198A                          1504  
0000198A                          1505  
0000198A                          1506  
0000198A                          1507  -------------------- end include --------------------
0000198A                          1508              INCLUDE 'LIB/UTLVARS.X68'
0000198A                          1509  ; =============================================================================
0000198A                          1510  ; UTILITY VARIABLES
0000198A                          1511  ; =============================================================================
0000198A                          1512  
0000198A                          1513  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
0000198C                          1514              DS.W    0
0000198C                          1515  -------------------- end include --------------------
0000198C                          1516              INCLUDE 'SYSVARS.X68'
0000198C                          1517  ; ----------------------------------------------------------------------------
0000198C                          1518  ; VARIABLES DEL SISTEMA
0000198C                          1519  ; ----------------------------------------------------------------------------
0000198C                          1520  
0000198C                          1521  ; --- VARIABLES DE LA MATRIZ -------------------------------------------------
0000198C                          1522  
0000198C                          1523  ESTDCLDS    DS.B    TCELDAS                 ; ESTADO DE LAS CELDAS 0=VACÍO  1=COLA   2=SEGMENTO  TRZPLOT=CABEZA  4?=MANZANA    
00001C8C                          1524  ESTDCBZ     DS.B    1                       ; 0= DERECHA, 1=ARRIBA, 2=IZQUIERDA, 3=ABAJO
00001C8D                          1525  
00001C8D                          1526  ; --- VARIABLES DE TECLADO ---------------------------------------------------
00001C8D                          1527  
00001C8D                          1528  KBDVAL      DS.B    1
00001C8E                          1529  KBDEDGE     DS.B    1                       ; KEY EDGE
00001C90                          1530  LASTKEY     DS.L    1                       
00001C94                          1531  
00001C94                          1532  ;--- TIMED INTERRUPT RELATED VARIABLES ---------------------------------------
00001C94                          1533              
00001C94                          1534  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00001C96                          1535              DS.W    0
00001C96                          1536  
00001C96                          1537  
00001C96                          1538  
00001C96                          1539  
00001C96                          1540  
00001C96                          1541  
00001C96                          1542  
00001C96                          1543  
00001C96                          1544  
00001C96                          1545  
00001C96                          1546  
00001C96                          1547  
00001C96                          1548  
00001C96                          1549  
00001C96                          1550  -------------------- end include --------------------
00001C96                          1551      
00001C96                          1552      
00001C96                          1553              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
APPLEINIT           14EA
APPLEPLOT           155A
APPLEUPD            151C
ARR                 10E2
CBZFCOL             AA00
CBZHEIGH            14
CBZOCPD             1714
CBZPCOL             FF00
CBZPOSX             1976
CBZPOSY             1978
CBZVEL              14
CBZVELX             197A
CBZVELY             197C
CBZWIDTH            14
CHCKUPDT            1534
CHECK               14F6
CHECKCLD            17D4
CHKCOL              12DC
CINDMTRZ            16DA
CLDFREE             17EC
CLNCLDS             166E
CNVICOOR            1798
COLFCOL             AA00
COLFND              90EE90
COLHEIGH            A
COLOCPD             176C
COLPCOL             FF00
COLPOSX             197E
COLPOSY             1980
COLWIDTH            A
CONTINU             1102
DER                 10D6
DIVX                16E2
DIVY                16F6
DONEPLOT            18E0
DWN                 10FA
ENDDIVX             16F2
ENDDIVY             1706
ENDMULTX            17BC
ENDMULTY            17CE
ESTDCBZ             1C8C
ESTDCLDS            198C
FIN                 1320
FINUPD              14A4
FONPLOT             17F2
GENPOSMNZ           15D8
HEADINIT            123C
HEADPLOT            1326
HEADUPD             126A
IZQ                 10EE
JGOPNTS             1988
KBDDOWN             28
KBDEDGE             1C8E
KBDINIT             108C
KBDLEFT             25
KBDRIGHT            27
KBDUP               26
KBDUPD              109A
KBDVAL              1C8D
LASTKEY             1C90
LNGINI              1
MARKMNZ             150E
MAXSGM              1
MCLDVCIA            1740
MNZFCOL             FF
MNZHEIGH            14
MNZOCPD             1782
MNZPCOL             AAFF
MNZPOSX             1972
MNZPOSY             1974
MNZWIDTH            14
MTZINIT             1660
MTZPLOT             189A
MTZUPD              1830
MTZUPD:CLNCLDS      183E
MULTLOOPX           17AE
MULTLOOPY           17C0
NEWMNZ              154C
NOCOL               1308
NUMCLMNS            20
NUMFILAS            18
OJOFCOL             FFFFFF
OJOHEIGH            A
OJOPCOL             0
OJOWIDTH            A
PANHEIGH            1E0
PANWIDTH            280
PLOTAPPLE           1904
PLOTCBZ             18EC
PLOTCLDS            18B4
PLOTCOL             18F8
PLOTSEG             18FE
PLOTVAC             18F2
PNTSFCOL            0
PNTSTEXT            65
RSTCLD              172C
SCOINIT             160A
SCOPLOT             162C
SCOPLOT:TXT1        1656
SCOUPD              1612
SCRINIT             1026
SCRINTCT            1C94
SCRPLOT             1072
SCRTIM              106A
SEGINIT             13AA
SEGPLOT             140A
SEGUPD              13BC
SGMFCOL             AA00
SGMHEIGH            14
SGMOCPD             1756
SGMPCOL             FF00
SGMPOSX             1982
SGMPOSY             1984
SGMWIDTH            14
SIGABA              12D4
SIGARR              12BC
SIGDER              12B0
SIGIZQ              12C8
SIZECLDA            14
START               190A
START:LOOP          1932
START:WINT          1944
SYSINIT             1000
TAILINIT            144A
TAILPLOT            14AA
TAILUPD             145C
TCELDAS             300
TRZPLOT             1986
UTLINIT             1108
UTLRAND             111E
UTLRAND:RANDVEC     113C
UTLRNDIX            198A
