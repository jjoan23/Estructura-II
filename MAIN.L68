00001D9A Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 30/12/2024 18:35:45

00000000                             1  *-----------------------------------------------------------------------------
00000000                             2  * Title      : MAIN
00000000                             3  * Written by :
00000000                             4  * Date       :
00000000                             5  * Description:
00000000                             6  *-----------------------------------------------------------------------------
00000000                             7  
00001000                             8              ORG    $1000
00001000                             9              
00001000                            10              INCLUDE 'CONST.X68'
00001000                            11  ; ----------------------------------------------------------------------------
00001000                            12  ; CONSTANTES DEL JUEGO
00001000                            13  ; ----------------------------------------------------------------------------
00001000                            14     
00001000                            15  ; --- CONSTANTES DE LA MANZANA -----------------------------------------------
00001000                            16  
00001000  =00000014                 17  MNZWIDTH    EQU     20                      ; ANCHURA DE LA MANZANA (a determinar)
00001000  =00000014                 18  MNZHEIGH    EQU     20                      ; ALTURA DE LA MANZANA (a determinar)
00001000  =0000AAFF                 19  MNZPCOL     EQU     $0000AAFF               ; COLOR CONTORNO MANZANA (a determinar)
00001000  =000000FF                 20  MNZFCOL     EQU     $000000FF               ; COLOR RELLENO MANZANA (a determinar)
00001000                            21  
00001000                            22  ; --- CONSTANTES DE LA SERPIENTE ---------------------------------------------
00001000                            23  
00001000  =00000001                 24  MAXSGM      EQU     1                       ; TAMAÑO MÁXIMO DE SEGMENTOS (a determinar)
00001000  =00000001                 25  LNGINI      EQU     1                       ; LONGITUD INICIAL SERPIENTE (a determinar)
00001000  =00000014                 26  CBZVEL      EQU     20                      ; VELOCIDAD DE LA CABEZA (a determinar)
00001000  =00000014                 27  SGMWIDTH    EQU     20                      ; ANCHURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 28  SGMHEIGH    EQU     20                      ; ALTURA DE UN SEGMENTO (PROVISIONAL)
00001000  =0000FF00                 29  SGMPCOL     EQU     $0000FF00               ; COLOR CONTORNO SEGMENTO (PROVISIONAL)
00001000  =0000AA00                 30  SGMFCOL     EQU     $0000AA00               ; COLOR RELLENO SEGMENTO (PROVISIONAL)
00001000  =0000000A                 31  COLWIDTH    EQU     10                      ; ANCHURA DE LA COLA (PROVISIONAL)
00001000  =0000000A                 32  COLHEIGH    EQU     10                      ; ALTURA DE LA COLA (PROVISIONAL)
00001000  =0000FF00                 33  COLPCOL     EQU     $0000FF00               ; COLOR CONTORNO COLA (PROVISIONAL)
00001000  =0000AA00                 34  COLFCOL     EQU     $0000AA00               ; COLOR RELLENO COLA (PROVISIONAL)
00001000  =00000014                 35  CBZWIDTH    EQU     20                      ; ANCHURA DE LA CABEZA (PROVISIONAL)
00001000  =00000014                 36  CBZHEIGH    EQU     20                      ; ALTURA DE LA CABEZA (PROVISIONAL)
00001000  =0000FF00                 37  CBZPCOL     EQU     $0000FF00               ; COLOR CONTORNO CABEZA (PROVISIONAL)
00001000  =0000AA00                 38  CBZFCOL     EQU     $0000AA00               ; COLOR RELLENO CABEZA (PROVISIONAL)
00001000  =0000000A                 39  OJOWIDTH    EQU     10                      ; ANCHURA DE OJO DE SERPIENTE
00001000  =0000000A                 40  OJOHEIGH    EQU     10                      ; ALTURA DE OJO DE SERPIENTE
00001000  =00000000                 41  OJOPCOL     EQU     $00000000               ; COLOR CONTORNO OJO
00001000  =00FFFFFF                 42  OJOFCOL     EQU     $00FFFFFF               ; COLOR RELLENO OJO            
00001000                            43  
00001000                            44  ; --- CONSTANTES MARCADOR ----------------------------------------------------
00001000                            45  
00001000  =00000000                 46  PNTSFCOL    EQU     $00000000               ; COLOR FONDO MARCADOR (a determinar)
00001000  =00000065                 47  PNTSTEXT    EQU     0101                    ; COORDENADAS DEL MARCADOR (a determinar)
00001000                            48  
00001000                            49  ; --- CONSTANTES RELACIONADAS CON LOS ESTADOS --------------------------------
00001000                            50  
00001000  =FFFFFFFF                 51  STANONE     EQU     -1                      ; NÚMERO DE ESTADO NO EXISTENTE
00001000                            52  
00001000                            53  
00001000                            54  
00001000                            55  -------------------- end include --------------------
00001000                            56              INCLUDE 'SYSCONST.X68'
00001000                            57  ; ----------------------------------------------------------------------------
00001000                            58  ; CONSTANTES DEL SISTEMA
00001000                            59  ; ----------------------------------------------------------------------------
00001000                            60  
00001000                            61  ; ---CONSTANTES DE LA PANTALLA------------------------------------------------
00001000                            62  
00001000  =00000280                 63  PANWIDTH    EQU     640                     ; ANCHO DE LA PANTALLA
00001000  =000001E0                 64  PANHEIGH    EQU     480                     ; ALTURA DE LA PANTALLA
00001000  =0090EE90                 65  COLFND      EQU     $90EE90                 ; COLOR DEL FONDO DE LA PANTALLA
00001000  =00000032                 66  SCRFPS      EQU     50
00001000                            67  
00001000                            68  ; ---CONSTANTES DE LA MATRIZ--------------------------------------------------
00001000                            69  
00001000  =00000014                 70  SIZECLDA    EQU     20                      ; TAMAÑO DE CADA CELDA EN PIXELES
00001000  =00000020                 71  NUMCLMNS    EQU     32                      ; COLUMNAS DE CELDAS (640/10)
00001000  =00000018                 72  NUMFILAS    EQU     24                      ; FILAS DE CELDAS (480/10)
00001000  =00000300                 73  TCELDAS     EQU     768                     ; TOTAL DE CELDAS (64 * 48)
00001000                            74  
00001000                            75  ; ---CÓDIGOS DE TECLADO-------------------------------------------------------
00001000                            76  
00001000  =00000025                 77  KBDLEFT     EQU     $25
00001000  =00000026                 78  KBDUP       EQU     $26
00001000  =00000027                 79  KBDRIGHT    EQU     $27
00001000  =00000028                 80  KBDDOWN     EQU     $28
00001000                            81  
00001000                            82  ; --- IDENTIFICADORES DE SONIDO ----------------------------------------------
00001000                            83  
00001000  =00000000                 84  SNDEAT      EQU     0
00001000  =00000001                 85  SNDGMOV     EQU     1
00001000                            86  
00001000                            87  ; --- NÚMEROS DE TRAP --------------------------------------------------------
00001000                            88  
00001000  =00000000                 89  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 90  KBDUPTN     EQU     1                       ; KEYBOARD TRAP NUMBER
00001000  =00000002                 91  SNDPLTN     EQU     2                       ; SOUND TRAP NUMBER
00001000                            92  
00001000                            93  ; --- NÚMEROS DE INTERRUPCIÓN ------------------------------------------------
00001000                            94  
00001000  =00000001                 95  SCRINTN     EQU     1     
00001000                            96  
00001000                            97  
00001000                            98  
00001000                            99  
00001000                           100  
00001000                           101  
00001000                           102  -------------------- end include --------------------
00001000                           103              INCLUDE 'SYSTEM.X68'
00001000                           104   
00001000                           105   
00001000                           106  SYSINIT
00001000                           107  ; INICIA EL  SISTEMA
00001000                           108  ; INPUT    : NONE
00001000                           109  ; OUTPUT   : NONE
00001000                           110  ; MODIFIES : NONE
00001000                           111  ; ----------------------------------------------------------------------------
00001000                           112              
00001000  21FC 000010EC 0080       113              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001008  21FC 00001114 0084       114              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
00001010  21FC 00001088 0088       115              MOVE.L  #SNDPLAY,($80+SNDPLTN*4)
00001018  21FC 000010DE 0064       116              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001020                           117              
00001020  4EB9 0000109A            118              JSR     SCRINIT
00001026  4EB9 00001106            119              JSR     KBDINIT
0000102C  4EB9 0000103A            120              JSR     SNDINIT
00001032                           121              
00001032  40E7                     122              MOVE.W  SR,-(A7)
00001034  0257 D8FF                123              ANDI.W  #$D8FF,(A7)
00001038                           124              
00001038  4E73                     125              RTE
0000103A                           126              
0000103A                           127  ; ----------------------------------------------------------------------------
0000103A                           128  SNDINIT
0000103A                           129  ; SOUND SYSTEM INIT
0000103A                           130  ; INPUT    : NONE
0000103A                           131  ; OUTPUT   : NONE
0000103A                           132  ; MODIFIES : NONE
0000103A                           133  ; ----------------------------------------------------------------------------
0000103A                           134  
0000103A  48E7 C0C0                135              MOVEM.L D0-D1/A0-A1,-(A7)
0000103E                           136  
0000103E  4201                     137              CLR.B   D1
00001040  41F9 0000107C            138              LEA     .SNDLIST,A0
00001046  2018                     139  .LOOP       MOVE.L  (A0)+,D0
00001048  6700 000E                140              BEQ     .DONE
0000104C  2240                     141              MOVE.L  D0,A1
0000104E  103C 0047                142              MOVE.B  #71,D0
00001052  4E4F                     143              TRAP    #15
00001054  5201                     144              ADDQ.B  #1,D1
00001056  60EE                     145              BRA     .LOOP
00001058                           146              
00001058  4CDF 0303                147  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
0000105C  4E75                     148              RTS
0000105E                           149              
0000105E= 53 4E 44 2F 45 41 ...    150  .SNDEAT     DC.B    'SND/EAT.wav',0
0000106A= 53 4E 44 2F 47 41 ...    151  .SNDGMOV    DC.B    'SND/GAMEOVER.wav',0
0000107C= 0000105E 0000106A ...    152  .SNDLIST    DC.L    .SNDEAT,.SNDGMOV,0
00001088                           153              
00001088                           154  ; ----------------------------------------------------------------------------
00001088                           155  SNDPLAY
00001088                           156  ; PLAY SOUND
00001088                           157  ; INPUT    : D7 SOUND ID
00001088                           158  ; OUTPUT   : NONE
00001088                           159  ; MODIFIES : NONE
00001088                           160  ; ----------------------------------------------------------------------------            
00001088                           161              
00001088  48A7 C000                162              MOVEM.W D0-D1,-(A7)
0000108C                           163              
0000108C  103C 0048                164              MOVE.B  #72,D0
00001090  1207                     165              MOVE.B  D7,D1
00001092  4E4F                     166              TRAP    #15
00001094                           167              
00001094  4C9F 0003                168              MOVEM.W (A7)+,D0-D1
00001098  4E73                     169              RTE
0000109A                           170               
0000109A                           171              
0000109A                           172  ; ----------------------------------------------------------------------------
0000109A                           173  SCRINIT
0000109A                           174  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
0000109A                           175  ; ENABLE DOUBLE BUFFER, ENABLED TIMED INTERRUPT.
0000109A                           176  ; INPUT    : NONE
0000109A                           177  ; OUTPUT   : NONE
0000109A                           178  ; MODIFIES : NONE
0000109A                           179  ; ----------------------------------------------------------------------------
0000109A                           180  
0000109A  48E7 C000                181              MOVEM.L D0-D1,-(A7)
0000109E                           182  
0000109E                           183              ; SET SCREEN RESOLUTION
0000109E  103C 0021                184              MOVE.B  #33,D0
000010A2  223C 028001E0            185              MOVE.L  #PANWIDTH<<16|PANHEIGH,D1
000010A8  4E4F                     186              TRAP    #15
000010AA                           187              
000010AA                           188              ; SET WINDOWED MODE
000010AA  7201                     189              MOVE.L  #1,D1
000010AC  4E4F                     190              TRAP    #15
000010AE                           191              
000010AE                           192              ; CLEAR SCREEN
000010AE  103C 000B                193              MOVE.B  #11,D0
000010B2  323C FF00                194              MOVE.W  #$FF00,D1
000010B6  4E4F                     195              TRAP    #15
000010B8                           196              
000010B8                           197              ; ENABLE DOUBLE BUFFER
000010B8  103C 005C                198              MOVE.B  #92,D0
000010BC  123C 0011                199              MOVE.B  #17,D1
000010C0  4E4F                     200              TRAP    #15
000010C2                           201              
000010C2                           202              ; ENABLE TIMED INTERRUPT
000010C2  103C 0020                203              MOVE.B  #32,D0
000010C6  123C 0006                204              MOVE.B  #6,D1
000010CA  143C 0081                205              MOVE.B  #$80|SCRINTN,D2
000010CE  7614                     206              MOVE.L  #1000/SCRFPS,D3                  ; CON 20 SE CONSIUGUEN 50 FPS
000010D0  4E4F                     207              TRAP    #15
000010D2                           208              
000010D2                           209              ; CLEAR INTERRUPT COUNTER
000010D2  4279 000020F6            210              CLR.W   (SCRINTCT)
000010D8                           211              
000010D8  4CDF 0003                212              MOVEM.L (A7)+,D0-D1
000010DC                           213              
000010DC  4E75                     214              RTS    
000010DE                           215              
000010DE                           216  ; ------------------------------------------------------------------------------
000010DE                           217  SCRTIM
000010DE                           218  ; TIMED INTERRUPT SERVICE ROUTINE
000010DE                           219  ; INPUT    : NONE
000010DE                           220  ; OUTPUT   : NONE
000010DE                           221  ; MODIFIES : NONE
000010DE                           222  ; ------------------------------------------------------------------------------
000010DE  5239 000020F6            223              ADDQ.B  #1,(SCRINTCT)
000010E4  5239 000020F7            224              ADDQ.B  #1,(SCRCYCCT)
000010EA  4E73                     225              RTE
000010EC                           226              
000010EC                           227  
000010EC                           228  ; ------------------------------------------------------------------------------
000010EC                           229  SCRPLOT
000010EC                           230  ; UPDATES DOUBLE BUFFER
000010EC                           231  ; INPUT    : NONE
000010EC                           232  ; OUTPUT   : NONE
000010EC                           233  ; MODIFIES : NONE
000010EC                           234  ; ------------------------------------------------------------------------------
000010EC                           235  
000010EC  48A7 C000                236              MOVEM.W D0-D1,-(A7)
000010F0                           237              
000010F0                           238              ; SWITCH BUFFERS
000010F0  103C 005E                239              MOVE.B  #94,D0
000010F4  4E4F                     240              TRAP    #15
000010F6                           241              
000010F6                           242              ; CLEAR HIDDEN BUFFER
000010F6  103C 000B                243              MOVE.B  #11,D0
000010FA  323C FF00                244              MOVE.W  #$FF00,D1
000010FE  4E4F                     245              TRAP    #15
00001100                           246              
00001100  4C9F 0003                247              MOVEM.W (A7)+,D0-D1
00001104                           248              
00001104  4E73                     249              RTE
00001106                           250          
00001106                           251  ; ------------------------------------------------------------------------------
00001106                           252  KBDINIT
00001106                           253  ; INIT KEYBOARD
00001106                           254  ; INPUT    : NONE
00001106                           255  ; OUTPUT   : NONE
00001106                           256  ; MODIFIES : NONE
00001106                           257  ; ------------------------------------------------------------------------------
00001106                           258  
00001106  4239 000020EF            259              CLR.B   (KBDVAL)
0000110C  4239 000020F0            260              CLR.B   (KBDEDGE)
00001112  4E75                     261              RTS
00001114                           262  
00001114                           263  ; ------------------------------------------------------------------------------
00001114                           264  KBDUPD
00001114                           265  ; UPDATE KEYBOARD INFO.  
00001114                           266  ; 7 -> PAUSE
00001114                           267  ; 6 -> FIRE 3
00001114                           268  ; 5 -> FIRE 2
00001114                           269  ; 4 -> FIRE 1
00001114                           270  ; 3 -> DOWN
00001114                           271  ; 2 -> RIGHT
00001114                           272  ; 1 -> UP
00001114                           273  ; 0 -> LEFT
00001114                           274  ; INPUT    : NONE
00001114                           275  ; OUTPUT   : NONE
00001114                           276  ; MODIFIES : NONE
00001114                           277  ; ------------------------------------------------------------------------------
00001114                           278  
00001114  48E7 C000                279              MOVEM.L D0-D1,-(A7)
00001118                           280  
00001118                           281              ; LEE ESTADO DEL TECLADO
00001118  103C 0013                282              MOVE.B  #19,D0
0000111C  223C 25262728            283              MOVE.L  #KBDLEFT<<24|KBDUP<<16|KBDRIGHT<<8|KBDDOWN,D1
00001122  4E4F                     284              TRAP    #15                  ; Lee las teclas y guarda en D1
00001124                           285  
00001124  B2BC 000000FF            286              CMP.L   #$000000FF,D1
0000112A  6700 0048                287              BEQ     DWN
0000112E  B2BC 0000FF00            288              CMP.L   #$0000FF00,D1
00001134  6700 001A                289              BEQ     DER
00001138  B2BC 00FF0000            290              CMP.L   #$00FF0000,D1
0000113E  6700 001C                291              BEQ     ARR
00001142  B2BC FF000000            292              CMP.L   #$FF000000,D1
00001148  6700 001E                293              BEQ     IZQ
0000114C                           294  
0000114C                           295              ; Si no hay pulsaciones, mantener estado
0000114C  6000 002E                296              BRA     CONTINU
00001150                           297  
00001150  33FC 0000 000020EE       298  DER:        MOVE.W  #0,(ESTDCBZ)           ; Actualiza estado a DERECHA
00001158  6000 0022                299              BRA     CONTINU
0000115C                           300              
0000115C  33FC 0001 000020EE       301  ARR:        MOVE.W  #1,(ESTDCBZ)           ; Actualiza estado a ARRIBA
00001164  6000 0016                302              BRA     CONTINU
00001168                           303  
00001168  33FC 0002 000020EE       304  IZQ:        MOVE.W  #2,(ESTDCBZ)           ; Actualiza estado a IZQUIERDA
00001170  6000 000A                305              BRA     CONTINU                    
00001174                           306  
00001174  33FC 0003 000020EE       307  DWN:        MOVE.W  #3,(ESTDCBZ)           ; Actualiza estado a ABAJO
0000117C                           308  
0000117C                           309  CONTINU:
0000117C  4CDF 0003                310              MOVEM.L (A7)+,D0-D1
00001180  4E73                     311              RTE
00001182                           312              
00001182                           313  ; RESIDUOS CODIGO ANTERIOR 
00001182                           314  
00001182                           315              ;MOVE.B  D2,(KBDVAL)
00001182                           316              
00001182                           317  
00001182                           318  
00001182                           319  
00001182                           320  
00001182                           321  ; CODIGO ANTERIOR ANTERIOR
00001182                           322  
00001182                           323  
00001182                           324  
00001182                           325  
00001182                           326  
00001182                           327  
00001182                           328  
00001182                           329  
00001182                           330  
00001182                           331  
00001182                           332  
00001182                           333  
00001182                           334  
00001182                           335  
00001182                           336  
00001182                           337  
00001182                           338  
00001182                           339  
00001182                           340  
00001182                           341  
00001182                           342  
00001182                           343  
00001182                           344  
00001182                           345  
00001182                           346  
00001182                           347  
00001182                           348  
00001182                           349  
00001182                           350  
00001182                           351  
00001182                           352  
00001182                           353  
00001182                           354  
00001182                           355  
00001182                           356  
00001182                           357  
00001182                           358  
00001182                           359  
00001182                           360  
00001182                           361  
00001182                           362  
00001182                           363  
00001182                           364  
00001182                           365  
00001182                           366  
00001182                           367  
00001182                           368  
00001182                           369  
00001182                           370  -------------------- end include --------------------
00001182                           371              INCLUDE 'LIB/UTLCODE.X68'
00001182                           372  ; =============================================================================
00001182                           373  ; UTILITY CODE
00001182                           374  ; =============================================================================
00001182                           375  
00001182                           376  ; -----------------------------------------------------------------------------
00001182                           377  UTLINIT
00001182                           378  ; INITIALIZES UTILITY CODE
00001182                           379  ; INPUT    - NONE
00001182                           380  ; OUTPUT   - NONE
00001182                           381  ; MODIFIES - NONE
00001182                           382  ; -----------------------------------------------------------------------------
00001182  48E7 C000                383              MOVEM.L D0-D1,-(A7)
00001186  103C 0008                384              MOVE.B  #8,D0
0000118A  4E4F                     385              TRAP    #15
0000118C  13C1 00001DEC            386              MOVE.B  D1,(UTLRNDIX)
00001192  4CDF 0003                387              MOVEM.L (A7)+,D0-D1
00001196  4E75                     388              RTS
00001198                           389  
00001198                           390  
00001198                           391  ; -----------------------------------------------------------------------------
00001198                           392  UTLPRINT
00001198                           393  ; PRINT SCREEN CENTERED TEXT
00001198                           394  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001198                           395  ;            D0.B SCREEN ROW TO PRINT TEXT
00001198                           396  ; OUTPUT   : D0.B NEXT ROW
00001198                           397  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001198                           398  ; -----------------------------------------------------------------------------
00001198  48E7 C0C0                399              MOVEM.L D0-D1/A0-A1,-(A7)
0000119C  4201                     400              CLR.B   D1
0000119E  2248                     401              MOVE.L  A0,A1
000011A0  4A18                     402  .LOOP       TST.B   (A0)+
000011A2  6700 0006                403              BEQ     .ENDLOOP
000011A6  5201                     404              ADDQ.B  #1,D1
000011A8  60F6                     405              BRA     .LOOP
000011AA  E209                     406  .ENDLOOP    LSR.B   #1,D1
000011AC  0401 0028                407              SUB.B   #(PANWIDTH/UTLCHRWD)/2,D1
000011B0  4401                     408              NEG.B   D1
000011B2  E141                     409              ASL.W   #8,D1
000011B4  8240                     410              OR.W    D0,D1
000011B6  103C 000B                411              MOVE.B  #11,D0
000011BA  4E4F                     412              TRAP    #15
000011BC  103C 000D                413              MOVE.B  #13,D0
000011C0  4E4F                     414              TRAP    #15
000011C2  4CDF 0303                415              MOVEM.L (A7)+,D0-D1/A0-A1
000011C6  5200                     416              ADDQ.B  #1,D0
000011C8  4E75                     417              RTS
000011CA                           418              
000011CA                           419              
000011CA                           420  
000011CA                           421  
000011CA                           422              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
000011CA                           423  
000011CA                           424  ; -----------------------------------------------------------------------------
000011CA                           425  UTLRAND
000011CA                           426  ; PROVIDES A PSEUDO-RANDOM BYTE
000011CA                           427  ; INPUT    - NONE
000011CA                           428  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000011CA                           429  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000011CA                           430  ; -----------------------------------------------------------------------------
000011CA  2F08                     431              MOVE.L  A0,-(A7)
000011CC  41F9 000011E8            432              LEA     .RANDVEC,A0
000011D2  4280                     433              CLR.L   D0
000011D4  1039 00001DEC            434              MOVE.B  (UTLRNDIX),D0
000011DA  1030 0800                435              MOVE.B  (A0,D0.L),D0
000011DE  5239 00001DEC            436              ADDQ.B  #1,(UTLRNDIX)
000011E4  205F                     437              MOVE.L  (A7)+,A0
000011E6  4E75                     438              RTS
000011E8                           439  
000011E8                           440  
000011E8= A2 EE 9A 0C F5 24 ...    441  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000011F0= 2A A3 51 26 E0 AC ...    442              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000011F8= 75 51 CA FD 33 EB ...    443              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001200= 60 CC E7 B8 9A EB ...    444              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001208= 1D 76 B5 95 B0 89 ...    445              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001210= 39 15 48 C9 6E CA ...    446              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001218= 43 E7 E2 7C 37 25 ...    447              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001220= E9 94 CE E9 E4 52 ...    448              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001228= 37 6D 9A 84 A2 28 ...    449              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001230= 19 E2 C6 77 80 D4 ...    450              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001238= 0A 5A 32 67 33 C2 ...    451              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001240= 59 80 DC 0E 57 FC ...    452              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001248= 8A AB BC F7 07 4D ...    453              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001250= EF D5 77 6E 1E BB ...    454              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001258= D6 E0 2A 8F BD 28 ...    455              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001260= 13 4F 66 EC 0A 64 ...    456              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001268= 56 52 9A 16 9B 90 ...    457              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001270= 06 8A A4 F7 01 DA ...    458              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001278= F2 E7 77 28 B1 76 ...    459              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001280= A4 42 E3 81 B1 67 ...    460              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001288= BF CE FA 16 BF 38 ...    461              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001290= D1 8B 50 0C 5F 49 ...    462              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001298= DE 4C 14 A2 40 DC ...    463              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
000012A0= B6 9B 0A 38 5D AB ...    464              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
000012A8= E2 1B DD 75 15 82 ...    465              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000012B0= 8A 26 51 30 9F 47 ...    466              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000012B8= 1E 8A BB 71 C6 6E ...    467              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000012C0= 9F 47 E5 34 94 27 ...    468              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000012C8= 7D 06 D6 BA 30 0F ...    469              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000012D0= EC 7F 7E 03 CF 2D ...    470              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000012D8= 94 5B 23 F2 8B CD ...    471              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000012E0= 74 33 EC B9 0F D5 ...    472              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000012E8                           473  
000012E8                           474  
000012E8                           475  -------------------- end include --------------------
000012E8                           476              INCLUDE 'LIB/UTLCONST.X68'
000012E8                           477  ; ==============================================================================
000012E8                           478  ; UTIL CONSTANTS
000012E8                           479  ; ==============================================================================
000012E8                           480  
000012E8  =00000008                481  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
000012E8  =00000008                482  -------------------- end include --------------------
000012E8                           483              INCLUDE 'HEADSRP.X68'
000012E8                           484  
000012E8                           485  ; ------------------------------------------------------------------------------
000012E8                           486  HEADINIT
000012E8                           487  ; INICIALIZAR CABEZA.
000012E8                           488  ; INPUT    : NONE 
000012E8                           489  ; OUTPUT   : NONE
000012E8                           490  ; MODIFIES : NONE
000012E8                           491  ; ------------------------------------------------------------------------------
000012E8  33FC 0140 00001DCE       492              MOVE.W  #PANWIDTH/2,(CBZPOSX)
000012F0  33FC 00F0 00001DD0       493              MOVE.W  #PANHEIGH/2,(CBZPOSY)
000012F8  4279 00001DE2            494              CLR.W   (SRPVEL)
000012FE                           495              ;ADD.W   #20,(CBZVEL)
000012FE  4279 000020EE            496              CLR.W   (ESTDCBZ)
00001304  33FC 0000 000020EE       497              MOVE.W  #0,(ESTDCBZ)
0000130C  4E75                     498              RTS
0000130E                           499              
0000130E                           500  ; ------------------------------------------------------------------------------
0000130E                           501  HEADUPD
0000130E                           502  ; ACTUALIZAR CABEZA.
0000130E                           503  ; INPUT    : NONE 
0000130E                           504  ; OUTPUT   : NONE
0000130E                           505  ; MODIFIES : NONE
0000130E                           506  ; ------------------------------------------------------------------------------
0000130E                           507  
0000130E  48A7 E000                508              MOVEM.W D0-D2,-(A7)
00001312                           509  
00001312                           510              ; Marcar celda actual como vacía
00001312  3239 00001DCE            511              MOVE.W  (CBZPOSX),D1
00001318  3439 00001DD0            512              MOVE.W  (CBZPOSY),D2
0000131E  4EB9 0000183E            513              JSR     CINDMTRZ
00001324  4EB9 0000188E            514              JSR     MCLDVCIA
0000132A                           515              
0000132A                           516              
0000132A                           517              ; Actualiza la posición de la cabeza según ESTDCBZ
0000132A  3039 000020EE            518              MOVE.W  (ESTDCBZ),D0
00001330  B07C 0000                519              CMP.W   #0,D0
00001334  6700 001E                520              BEQ     SIGDER
00001338  B07C 0001                521              CMP.W   #1,D0
0000133C  6700 0022                522              BEQ     SIGARR
00001340  B07C 0002                523              CMP.W   #2,D0
00001344  6700 0026                524              BEQ     SIGIZQ
00001348  B07C 0003                525              CMP.W   #3,D0
0000134C  6700 002A                526              BEQ     SIGABA
00001350                           527  
00001350                           528              ; Si no hay dirección válida, sale
00001350  6000 0078                529              BRA     FIN
00001354                           530  
00001354                           531  SIGDER:
00001354  0679 0014 00001DCE       532              ADD.W   #CBZVEL,(CBZPOSX)
0000135C  6000 0022                533              BRA     CHKCOL
00001360                           534  
00001360                           535  SIGARR:
00001360  0479 0014 00001DD0       536              SUB.W   #CBZVEL,(CBZPOSY)
00001368  6000 0016                537              BRA     CHKCOL
0000136C                           538  
0000136C                           539  SIGIZQ:
0000136C  0479 0014 00001DCE       540              SUB.W   #CBZVEL,(CBZPOSX)
00001374  6000 000A                541              BRA     CHKCOL
00001378                           542  
00001378                           543  SIGABA:
00001378  0679 0014 00001DD0       544              ADD.W   #CBZVEL,(CBZPOSY)
00001380                           545              
00001380                           546  CHKCOL:
00001380                           547              ; Verifica la colisión con la manzana
00001380  3239 00001DCE            548              MOVE.W  (CBZPOSX),D1
00001386  3439 00001DD0            549              MOVE.W  (CBZPOSY),D2
0000138C  B279 00001DCA            550              CMP.W   (MNZPOSX),D1
00001392  6600 001E                551              BNE     NOCOL
00001396  B479 00001DCC            552              CMP.W   (MNZPOSY),D2
0000139C  6600 0014                553              BNE     NOCOL
000013A0                           554              
000013A0                           555              ; Colisión detectada
000013A0  4EB9 00001626            556              JSR     APPLEUPD
000013A6  4EB9 0000171C            557              JSR     SCOUPD
000013AC  1E3C 0000                558              MOVE.B  #SNDEAT,D7
000013B0  4E42                     559              TRAP    #SNDPLTN
000013B2                           560  
000013B2                           561  NOCOL:
000013B2                           562              ; Convierte la posición nueva a índice
000013B2  3239 00001DCE            563              MOVE.W  (CBZPOSX),D1
000013B8  3439 00001DD0            564              MOVE.W  (CBZPOSY),D2
000013BE  4EB9 0000183E            565              JSR     CINDMTRZ
000013C4  4EB9 00001878            566              JSR     CBZOCPD                 ; Marca la celda como ocupada
000013CA                           567  
000013CA                           568  
000013CA                           569  FIN:
000013CA  4C9F 0007                570              MOVEM.W (A7)+,D0-D2
000013CE                           571  
000013CE  4E75                     572              RTS
000013D0                           573              
000013D0                           574  ; ------------------------------------------------------------------------------
000013D0                           575  HEADPLOT
000013D0                           576  ; DIBUJAR CABEZA.
000013D0                           577  ; INPUT    : NONE 
000013D0                           578  ; OUTPUT   : NONE
000013D0                           579  ; MODIFIES : NONE
000013D0                           580  ; ------------------------------------------------------------------------------
000013D0                           581                         
000013D0  3F00                     582              MOVE.W  D0,-(A7)               ; GUARDAMOS D0
000013D2  3003                     583              MOVE.W  D3,D0                  ; PONEMOS EL INDICE DE LA CELDA EN D0 PARA CALCULAR SUS COORDENADAS
000013D4  4EB9 000018E6            584              JSR     CNVICOOR
000013DA  2F01                     585              MOVE.L  D1,-(A7)
000013DC                           586              
000013DC                           587              ; SET COLOR DEL CONTORNO CABEZA
000013DC  103C 0050                588              MOVE.B  #80,D0
000013E0  223C 0000FF00            589              MOVE.L  #CBZPCOL,D1
000013E6  4E4F                     590              TRAP    #15
000013E8                           591              
000013E8                           592              ; SET COLOR DEL RELLENO CABEZA
000013E8  103C 0051                593              MOVE.B  #81,D0
000013EC  223C 0000AA00            594              MOVE.L  #CBZFCOL,D1
000013F2  4E4F                     595              TRAP    #15
000013F4                           596              
000013F4                           597              ; DIBUJAR CABEZA
000013F4  103C 0057                598              MOVE.B  #87,D0
000013F8  221F                     599              MOVE.L  (A7)+,D1
000013FA  3F03                     600              MOVE.W  D3,-(A7)
000013FC  3601                     601              MOVE.W  D1,D3
000013FE  0643 0014                602              ADD.W   #CBZWIDTH,D3
00001402  3802                     603              MOVE.W  D2,D4
00001404  0644 0014                604              ADD.W   #CBZHEIGH,D4
00001408  4E4F                     605              TRAP    #15
0000140A                           606              
0000140A  2F01                     607              MOVE.L  D1,-(A7)
0000140C                           608              
0000140C                           609              ; SET COLOR DEL CONTORNO OJO
0000140C  103C 0050                610              MOVE.B  #80,D0
00001410  7200                     611              MOVE.L  #OJOPCOL,D1
00001412  4E4F                     612              TRAP    #15
00001414                           613              
00001414                           614              ; SET COLOR DEL RELLENO OJO
00001414  103C 0051                615              MOVE.B  #81,D0
00001418  223C 00FFFFFF            616              MOVE.L  #OJOFCOL,D1
0000141E  4E4F                     617              TRAP    #15
00001420                           618              
00001420                           619              ; DIBUJAR OJO
00001420  103C 0058                620              MOVE.B  #88,D0
00001424  221F                     621              MOVE.L  (A7)+,D1
00001426  2F01                     622              MOVE.L  D1,-(A7)
00001428  2F02                     623              MOVE.L  D2,-(A7)
0000142A  5A41                     624              ADD.W   #OJOWIDTH/2,D1            
0000142C  3601                     625              MOVE.W  D1,D3
0000142E  0643 000A                626              ADD.W   #OJOWIDTH,D3
00001432  5A42                     627              ADD.W   #OJOHEIGH/2,D2
00001434  3802                     628              MOVE.W  D2,D4
00001436  0644 000A                629              ADD.W   #OJOHEIGH,D4
0000143A  4E4F                     630              TRAP    #15                     ; DIBUJAMOS EL PRIMER OJO
0000143C                           631              
0000143C                           632  
0000143C                           633              ; DEFINIR COORDENADAS IRIS
0000143C  241F                     634              MOVE.L  (A7)+,D2
0000143E  221F                     635              MOVE.L  (A7)+,D1
00001440  0641 000A                636              ADD.W   #OJOWIDTH,D1
00001444  0642 000A                637              ADD.W   #OJOHEIGH,D2
00001448  103C 0052                638              MOVE.B  #82,D0
0000144C  4E4F                     639              TRAP    #15                     ; DIBUJAMOS EL PRIMER IRIS
0000144E                           640              
0000144E  361F                     641              MOVE.W  (A7)+,D3
00001450  301F                     642              MOVE.W  (A7)+,D0
00001452                           643  
00001452  4E75                     644              RTS
00001454                           645  
00001454                           646  
00001454                           647  
00001454                           648  
00001454                           649  
00001454                           650  
00001454                           651  
00001454                           652  
00001454                           653  
00001454                           654  
00001454                           655  
00001454                           656  
00001454                           657  
00001454                           658  
00001454                           659  
00001454                           660  
00001454                           661  
00001454                           662  
00001454                           663  
00001454                           664  
00001454                           665  
00001454                           666  
00001454                           667  
00001454                           668  
00001454                           669  
00001454                           670  
00001454                           671  
00001454                           672  
00001454                           673  
00001454                           674  
00001454                           675  
00001454                           676  
00001454                           677  
00001454                           678  
00001454                           679  
00001454                           680  
00001454                           681  
00001454                           682  
00001454                           683  
00001454                           684  
00001454                           685  
00001454                           686  -------------------- end include --------------------
00001454                           687              INCLUDE 'SEGSRP.X68'
00001454                           688  
00001454                           689  ; ------------------------------------------------------------------------------
00001454                           690  SEGINIT
00001454                           691  ; INICIALIZAR SEGMENTO.
00001454                           692  ; INPUT    : NONE 
00001454                           693  ; OUTPUT   : NONE
00001454                           694  ; MODIFIES : NONE
00001454                           695  ; ------------------------------------------------------------------------------
00001454  33FC 012C 00001DDA       696              MOVE.W  #(PANWIDTH/2)-CBZWIDTH,(SGMPOSX)
0000145C  33FC 00F0 00001DDC       697              MOVE.W  #PANHEIGH/2,(SGMPOSY)
00001464  33F9 00001DDA 00001DDE   698              MOVE.W  (SGMPOSX),(SGMPOSX2)
0000146E  33F9 00001DDC 00001DE0   699              MOVE.W  (SGMPOSY),(SGMPOSY2)
00001478  0479 0014 00001DDE       700              SUB.W   #SGMWIDTH,(SGMPOSX2)
00001480  4E75                     701              RTS
00001482                           702              
00001482                           703  ; ------------------------------------------------------------------------------
00001482                           704  SEGUPD
00001482                           705  ; ACTUALIZAR SEGMENTO.
00001482                           706  ; INPUT    : NONE 
00001482                           707  ; OUTPUT   : NONE
00001482                           708  ; MODIFIES : NONE
00001482                           709  ; ------------------------------------------------------------------------------
00001482                           710  
00001482  48A7 6000                711              MOVEM.W D1-D2,-(A7)
00001486                           712              
00001486                           713              ; Marcar posición anterior del segmento como vacía
00001486  3239 00001DDA            714              MOVE.W  (SGMPOSX),D1             ; Cargar posición X actual del segmento2
0000148C  3439 00001DDC            715              MOVE.W  (SGMPOSY),D2             ; Cargar posición Y actual del segmento2
00001492  4EB9 0000183E            716              JSR     CINDMTRZ                ; Obtener índice de celda en D0
00001498  4EB9 0000188E            717              JSR     MCLDVCIA                ; Marcar celda como vacía
0000149E                           718              
0000149E                           719              ; Marcar posición anterior del segmento como vacía
0000149E  3239 00001DDE            720              MOVE.W  (SGMPOSX2),D1             ; Cargar posición X actual del segmento2
000014A4  3439 00001DE0            721              MOVE.W  (SGMPOSY2),D2             ; Cargar posición Y actual del segmento2
000014AA  4EB9 0000183E            722              JSR     CINDMTRZ                ; Obtener índice de celda en D0
000014B0  4EB9 0000188E            723              JSR     MCLDVCIA                ; Marcar celda como vacía
000014B6                           724              
000014B6                           725              ; Actualizar posición del segmento para seguir a la cabeza
000014B6  33F9 00001DDA 00001DDE   726              MOVE.W  (SGMPOSX),(SGMPOSX2)    ; MARCAMOS LOS SEGMENTOS COMO SEGUNDA COORDENADA X
000014C0  33F9 00001DDC 00001DE0   727              MOVE.W  (SGMPOSY),(SGMPOSY2)    ; MARCAMOS LOS SEGMENTOS COMO SEGUNDA COORDENADA Y
000014CA  33F9 00001DCE 00001DDA   728              MOVE.W  (CBZPOSX),(SGMPOSX)        ; Actualizar X del segmento con la X de la cabeza
000014D4  33F9 00001DD0 00001DDC   729              MOVE.W  (CBZPOSY),(SGMPOSY)        ; Actualizar Y del segmento con la Y de la cabeza
000014DE                           730  
000014DE                           731              ; Marcar nueva posición del segmento como ocupada
000014DE  3239 00001DDA            732              MOVE.W  (SGMPOSX),D1             ; Cargar nueva posición X
000014E4  3439 00001DDC            733              MOVE.W  (SGMPOSY),D2             ; Cargar nueva posición Y
000014EA  4EB9 0000183E            734              JSR     CINDMTRZ                ; Obtener índice de celda en D0
000014F0  4EB9 000018A4            735              JSR     SGMOCPD                 ; Marcar celda como ocupada por segmento
000014F6                           736              
000014F6  3239 00001DDE            737              MOVE.W  (SGMPOSX2),D1             ; Cargar nueva posición X DEL SEGMENTO 2
000014FC  3439 00001DE0            738              MOVE.W  (SGMPOSY2),D2             ; Cargar nueva posición Y DEL SEGMENTO 2
00001502  4EB9 0000183E            739              JSR     CINDMTRZ                ; Obtener índice de celda en D0
00001508  4EB9 000018A4            740              JSR     SGMOCPD                 ; Marcar celda como ocupada por segmento
0000150E                           741              
0000150E  4C9F 0006                742              MOVEM.W (A7)+,D1-D2            
00001512  4E75                     743              RTS
00001514                           744  ;CODIGO ANTIGUO
00001514                           745              
00001514                           746              
00001514                           747              
00001514                           748  ; ------------------------------------------------------------------------------
00001514                           749  SEGPLOT
00001514                           750  ; DIBUJAR SEGMENTO.
00001514                           751  ; INPUT    : NONE 
00001514                           752  ; OUTPUT   : NONE
00001514                           753  ; MODIFIES : NONE
00001514                           754  ; ------------------------------------------------------------------------------
00001514  3F00                     755              MOVE.W  D0,-(A7)
00001516  3003                     756              MOVE.W  D3,D0
00001518  4EB9 000018E6            757              JSR     CNVICOOR
0000151E  2F01                     758              MOVE.L  D1,-(A7)
00001520                           759              
00001520  103C 0050                760              MOVE.B  #80,D0
00001524  223C 0000FF00            761              MOVE.L  #SGMPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DEL SEGMENTO
0000152A  4E4F                     762              TRAP    #15
0000152C                           763              
0000152C  103C 0051                764              MOVE.B  #81,D0
00001530  223C 0000AA00            765              MOVE.L  #SGMFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DEL SEGMENTO
00001536  4E4F                     766              TRAP    #15
00001538                           767              
00001538  103C 0057                768              MOVE.B  #87,D0
0000153C  221F                     769              MOVE.L  (A7)+,D1
0000153E  3F03                     770              MOVE.W  D3,-(A7)
00001540  3601                     771              MOVE.W  D1,D3
00001542  0643 0014                772              ADD.W   #SIZECLDA,D3
00001546  3802                     773              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001548  0644 0014                774              ADD.W   #SIZECLDA,D4
0000154C  4E4F                     775              TRAP    #15                     
0000154E                           776                          
0000154E  361F                     777              MOVE.W  (A7)+,D3  
00001550  301F                     778              MOVE.W  (A7)+,D0
00001552                           779  
00001552  4E75                     780              RTS
00001554                           781  
00001554                           782  -------------------- end include --------------------
00001554                           783              INCLUDE 'TAILSRP.X68'
00001554                           784     
00001554                           785  ; ------------------------------------------------------------------------------
00001554                           786  TAILINIT
00001554                           787  ; INICIALIZAR COLA.
00001554                           788  ; INPUT    : NONE 
00001554                           789  ; OUTPUT   : NONE
00001554                           790  ; MODIFIES : NONE
00001554                           791  ; ------------------------------------------------------------------------------
00001554                           792  
00001554  33FC 011D 00001DD6       793              MOVE.W  #(PANWIDTH/2)-CBZWIDTH-SGMWIDTH+(COLWIDTH/2),(COLPOSX)
0000155C  33FC 00F0 00001DD8       794              MOVE.W  #(PANHEIGH/2),(COLPOSY)
00001564                           795              
00001564  4E75                     796              RTS
00001566                           797              
00001566                           798              
00001566                           799  ; ------------------------------------------------------------------------------
00001566                           800  TAILUPD
00001566                           801  ; ACTUALIZAR COLA.
00001566                           802  ; INPUT    : NONE 
00001566                           803  ; OUTPUT   : NONE
00001566                           804  ; MODIFIES : NONE
00001566                           805  ; ------------------------------------------------------------------------------
00001566  48A7 6000                806              MOVEM.W D1-D2,-(A7)
0000156A                           807              
0000156A                           808              ; Marca la posición actual de la cola como vacía
0000156A  3239 00001DD6            809              MOVE.W  (COLPOSX),D1
00001570  3439 00001DD8            810              MOVE.W  (COLPOSY),D2
00001576  4EB9 0000183E            811              JSR     CINDMTRZ
0000157C  4EB9 0000188E            812              JSR     MCLDVCIA
00001582                           813              ; Actualiza la posición de la cola para seguir al último segmento
00001582  33F9 00001DDE 00001DD6   814              MOVE.W  (SGMPOSX2),(COLPOSX)
0000158C  33F9 00001DE0 00001DD8   815              MOVE.W  (SGMPOSY2),(COLPOSY)    ; MARCAMOS LA COOORDENADA DE LA COLA COMO COORDENADA DEL SEGMENTO 2
00001596                           816              ; Marca la nueva posición como cola
00001596  3239 00001DD6            817              MOVE.W  (COLPOSX),D1
0000159C  3439 00001DD8            818              MOVE.W  (COLPOSY),D2
000015A2  4EB9 0000183E            819              JSR     CINDMTRZ
000015A8  4EB9 000018BA            820              JSR     COLOCPD
000015AE                           821  
000015AE                           822  FINUPD
000015AE  4C9F 0006                823              MOVEM.W (A7)+,D1-D2
000015B2  4E75                     824              RTS
000015B4                           825              
000015B4                           826  ; ------------------------------------------------------------------------------
000015B4                           827  TAILPLOT
000015B4                           828  ; DIBUJAR COLA
000015B4                           829  ; INPUT    : NONE 
000015B4                           830  ; OUTPUT   : NONE
000015B4                           831  ; MODIFIES : NONE
000015B4                           832  ; ------------------------------------------------------------------------------
000015B4                           833  
000015B4  3F00                     834              MOVE.W  D0,-(A7)
000015B6  3003                     835              MOVE.W  D3,D0
000015B8  4EB9 000018E6            836              JSR     CNVICOOR
000015BE  2F01                     837              MOVE.L  D1,-(A7)
000015C0                           838              
000015C0  103C 0050                839              MOVE.B  #80,D0
000015C4  223C 0000FF00            840              MOVE.L  #COLPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA COLA
000015CA  4E4F                     841              TRAP    #15
000015CC                           842              
000015CC  103C 0051                843              MOVE.B  #81,D0
000015D0  223C 0000AA00            844              MOVE.L  #COLFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA COLA
000015D6  4E4F                     845              TRAP    #15
000015D8                           846              
000015D8  103C 0057                847              MOVE.B  #87,D0
000015DC  221F                     848              MOVE.L  (A7)+,D1
000015DE  3F03                     849              MOVE.W  D3,-(A7)
000015E0  3601                     850              MOVE.W  D1,D3
000015E2  0643 0014                851              ADD.W   #SIZECLDA,D3
000015E6  3802                     852              MOVE.W  D2,D4                    
000015E8  0644 0014                853              ADD.W   #SIZECLDA,D4
000015EC  4E4F                     854              TRAP    #15                    ; DIBUJAMOS EL CUADRADO 
000015EE                           855                          
000015EE  361F                     856              MOVE.W  (A7)+,D3  
000015F0  301F                     857              MOVE.W  (A7)+,D0
000015F2                           858  
000015F2  4E75                     859              RTS
000015F4                           860  
000015F4                           861  
000015F4                           862  -------------------- end include --------------------
000015F4                           863              INCLUDE 'APPLE.X68'
000015F4                           864     
000015F4                           865  ; ------------------------------------------------------------------------------
000015F4                           866  APPLEINIT
000015F4                           867  ; Inicializa la manzana en una posición aleatoria
000015F4                           868  ; INPUT    : NONE 
000015F4                           869  ; OUTPUT   : NONE
000015F4                           870  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
000015F4                           871  ; ------------------------------------------------------------------------------
000015F4                           872  
000015F4                           873              ; Llama a la función para generar la posición aleatoria
000015F4  4EB9 000016E2            874              JSR     GENPOSMNZ
000015FA                           875  
000015FA                           876              ; Convierte las coordenadas de la manzana a índice de la matriz
000015FA  4EB9 0000183E            877              JSR     CINDMTRZ
00001600                           878  
00001600                           879              ; Verifica si la celda está ocupada o libre
00001600                           880  CHECK:
00001600  4EB9 00001922            881              JSR     CHECKCLD
00001606  6700 0010                882              BEQ     MARKMNZ                  ; Si está libre
0000160A                           883  
0000160A                           884              ; Si la celda está ocupada
0000160A  4EB9 000016E2            885              JSR     GENPOSMNZ                ; Genera una nueva posición
00001610  4EB9 0000183E            886              JSR     CINDMTRZ                 ; Convierte las nuevas coordenadas
00001616  60E8                     887              BRA     CHECK                    ; Repite la comprobación
00001618                           888  
00001618                           889  MARKMNZ:
00001618                           890              ; Marca la celda como ocupada con la manzana (estado 4)
00001618  4EB9 000018D0            891              JSR     MNZOCPD
0000161E                           892  
0000161E                           893              ; Dibuja la manzana en la pantalla
0000161E  4EB9 00001664            894              JSR     APPLEPLOT
00001624                           895  
00001624  4E75                     896              RTS
00001626                           897  
00001626                           898  ; ------------------------------------------------------------------------------
00001626                           899  APPLEUPD
00001626                           900  ; Actualiza la posición de la manzana cuando la serpiente come
00001626                           901  ; INPUT    : NONE 
00001626                           902  ; OUTPUT   : NONE
00001626                           903  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
00001626                           904  ; ------------------------------------------------------------------------------
00001626                           905  
00001626                           906  
00001626                           907              ; Convierte las coordenadas actuales de la manzana a índice de la matriz
00001626  4EB9 0000183E            908              JSR     CINDMTRZ
0000162C                           909  
0000162C                           910              ; Marca la celda anterior como vacía
0000162C  4EB9 0000188E            911              JSR     MCLDVCIA
00001632                           912  
00001632                           913              ; Llama a la función para generar una nueva posición aleatoria
00001632  4EB9 000016E2            914              JSR     GENPOSMNZ
00001638                           915  
00001638                           916              ; Convierte las nuevas coordenadas de la manzana a índice de la matriz
00001638  4EB9 0000183E            917              JSR     CINDMTRZ
0000163E                           918  
0000163E                           919  CHCKUPDT:
0000163E  4EB9 00001922            920              JSR     CHECKCLD             ; Verifica si la celda está libre
00001644  6700 0010                921              BEQ     NEWMNZ               ; Si está libre
00001648                           922  
00001648                           923              ; Si la celda está ocupada
00001648  4EB9 000016E2            924              JSR     GENPOSMNZ            ; Genera una nueva posición
0000164E  4EB9 0000183E            925              JSR     CINDMTRZ             ; Convierte las nuevas coordenadas
00001654  60E8                     926              BRA     CHCKUPDT             ; Repite la comprobación
00001656                           927  
00001656                           928  NEWMNZ:
00001656                           929              ; Marca la celda como ocupada con la manzana (estado 4)
00001656  4EB9 000018D0            930              JSR     MNZOCPD
0000165C                           931  
0000165C                           932              ; Dibuja la nueva manzana en la pantalla
0000165C  4EB9 00001664            933              JSR     APPLEPLOT
00001662                           934  
00001662  4E75                     935              RTS
00001664                           936              
00001664                           937  ; ------------------------------------------------------------------------------
00001664                           938  APPLEPLOT
00001664                           939  ; Dibuja la manzana
00001664                           940  ; INPUT    : NONE 
00001664                           941  ; OUTPUT   : NONE
00001664                           942  ; MODIFIES : NONE
00001664                           943  ; ------------------------------------------------------------------------------
00001664  3F00                     944              MOVE.W  D0,-(A7)
00001666  3003                     945              MOVE.W  D3,D0
00001668  4EB9 000018E6            946              JSR     CNVICOOR
0000166E  2F01                     947              MOVE.L  D1,-(A7)                ; PRIMERO DEBEMOS DIBUJAR EL FONDO Y LUEGO LA MANZANA
00001670                           948              
00001670  103C 0050                949              MOVE.B  #80,D0
00001674  223C 0090EE90            950              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
0000167A  4E4F                     951              TRAP    #15
0000167C                           952              
0000167C  103C 0051                953              MOVE.B  #81,D0
00001680  223C 0090EE90            954              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001686  4E4F                     955              TRAP    #15
00001688                           956              
00001688  103C 0057                957              MOVE.B  #87,D0
0000168C  221F                     958              MOVE.L  (A7)+,D1
0000168E  3F03                     959              MOVE.W  D3,-(A7)
00001690  3601                     960              MOVE.W  D1,D3
00001692  0643 0014                961              ADD.W   #SIZECLDA,D3
00001696  3802                     962              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001698  0644 0014                963              ADD.W   #SIZECLDA,D4
0000169C  4E4F                     964              TRAP    #15                     
0000169E                           965                          
0000169E  361F                     966              MOVE.W  (A7)+,D3  
000016A0  301F                     967              MOVE.W  (A7)+,D0
000016A2                           968  
000016A2  3F00                     969              MOVE.W  D0,-(A7)
000016A4  3003                     970              MOVE.W  D3,D0
000016A6  4EB9 000018E6            971              JSR     CNVICOOR
000016AC  2F01                     972              MOVE.L  D1,-(A7)
000016AE                           973              
000016AE  103C 0050                974              MOVE.B  #80,D0
000016B2  223C 0000AAFF            975              MOVE.L  #MNZPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA MANZANA
000016B8  4E4F                     976              TRAP    #15
000016BA                           977              
000016BA  103C 0051                978              MOVE.B  #81,D0
000016BE  223C 000000FF            979              MOVE.L  #MNZFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA MANZANA
000016C4  4E4F                     980              TRAP    #15
000016C6                           981              
000016C6  103C 0058                982              MOVE.B  #88,D0
000016CA  221F                     983              MOVE.L  (A7)+,D1
000016CC  3F03                     984              MOVE.W  D3,-(A7)
000016CE  3601                     985              MOVE.W  D1,D3
000016D0  0643 0014                986              ADD.W   #SIZECLDA,D3
000016D4  3802                     987              MOVE.W  D2,D4                    ; DIBUJAMOS EL CIRCULO
000016D6  0644 0014                988              ADD.W   #SIZECLDA,D4
000016DA  4E4F                     989              TRAP    #15                     
000016DC                           990                          
000016DC  361F                     991              MOVE.W  (A7)+,D3  
000016DE  301F                     992              MOVE.W  (A7)+,D0
000016E0                           993  
000016E0                           994  
000016E0  4E75                     995              RTS
000016E2                           996  ; ----------------------------------------------------------------------------
000016E2                           997  GENPOSMNZ
000016E2                           998  ; Genera una posición aleatoria para la manzana
000016E2                           999  ; INPUT: NONE
000016E2                          1000  ; OUTPUT:
000016E2                          1001  ; MODIFIES: MNZPOSX, MNZPOSY
000016E2                          1002  ; ----------------------------------------------------------------------------
000016E2                          1003  
000016E2  48E7 8000               1004              MOVEM.L D0,-(A7)
000016E6                          1005  
000016E6                          1006              ; Genera la coordenada X aleatoria
000016E6  4EB8 11CA               1007              JSR     UTLRAND
000016EA  0240 001F               1008              ANDI.W  #NUMCLMNS-1, D0       ; Asegura que esté en [0, NUMCLMNS-1]
000016EE  C0FC 0014               1009              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
000016F2  3200                    1010              MOVE.W  D0,D1
000016F4  33C0 00001DCA           1011              MOVE.W  D0, MNZPOSX           ; Guarda la coordenada X generada
000016FA                          1012              
000016FA                          1013              ; Generar coordenada Y aleatoria
000016FA  4EB8 11CA               1014              JSR     UTLRAND
000016FE  0240 0017               1015              ANDI.W  #NUMFILAS-1, D0       ; Asegura que esté en el rango [0, NUMFILAS-1]
00001702  C0FC 0014               1016              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
00001706  3400                    1017              MOVE.W  D0,D2
00001708  33C0 00001DCC           1018              MOVE.W  D0, MNZPOSY           ; Guarda la coordenada Y generada
0000170E                          1019              
0000170E  4CDF 0001               1020              MOVEM.L (A7)+,D0
00001712  4E75                    1021              RTS 
00001714                          1022  
00001714                          1023  
00001714                          1024  
00001714                          1025  
00001714                          1026  
00001714                          1027  
00001714                          1028  -------------------- end include --------------------
00001714                          1029              INCLUDE 'SCORE.X68'
00001714                          1030     
00001714                          1031  ; ------------------------------------------------------------------------------
00001714                          1032  SCOINIT
00001714                          1033  ; INICIALIZAR MARCADOR.
00001714                          1034  ; INPUT    : NONE 
00001714                          1035  ; OUTPUT   : NONE
00001714                          1036  ; MODIFIES : NONE
00001714                          1037  ; ------------------------------------------------------------------------------
00001714  4279 00001DE4           1038              CLR.W   (JGOPNTS)
0000171A  4E75                    1039              RTS
0000171C                          1040              
0000171C                          1041  ; ------------------------------------------------------------------------------
0000171C                          1042  SCOUPD
0000171C                          1043  ; ACTUALIZAR MARCADOR.
0000171C                          1044  ; INPUT    : NONE 
0000171C                          1045  ; OUTPUT   : NONE
0000171C                          1046  ; MODIFIES : NONE
0000171C                          1047  ; ------------------------------------------------------------------------------
0000171C                          1048              
0000171C  48E7 8000               1049              MOVEM.L D0,-(A7)
00001720                          1050              
00001720                          1051              ;Incrementa el marcador
00001720  3039 00001DE4           1052              MOVE.W  (JGOPNTS),D0
00001726  0640 0019               1053              ADD.W  #25,D0
0000172A  33C0 00001DE4           1054              MOVE.W  D0,(JGOPNTS)
00001730                          1055              
00001730  4CDF 0001               1056              MOVEM.L (A7)+,D0
00001734                          1057  
00001734  4E75                    1058              RTS
00001736                          1059              
00001736                          1060  ; ------------------------------------------------------------------------------
00001736                          1061  SCOPLOT
00001736                          1062  ; DIBUJAR MARCADOR.
00001736                          1063  ; INPUT    : NONE 
00001736                          1064  ; OUTPUT   : NONE
00001736                          1065  ; MODIFIES : NONE
00001736                          1066  ; ------------------------------------------------------------------------------
00001736  48E7 C040               1067             MOVEM.L  D0-D1/A1,-(A7)
0000173A                          1068             ; SET COLOR DE FONDO
0000173A  103C 0051               1069             MOVE.B   #81,D0
0000173E  223C 0090EE90           1070             MOVE.L   #COLFND,D1
00001744  4E4F                    1071             TRAP     #15
00001746                          1072             
00001746                          1073             
00001746                          1074             
00001746                          1075             ; DIBUJAR LINEA DE PUNTUACIÓN
00001746  43F9 00001760           1076              LEA     .TXT1,A1
0000174C  4281                    1077              CLR.L   D1
0000174E  3239 00001DE4           1078              MOVE.W  (JGOPNTS),D1
00001754  103C 0011               1079              MOVE.B  #17,D0
00001758  4E4F                    1080              TRAP    #15
0000175A                          1081              
0000175A  4CDF 0203               1082              MOVEM.L (A7)+,D0-D1/A1
0000175E  4E75                    1083              RTS
00001760                          1084  
00001760                          1085  
00001760= 50 55 4E 54 4F 53 ...   1086  .TXT1       DC.B    'PUNTOS : ',0
0000176A                          1087  
0000176A                          1088  
0000176A                          1089  
0000176A                          1090  
0000176A                          1091  -------------------- end include --------------------
0000176A                          1092              INCLUDE 'GAME.X68'
0000176A                          1093  ; ==============================================================================
0000176A                          1094  ; GAME MANAGEMENT
0000176A                          1095  ; ==============================================================================
0000176A                          1096  
0000176A                          1097  ; ------------------------------------------------------------------------------
0000176A                          1098  GAMINIT
0000176A                          1099  ; INITIALIZES GAME.
0000176A                          1100  ; INPUT    : NONE
0000176A                          1101  ; OUTPUT   : NONE
0000176A                          1102  ; MODIFIES : NONE
0000176A                          1103  ; ------------------------------------------------------------------------------
0000176A  4EB9 000017AC           1104              JSR     MTZINIT
00001770  4EB8 12E8               1105              JSR     HEADINIT
00001774  4EB8 1454               1106              JSR     SEGINIT
00001778  4EB8 1554               1107              JSR     TAILINIT
0000177C  4EB8 1714               1108              JSR     SCOINIT
00001780  6000 FE72               1109              BRA     APPLEINIT
00001784                          1110  
00001784                          1111  ; ------------------------------------------------------------------------------
00001784                          1112  GAMUPD
00001784                          1113  ; UPDATES THE GAME
00001784                          1114  ; INPUT    : NONE
00001784                          1115  ; OUTPUT   : NONE
00001784                          1116  ; MODIFIES : NONE
00001784                          1117  ; ------------------------------------------------------------------------------
00001784  4EB8 1566               1118              JSR     TAILUPD
00001788  4EB8 1482               1119              JSR     SEGUPD
0000178C  4EB8 130E               1120              JSR     HEADUPD
00001790  6000 01EC               1121              BRA     MTZUPD       
00001794                          1122  
00001794                          1123  ; ------------------------------------------------------------------------------
00001794                          1124  GAMPLOT
00001794                          1125  ; PLOTS THE GAME
00001794                          1126  ; INPUT    : NONE
00001794                          1127  ; OUTPUT   : NONE
00001794                          1128  ; MODIFIES : NONE
00001794                          1129  ; ------------------------------------------------------------------------------
00001794  4EB8 13D0               1130              JSR    HEADPLOT
00001798  4EB8 1514               1131              JSR    SEGPLOT
0000179C  4EB8 15B4               1132              JSR    TAILPLOT
000017A0  4EB8 1664               1133              JSR    APPLEPLOT
000017A4  4EB9 000019FC           1134              JSR    MTZPLOT
000017AA  608A                    1135              BRA    SCOPLOT
000017AC                          1136  
000017AC                          1137  
000017AC                          1138  
000017AC                          1139  
000017AC                          1140  
000017AC                          1141  -------------------- end include --------------------
000017AC                          1142              INCLUDE 'MATRIZ.X68'
000017AC                          1143  ; ----------------------------------------------------------------------------
000017AC                          1144  ; MATRIZ
000017AC                          1145  ; ----------------------------------------------------------------------------
000017AC                          1146  
000017AC                          1147  ;-----------------------------------------------------------------------------
000017AC                          1148  MTZINIT
000017AC                          1149  ; INICIALIZA LA MATRIZ, AL PRINCIPIO ESTÁ VACÍA
000017AC                          1150  ; INPUT    : NONE
000017AC                          1151  ; OUTPUT   : NONE
000017AC                          1152  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000017AC                          1153  ; ----------------------------------------------------------------------------
000017AC                          1154              
000017AC  48A7 E080               1155              MOVEM.W D0-D2/A0,-(A7)
000017B0                          1156              
000017B0  41F9 00001DEE           1157              LEA ESTDCLDS,A0       ; Apunta al inicio de ESTDCLDS
000017B6  303C 0300               1158              MOVE.W #TCELDAS,D0    ; Número total de celdas
000017BA                          1159  
000017BA                          1160  CLNCLDS:
000017BA  4218                    1161              CLR.B (A0)+            ; Coloca 0 en cada celda
000017BC  5340                    1162              SUBI.W #1, D0          ; Decrementa el contador de celdas
000017BE  66FA                    1163              BNE CLNCLDS            ; Repite hasta que esten vacías
000017C0                          1164              
000017C0                          1165              
000017C0  3239 00001DCE           1166              MOVE.W  (CBZPOSX),D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
000017C6  3439 00001DD0           1167              MOVE.W  (CBZPOSY),D2
000017CC  4EB9 0000183E           1168              JSR     CINDMTRZ
000017D2  4EB9 00001878           1169              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
000017D8                          1170              
000017D8  3239 00001DDA           1171              MOVE.W  (SGMPOSX),D1
000017DE  3439 00001DDC           1172              MOVE.W  (SGMPOSY),D2             ; VEMOS LA POSICIÓN DEL SEGMENTO
000017E4  4EB9 0000183E           1173              JSR     CINDMTRZ
000017EA  4EB9 000018A4           1174              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
000017F0                          1175              
000017F0  3239 00001DDE           1176              MOVE.W  (SGMPOSX2),D1
000017F6  3439 00001DE0           1177              MOVE.W  (SGMPOSY2),D2            ; VEMOS LA POSICIÓN DEL SEGMENTO 2
000017FC  4EB9 0000183E           1178              JSR     CINDMTRZ
00001802  4EB9 000018A4           1179              JSR     SGMOCPD                 ; MARCAMOS LA POSICION DEL SEGMENTO 2
00001808                          1180              
00001808  3239 00001DD6           1181              MOVE.W  (COLPOSX),D1             ; VEMOS LA POSICIÓN DE LA COLA
0000180E  3439 00001DD8           1182              MOVE.W  (COLPOSY),D2
00001814  4EB9 0000183E           1183              JSR     CINDMTRZ
0000181A  4EB9 000018BA           1184              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
00001820                          1185              
00001820  3239 00001DCA           1186              MOVE.W  (MNZPOSX),D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
00001826  3439 00001DCC           1187              MOVE.W  (MNZPOSY),D2
0000182C  4EB9 0000183E           1188              JSR     CINDMTRZ
00001832  4EB9 000018D0           1189              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
00001838                          1190              
00001838                          1191              
00001838  4C9F 0107               1192              MOVEM.W (A7)+,D0-D2/A0
0000183C                          1193  
0000183C  4E75                    1194              RTS
0000183E                          1195  
0000183E                          1196  ;-----------------------------------------------------------------------------
0000183E                          1197  CINDMTRZ
0000183E                          1198  ; CALCULA EL ÍNDICE DE UNA CELDA
0000183E                          1199  ; INPUT    : D1 = coordenada X pantalla, D2 = coordenada Y pantalla
0000183E                          1200  ; OUTPUT   : D0 = índice de la celda en ESTDCLDS
0000183E                          1201  ; MODIFIES : NONE
0000183E                          1202  ; ----------------------------------------------------------------------------
0000183E                          1203  
0000183E  48A7 7000               1204               MOVEM.W D1-D3,-(A7)     ; Guarda los registros D1-D3 en la pila
00001842                          1205  
00001842                          1206              ; Divide X por SIZECLDA
00001842  3601                    1207              MOVE.W  D1,D3          ; Copia X a D3
00001844  4241                    1208              CLR.W   D1              ; Inicializa el cociente de X
00001846                          1209  
00001846  B67C 0014               1210  DIVX:       CMP.W   #SIZECLDA,D3    ; Compara D3 con SIZECLDA
0000184A  6D00 000A               1211              BLT     ENDDIVX         ; Si D3 < SIZECLDA, salta a ENDDIVX
0000184E  0443 0014               1212              SUB.W   #SIZECLDA,D3   ; Resta SIZECLDA de D3
00001852  5241                    1213              ADDQ.W  #1,D1          ; Incrementa el cociente de X
00001854  60F0                    1214              BRA     DIVX            ; Repite el bucle
00001856                          1215  
00001856                          1216  ENDDIVX:
00001856                          1217  
00001856                          1218              ; Divide Y por SIZECLDA
00001856  3602                    1219              MOVE.W  D2,D3          ; Copia Y a D3
00001858  4242                    1220              CLR.W   D2              ; Inicializa el cociente de Y
0000185A                          1221  
0000185A  B67C 0014               1222  DIVY:       CMP.W   #SIZECLDA,D3    ; Compara D3 con SIZECLDA
0000185E  6D00 000A               1223              BLT     ENDDIVY         ; Si D3 < SIZECLDA, salta a ENDDIVY
00001862  0443 0014               1224              SUB.W   #SIZECLDA,D3   ; Resta SIZECLDA de D3
00001866  5242                    1225              ADDQ.W  #1, D2          ; Incrementa el cociente de Y
00001868  60F0                    1226              BRA     DIVY            ; Repite el bucle
0000186A                          1227  
0000186A                          1228  ENDDIVY:
0000186A                          1229  
0000186A                          1230              ; Calcula el índice
0000186A  4240                    1231              CLR.W   D0
0000186C  3002                    1232              MOVE.W  D2, D0          ; D0 = Y_CELDA
0000186E  EB40                    1233              ASL.W   #5, D0          ; D0 = Y_CELDA * NUMCLMNS (32 = 2^5)
00001870  D041                    1234              ADD.W   D1, D0          ; D0 = Y_CELDA * NUMCLMNS + X_CELDA
00001872                          1235  
00001872  4C9F 000E               1236              MOVEM.W (A7)+,D1-D3     ; Restaura los registros D1-D3 desde la pila
00001876                          1237  
00001876  4E75                    1238              RTS  
00001878                          1239              
00001878                          1240  ;-----------------------------------------------------------------------------
00001878                          1241  CBZOCPD
00001878                          1242  ; MARCA UNA CELDA COMO OCUPADA POR LA CABEZA
00001878                          1243  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001878                          1244  ; OUTPUT   : NONE
00001878                          1245  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001878                          1246  ; ----------------------------------------------------------------------------
00001878                          1247  
00001878  48A7 0080               1248              MOVEM.W A0,-(A7)
0000187C                          1249  
0000187C  41F9 00001DEE           1250              LEA     ESTDCLDS,A0                ; Dirección de la matriz en A0
00001882  11BC 0003 0000          1251              MOVE.B  #3,(A0, D0.W)           ; Marca la celda como ocupada
00001888                          1252              
00001888  4C9F 0100               1253              MOVEM.W (A7)+,A0
0000188C                          1254              
0000188C  4E75                    1255              RTS
0000188E                          1256              
0000188E                          1257              
0000188E                          1258              
0000188E                          1259             
0000188E                          1260  ;-----------------------------------------------------------------------------
0000188E                          1261  MCLDVCIA
0000188E                          1262  ; MARCA UNA CELDA COMO VACÍA
0000188E                          1263  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000188E                          1264  ; OUTPUT   : NONE
0000188E                          1265  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000188E                          1266  ; ----------------------------------------------------------------------------
0000188E                          1267  
0000188E  48A7 0080               1268              MOVEM.W A0,-(A7)
00001892                          1269  
00001892  41F9 00001DEE           1270              LEA     ESTDCLDS,A0                ; Direccion de la matriz en A0
00001898  11BC 0000 0000          1271              MOVE.B  #0,(A0,D0.W)           ; Marca la celda como vacía
0000189E                          1272              
0000189E  4C9F 0100               1273              MOVEM.W (A7)+,A0
000018A2                          1274              
000018A2  4E75                    1275              RTS
000018A4                          1276  
000018A4                          1277  ;-----------------------------------------------------------------------------
000018A4                          1278  SGMOCPD
000018A4                          1279  ; MARCA UNA CELDA COMO OCUPADA POR EL SEGMENTO
000018A4                          1280  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000018A4                          1281  ; OUTPUT   : NONE
000018A4                          1282  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000018A4                          1283  ; ----------------------------------------------------------------------------
000018A4                          1284  
000018A4  48A7 0080               1285              MOVEM.W A0,-(A7)
000018A8                          1286  
000018A8  41F9 00001DEE           1287              LEA ESTDCLDS,A0                ; Dirección de la matriz en A0
000018AE  11BC 0002 0000          1288              MOVE.B #2,(A0,D0.W)           ; Marca la celda como ocupada
000018B4                          1289              
000018B4  4C9F 0100               1290              MOVEM.W (A7)+,A0
000018B8                          1291              
000018B8  4E75                    1292              RTS
000018BA                          1293              
000018BA                          1294  ;-----------------------------------------------------------------------------
000018BA                          1295  COLOCPD
000018BA                          1296  ; MARCA UNA CELDA COMO OCUPADA POR LA COLA
000018BA                          1297  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000018BA                          1298  ; OUTPUT   : NONE
000018BA                          1299  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000018BA                          1300  ; ----------------------------------------------------------------------------
000018BA                          1301  
000018BA  48A7 0080               1302              MOVEM.W A0,-(A7)
000018BE                          1303  
000018BE  41F9 00001DEE           1304              LEA ESTDCLDS,A0                ; Dirección de la matriz en A0
000018C4  11BC 0001 0000          1305              MOVE.B #1,(A0,D0.W)           ; Marca la celda como ocupada
000018CA                          1306              
000018CA  4C9F 0100               1307              MOVEM.W (A7)+,A0
000018CE                          1308              
000018CE  4E75                    1309              RTS
000018D0                          1310  
000018D0                          1311  
000018D0                          1312  ;-----------------------------------------------------------------------------
000018D0                          1313  MNZOCPD
000018D0                          1314  ; MARCA UNA CELDA COMO OCUPADA POR LA MANZANA
000018D0                          1315  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000018D0                          1316  ; OUTPUT   : NONE
000018D0                          1317  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000018D0                          1318  ; ----------------------------------------------------------------------------
000018D0                          1319  
000018D0  48A7 0080               1320              MOVEM.W A0,-(A7)
000018D4                          1321  
000018D4  41F9 00001DEE           1322              LEA ESTDCLDS,A0                ; Dirección de la matriz en A0
000018DA  11BC 0004 0000          1323              MOVE.B #4,(A0,D0.W)           ; Marca la celda como ocupada
000018E0                          1324              
000018E0  4C9F 0100               1325              MOVEM.W (A7)+,A0
000018E4                          1326              
000018E4  4E75                    1327              RTS
000018E6                          1328  
000018E6                          1329              
000018E6                          1330  ;-----------------------------------------------------------------------------
000018E6                          1331  CNVICOOR
000018E6                          1332  ; Convierte un índice de celda a coordenadas de pantalla (X, Y)
000018E6                          1333  ; INPUT    : D0 = índice de la celda en ESTADO_CELDAS
000018E6                          1334  ; OUTPUT   : D1 = coordenada X, D2 = coordenada Y
000018E6                          1335  ; MODIFIES : NONE
000018E6                          1336  ; ----------------------------------------------------------------------------
000018E6                          1337  
000018E6  48A7 9800               1338              MOVEM.W D0/D3-D4,-(A7)
000018EA                          1339  
000018EA  3400                    1340              MOVE.W  D0,D2         ; Copia índice a D2 para calcular la fila
000018EC  EA4A                    1341              LSR.W   #5,D2         ; D2 = índice / NUM_COLUMNAS (32 = 2^5)
000018EE  3200                    1342              MOVE.W  D0,D1         ; Copia índice a D1 para calcular la columna
000018F0  C27C 001F               1343              AND.W   #$1F,D1       ; D1 = índice % NUM_COLUMNAS (31 = 0x1F) (CREO)
000018F4                          1344  
000018F4                          1345              ; Multiplica por TAMAÑO_CELDA = 10
000018F4  363C 0014               1346              MOVE.W  #SIZECLDA, D3
000018F8  3801                    1347              MOVE.W  D1,D4         ; Copia D1 para multiplicar por 10
000018FA  4241                    1348              CLR.W   D1            ; Inicializa resultado
000018FC                          1349  
000018FC                          1350  
000018FC                          1351  MULTLOOPX: 
000018FC  B87C 0000               1352              CMP.W   #0,D4        ; ¿Quedan iteraciones?
00001900  6700 0008               1353              BEQ     ENDMULTX
00001904  D243                    1354              ADD.W   D3,D1         ; Suma TAMANO_CELDA (10) repetidamente
00001906                          1355  
00001906  5344                    1356              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
00001908  60F2                    1357              BRA     MULTLOOPX     ; Repite mientras no sea 0
0000190A                          1358  ENDMULTX: 
0000190A  3802                    1359              MOVE.W  D2,D4         ; Copia D2 para multiplicar por 10
0000190C  4242                    1360              CLR.W   D2            ; Inicializa resultado
0000190E                          1361  
0000190E                          1362  MULTLOOPY: 
0000190E  B87C 0000               1363              CMP.W   #0,D4        ; ¿Quedan iteraciones?
00001912  6700 0008               1364              BEQ     ENDMULTY
00001916  D443                    1365              ADD.W   D3,D2         ; Suma TAMANO_CELDA (10) repetidamente
00001918  5344                    1366              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
0000191A  60F2                    1367              BRA     MULTLOOPY     ; Repite mientras no sea 0
0000191C                          1368  ENDMULTY:
0000191C  4C9F 0019               1369              MOVEM.W (A7)+,D0/D3-D4
00001920                          1370  
00001920  4E75                    1371              RTS
00001922                          1372  
00001922                          1373  ; ----------------------------------------------------------------------------
00001922                          1374  CHECKCLD
00001922                          1375  ; INPUT: D0 = índice de la celda
00001922                          1376  ; OUTPUT: D0 = 0 si está vacía, 1 si está ocupada
00001922                          1377  ; MODIFIES: Ninguno
00001922                          1378  ; ----------------------------------------------------------------------------
00001922                          1379  
00001922  41F9 00001DEE           1380              LEA     ESTDCLDS,A0    ; Carga la dirección de la matriz ESTDCLDS
00001928  1230 0000               1381              MOVE.B  (A0,D0.W),D1   ; Carga el estado de la celda en D1
0000192C  B23C 0000               1382              CMP.B   #0,D1          ; Compara si está vacía (0)
00001930  6700 0008               1383              BEQ     CLDFREE         ; Si está vacía
00001934  303C 0001               1384              MOVE.W  #1,D0          ; Si está ocupada, devuelve 1 (ocupada)
00001938                          1385  
00001938  4E75                    1386              RTS
0000193A                          1387  
0000193A                          1388  CLDFREE:
0000193A  303C 0000               1389              MOVE.W  #0,D0                 ; Devuelve 0 (libre)
0000193E                          1390  
0000193E  4E75                    1391              RTS
00001940                          1392  
00001940                          1393  
00001940                          1394  ;-----------------------------------------------------------------------------
00001940                          1395  FONPLOT
00001940                          1396  ; DIBUJADO DEL FONDO
00001940                          1397  ; INPUT    : NONE
00001940                          1398  ; OUTPUT   : NONE
00001940                          1399  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001940                          1400  ; ----------------------------------------------------------------------------
00001940                          1401  
00001940  3F00                    1402              MOVE.W  D0,-(A7)
00001942  3003                    1403              MOVE.W  D3,D0
00001944  4EB8 18E6               1404              JSR     CNVICOOR
00001948  2F01                    1405              MOVE.L  D1,-(A7)
0000194A                          1406              
0000194A  103C 0050               1407              MOVE.B  #80,D0
0000194E  223C 0090EE90           1408              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001954  4E4F                    1409              TRAP    #15
00001956                          1410              
00001956  103C 0051               1411              MOVE.B  #81,D0
0000195A  223C 0090EE90           1412              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001960  4E4F                    1413              TRAP    #15
00001962                          1414              
00001962  103C 0057               1415              MOVE.B  #87,D0
00001966  221F                    1416              MOVE.L  (A7)+,D1
00001968  3F03                    1417              MOVE.W  D3,-(A7)
0000196A  3601                    1418              MOVE.W  D1,D3
0000196C  0643 0014               1419              ADD.W   #SIZECLDA,D3
00001970  3802                    1420              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001972  0644 0014               1421              ADD.W   #SIZECLDA,D4
00001976  4E4F                    1422              TRAP    #15                     
00001978                          1423                          
00001978  361F                    1424              MOVE.W  (A7)+,D3  
0000197A  301F                    1425              MOVE.W  (A7)+,D0
0000197C  4E75                    1426              RTS         
0000197E                          1427  
0000197E                          1428  
0000197E                          1429  
0000197E                          1430  ;-----------------------------------------------------------------------------
0000197E                          1431  MTZUPD
0000197E                          1432  ; ACTUALIZA LA MATRIZ CASILLA A CASILLA
0000197E                          1433  ; INPUT    : NONE
0000197E                          1434  ; OUTPUT   : NONE
0000197E                          1435  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
0000197E                          1436  ; ----------------------------------------------------------------------------
0000197E                          1437  
0000197E                          1438  
0000197E  48A7 E080               1439              MOVEM.W D0-D2/A0,-(A7)
00001982                          1440              
00001982  41F9 00001DEE           1441              LEA ESTDCLDS,A0       ; Apunta al inicio de ESTDCLDS
00001988  303C 0300               1442              MOVE.W #TCELDAS,D0    ; Número total de celdas
0000198C                          1443  
0000198C                          1444  .CLNCLDS:
0000198C  4218                    1445              CLR.B (A0)+            ; Coloca 0 en cada celda
0000198E  5340                    1446              SUBI.W #1,D0          ; Decrementa el contador de celdas
00001990  66FA                    1447              BNE .CLNCLDS           ; Repite hasta que esten vacías
00001992                          1448              
00001992                          1449              
00001992  3239 00001DCE           1450              MOVE.W  (CBZPOSX),D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
00001998  3439 00001DD0           1451              MOVE.W  (CBZPOSY),D2
0000199E  4EB8 183E               1452              JSR     CINDMTRZ
000019A2  4EB8 1878               1453              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
000019A6                          1454              
000019A6  3239 00001DDA           1455              MOVE.W  (SGMPOSX),D1
000019AC  3439 00001DDC           1456              MOVE.W  (SGMPOSY),D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
000019B2  4EB8 183E               1457              JSR     CINDMTRZ
000019B6  4EB8 18A4               1458              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
000019BA                          1459              
000019BA  3239 00001DDE           1460              MOVE.W  (SGMPOSX2),D1
000019C0  3439 00001DE0           1461              MOVE.W  (SGMPOSY2),D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
000019C6  4EB8 183E               1462              JSR     CINDMTRZ
000019CA  4EB8 18A4               1463              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
000019CE                          1464              
000019CE  3239 00001DD6           1465              MOVE.W  (COLPOSX),D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
000019D4  3439 00001DD8           1466              MOVE.W  (COLPOSY),D2
000019DA  4EB8 183E               1467              JSR     CINDMTRZ
000019DE  4EB8 18BA               1468              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
000019E2                          1469              
000019E2  3239 00001DCA           1470              MOVE.W  (MNZPOSX),D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
000019E8  3439 00001DCC           1471              MOVE.W  (MNZPOSY),D2
000019EE  4EB8 183E               1472              JSR     CINDMTRZ
000019F2  4EB8 18D0               1473              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
000019F6                          1474              
000019F6                          1475              
000019F6  4C9F 0107               1476              MOVEM.W (A7)+,D0-D2/A0
000019FA                          1477  
000019FA  4E75                    1478              RTS
000019FC                          1479  
000019FC                          1480  
000019FC                          1481  
000019FC                          1482  ;-----------------------------------------------------------------------------
000019FC                          1483  MTZPLOT
000019FC                          1484  ; DIBUJA LA MATRIZ CASILLA A CASILLA
000019FC                          1485  ; INPUT    : NONE
000019FC                          1486  ; OUTPUT   : NONE
000019FC                          1487  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000019FC                          1488  ; ----------------------------------------------------------------------------
000019FC  48E7 F080               1489              MOVEM.L D0-D3/A0,-(A7)
00001A00                          1490  
00001A00  4240                    1491              CLR.W   D0
00001A02  4243                    1492              CLR.W   D3
00001A04  41F9 00001DEE           1493              LEA     ESTDCLDS,A0            ; Apunta al inicio de ESTDCLDS
00001A0A  303C 0300               1494              MOVE.W  #TCELDAS,D0            ; Número total de celdas
00001A0E  363C 0000               1495              MOVE.W  #0,D3                   ; LO UTILIZAMOS PARA SABER EL INDICE EN EL QUE NOS ENCONTRAMOS
00001A12  4241                    1496              CLR.W   D1
00001A14  4242                    1497              CLR.W   D2
00001A16                          1498              
00001A16                          1499  
00001A16                          1500  PLOTCLDS:
00001A16  1218                    1501              MOVE.B  (A0)+,D1                ; MOVEMOS EL VALOR DE LA CELDA A D1
00001A18  B23C 0000               1502              CMP.B   #0,D1
00001A1C  6700 0034               1503              BEQ     PLOTVAC                 ; SALTA A DIBUJAR POSICIÓN VACÍA
00001A20  B23C 0001               1504              CMP.B   #1,D1 
00001A24  6700 0032               1505              BEQ     PLOTCOL                 ; SALTA A DIBUJAR COLA
00001A28  B23C 0002               1506              CMP.B   #2,D1
00001A2C  6700 0030               1507              BEQ     PLOTSEG                 ; SALTA A DIBUJAR SEGMENTO
00001A30  B23C 0003               1508              CMP.B   #3,D1
00001A34  6700 0016               1509              BEQ     PLOTCBZ                 ; SALTA A DIBUJAR CABEZA
00001A38  B23C 0004               1510              CMP.B   #4,D1                 
00001A3C  6700 0026               1511              BEQ     PLOTAPPLE               ; SALTA A DIBUJAR MANZANA
00001A40                          1512    
00001A40                          1513  DONEPLOT            
00001A40  5243                    1514              ADDQ    #1,D3                   ; AUMENTAMOS EL INDICE DE CELDA PARA LA SIGUIENTE
00001A42  5340                    1515              SUBI.W  #1,D0                  ; Decrementa el contador de celdas
00001A44  66D0                    1516              BNE     PLOTCLDS                ; Repite hasta que esten vacías
00001A46  4CDF 010F               1517              MOVEM.L (A7)+,D0-D3/A0
00001A4A  4E75                    1518              RTS
00001A4C                          1519  PLOTCBZ:
00001A4C  4EB8 13D0               1520              JSR     HEADPLOT
00001A50  60EE                    1521              BRA     DONEPLOT
00001A52                          1522  
00001A52                          1523  PLOTVAC:    
00001A52  4EB8 1940               1524              JSR     FONPLOT
00001A56  60E8                    1525              BRA     DONEPLOT                ; DIBUJADO HECHO 
00001A58                          1526  
00001A58                          1527  PLOTCOL:   
00001A58  4EB8 15B4               1528              JSR     TAILPLOT 
00001A5C  60E2                    1529              BRA     DONEPLOT                ; DIBUJADO HECHO 
00001A5E                          1530              
00001A5E                          1531  PLOTSEG:    
00001A5E  4EB8 1514               1532              JSR     SEGPLOT
00001A62  60DC                    1533              BRA     DONEPLOT                ; DIBUJADO HECHO    
00001A64                          1534  
00001A64                          1535  PLOTAPPLE:
00001A64  4EB8 1664               1536              JSR     APPLEPLOT
00001A68  60D6                    1537              BRA     DONEPLOT            
00001A6A                          1538  
00001A6A                          1539  
00001A6A                          1540  
00001A6A                          1541  
00001A6A                          1542  
00001A6A                          1543  
00001A6A                          1544  
00001A6A                          1545  
00001A6A                          1546  
00001A6A                          1547  
00001A6A                          1548  
00001A6A                          1549  
00001A6A                          1550  
00001A6A                          1551  
00001A6A                          1552  
00001A6A                          1553  
00001A6A                          1554  
00001A6A                          1555  
00001A6A                          1556  
00001A6A                          1557  
00001A6A                          1558  
00001A6A                          1559  -------------------- end include --------------------
00001A6A                          1560              INCLUDE 'INTRO.X68'
00001A6A                          1561  ; ==============================================================================
00001A6A                          1562  ; INTRO SCREEN
00001A6A                          1563  ; ==============================================================================
00001A6A                          1564  
00001A6A                          1565  ; ------------------------------------------------------------------------------
00001A6A                          1566  ISCINIT
00001A6A                          1567  ; INTRO SCREEN INIT
00001A6A                          1568  ; INPUT    : NONE
00001A6A                          1569  ; OUTPUT   : NONE
00001A6A                          1570  ; MODIFIES : NONE
00001A6A                          1571  ; ------------------------------------------------------------------------------
00001A6A                          1572  
00001A6A  4279 00001DE6           1573              CLR.W   (ISCTIMER)
00001A70                          1574              
00001A70  4E75                    1575              RTS
00001A72                          1576  
00001A72                          1577  ; ------------------------------------------------------------------------------
00001A72                          1578  ISCUPD
00001A72                          1579  ; INTRO SCREEN UPDATE
00001A72                          1580  ; INPUT    : NONE
00001A72                          1581  ; OUTPUT   : NONE
00001A72                          1582  ; MODIFIES : NONE
00001A72                          1583  ; ------------------------------------------------------------------------------
00001A72                          1584  
00001A72                          1585              
00001A72  0839 0004 000020F0      1586              BTST.B  #4,(KBDEDGE)            ; CAMBIAR POR RATON
00001A7A                          1587  
00001A7A  6700 000A               1588              BEQ     .CONT
00001A7E  33FC 0002 00001DEA      1589              MOVE.W  #2,(STANEXT)            ; SI COINCIDE INICIAR JUEGO
00001A86                          1590              
00001A86  5279 00001DE6           1591  .CONT       ADDQ.W  #1,(ISCTIMER)
00001A8C  0C79 01F4 00001DE6      1592              CMP.W   #500,(ISCTIMER)
00001A94  6D00 000A               1593              BLT     .DONE
00001A98  33FC 0001 00001DEA      1594              MOVE.W  #1,(STANEXT)
00001AA0                          1595              
00001AA0                          1596  .DONE       
00001AA0                          1597              ;MOVEM.L (A7)+,D0-D4/A0
00001AA0  4E75                    1598              RTS
00001AA2                          1599  
00001AA2                          1600  ; ------------------------------------------------------------------------------
00001AA2                          1601  ISCPLOT
00001AA2                          1602  ; INTRO SCREEN PLOT
00001AA2                          1603  ; INPUT    : NONE
00001AA2                          1604  ; OUTPUT   : NONE
00001AA2                          1605  ; MODIFIES : NONE
00001AA2                          1606  ; ------------------------------------------------------------------------------
00001AA2  48E7 C080               1607              MOVEM.L D0-D1/A0,-(A7)
00001AA6                          1608              
00001AA6                          1609              ;JSR     FONPLOT
00001AA6                          1610              
00001AA6  4281                    1611              CLR.L   D1
00001AA8  103C 0051               1612              MOVE.B  #81,D0
00001AAC  4E4F                    1613              TRAP    #15
00001AAE                          1614              
00001AAE  41F9 00001ADC           1615              LEA     .TXT1,A0
00001AB4  103C 000A               1616              MOVE.B  #10,D0
00001AB8  4EB8 1198               1617              JSR     UTLPRINT
00001ABC                          1618              
00001ABC  0839 0004 000020F7      1619              BTST.B  #4,(SCRCYCCT)
00001AC4  6700 0010               1620              BEQ     .DONE
00001AC8                          1621              
00001AC8  41F9 00001AEE           1622              LEA     .TXT2,A0
00001ACE  103C 0019               1623              MOVE.B  #25,D0
00001AD2  4EB8 1198               1624              JSR     UTLPRINT
00001AD6                          1625              
00001AD6  4CDF 0103               1626  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001ADA                          1627  
00001ADA  4E75                    1628              RTS
00001ADC                          1629              
00001ADC                          1630  
00001ADC                          1631              
00001ADC= 53 4E 41 4B 45 20 ...   1632  .TXT1       DC.B    'SNAKE TIMER 68000',0
00001AEE= 50 52 45 53 53 20 ...   1633  .TXT2       DC.B    'PRESS TO START',0
00001AFE                          1634              DS.W    0
00001AFE                          1635  
00001AFE                          1636  -------------------- end include --------------------
00001AFE                          1637              INCLUDE 'INSTRUCTIONS.X68'
00001AFE                          1638  ; ==============================================================================
00001AFE                          1639  ; INSTRUCTIONS SCREEN
00001AFE                          1640  ; ==============================================================================
00001AFE                          1641  
00001AFE                          1642  ; ------------------------------------------------------------------------------
00001AFE                          1643  INSINIT
00001AFE                          1644  ; INSTRUCTIONS SCREEN INIT
00001AFE                          1645  ; INPUT    : NONE
00001AFE                          1646  ; OUTPUT   : NONE
00001AFE                          1647  ; MODIFIES : NONE
00001AFE                          1648  ; ------------------------------------------------------------------------------
00001AFE  4E75                    1649              RTS
00001B00                          1650  
00001B00                          1651  ; ------------------------------------------------------------------------------
00001B00                          1652  INSUPD
00001B00                          1653  ; INSTRUCTIONS SCREEN UPDATE
00001B00                          1654  ; INPUT    : NONE
00001B00                          1655  ; OUTPUT   : NONE
00001B00                          1656  ; MODIFIES : NONE
00001B00                          1657  ; ------------------------------------------------------------------------------
00001B00  4E75                    1658              RTS
00001B02                          1659  
00001B02                          1660  ; ------------------------------------------------------------------------------
00001B02                          1661  INSPLOT
00001B02                          1662  ; INSTRUCTIONS SCREEN PLOT
00001B02                          1663  ; INPUT    : NONE
00001B02                          1664  ; OUTPUT   : NONE
00001B02                          1665  ; MODIFIES : NONE
00001B02                          1666  ; ------------------------------------------------------------------------------
00001B02                          1667  
00001B02  48E7 C0C0               1668              MOVEM.L D0-D1/A0-A1,-(A7)
00001B06                          1669              
00001B06                          1670              ;JSR     FONPLOT
00001B06                          1671              
00001B06  103C 000B               1672              MOVE.B  #11,D0
00001B0A  43F9 00001C84           1673              LEA     .TXTLST,A1
00001B10  2219                    1674  .LOOP       MOVE.L  (A1)+,D1
00001B12  6700 000A               1675              BEQ     .DONE
00001B16  2041                    1676              MOVE.L  D1,A0
00001B18  4EB8 1198               1677              JSR     UTLPRINT
00001B1C  60F2                    1678              BRA     .LOOP
00001B1E                          1679              
00001B1E  4CDF 0303               1680  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
00001B22  4E75                    1681              RTS
00001B24= 57 45 4C 43 4F 4D ...   1682  .TXT1       DC.B    'WELCOME TO THE GAME OF SNAKE TIMER 68000!',0
00001B4E= 59 4F 55 52 20 47 ...   1683  .TXT2       DC.B    'YOUR GOAL IN THIS GAME IS TO EAT AS MUCH APPLES AS THE TIMER ALLOWS YOU',0
00001B96= 45 41 43 48 20 41 ...   1684  .TXT3       DC.B    'EACH APPLE EATEN INCREASES THE TIME YOU CAN PLAY',0
00001BC7= 54 4F 20 54 48 49 ...   1685  .TXT4       DC.B    'TO THIS END, MOVE THE SNAKE WITH THE ARROWS',0
00001BF3= 48 4F 57 20 54 4F ...   1686  .TXT5       DC.B    'HOW TO DO IT? YOU MAY ASK.',0
00001C0E= 49 54 20 49 53 20 ...   1687  .TXT6       DC.B    'IT IS EASY: JUST USE THE UP, DOWN, LEFT, RIGHT KEYS TO MOVE THE SNAKE',0
00001C54= 42 45 20 43 41 52 ...   1688  .TXT7       DC.B    'BE CAREFUL WITH THE WALLS! TRY NOT TO HIT THEM.',0
00001C84= 00001B24 00001B4E ...   1689  .TXTLST     DC.L    .TXT1,.TXT2,.TXT3,.TXT4,.TXT5,.TXT6,.TXT7,0
00001CA4                          1690  
00001CA4                          1691  
00001CA4                          1692  
00001CA4                          1693  
00001CA4                          1694  
00001CA4                          1695  
00001CA4                          1696  
00001CA4                          1697  
00001CA4                          1698  
00001CA4                          1699  
00001CA4                          1700  -------------------- end include --------------------
00001CA4                          1701              INCLUDE 'GAMEOVER.X68'
00001CA4                          1702  ; ==============================================================================
00001CA4                          1703  ; GAME OVER SCREEN
00001CA4                          1704  ; ==============================================================================
00001CA4                          1705  
00001CA4                          1706  ; ------------------------------------------------------------------------------
00001CA4                          1707  GOVINIT
00001CA4                          1708  ; GAME OVER SCREEN INIT
00001CA4                          1709  ; INPUT    : NONE
00001CA4                          1710  ; OUTPUT   : NONE
00001CA4                          1711  ; MODIFIES : NONE
00001CA4                          1712  ; ------------------------------------------------------------------------------
00001CA4  4E75                    1713              RTS
00001CA6                          1714  
00001CA6                          1715  ; ------------------------------------------------------------------------------
00001CA6                          1716  GOVUPD
00001CA6                          1717  ; GAME OVER SCREEN UPDATE
00001CA6                          1718  ; INPUT    : NONE
00001CA6                          1719  ; OUTPUT   : NONE
00001CA6                          1720  ; MODIFIES : NONE
00001CA6                          1721  ; ------------------------------------------------------------------------------
00001CA6  4E75                    1722              RTS
00001CA8                          1723  
00001CA8                          1724  ; ------------------------------------------------------------------------------
00001CA8                          1725  GOVPLOT
00001CA8                          1726  ; GAME OVER SCREEN PLOT
00001CA8                          1727  ; INPUT    : NONE
00001CA8                          1728  ; OUTPUT   : NONE
00001CA8                          1729  ; MODIFIES : NONE
00001CA8                          1730  ; ------------------------------------------------------------------------------
00001CA8  48E7 C080               1731              MOVEM.L D0-D1/A0,-(A7)
00001CAC                          1732              
00001CAC                          1733              ;JSR     FONPLOT
00001CAC                          1734              
00001CAC  4281                    1735              CLR.L   D1
00001CAE  103C 0051               1736              MOVE.B  #81,D0
00001CB2  4E4F                    1737              TRAP    #15
00001CB4                          1738              
00001CB4  41F9 00001CE2           1739              LEA     .TXT1,A0
00001CBA  103C 000A               1740              MOVE.B  #10,D0
00001CBE  4EB8 1198               1741              JSR     UTLPRINT
00001CC2                          1742              
00001CC2  0839 0004 000020F7      1743              BTST.B  #4,(SCRCYCCT)
00001CCA  6700 0010               1744              BEQ     .DONE
00001CCE                          1745              
00001CCE  41F9 00001CEC           1746              LEA     .TXT2,A0
00001CD4  103C 0019               1747              MOVE.B  #25,D0
00001CD8  4EB8 1198               1748              JSR     UTLPRINT
00001CDC                          1749              
00001CDC  4CDF 0103               1750  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001CE0                          1751  
00001CE0  4E75                    1752              RTS
00001CE2= 47 41 4D 45 20 4F ...   1753  .TXT1       DC.B    'GAME OVER',0
00001CEC= 50 52 45 53 53 20 ...   1754  .TXT2       DC.B    'PRESS TO CONTINUE',0
00001CFE                          1755              DS.W    0
00001CFE                          1756  
00001CFE                          1757  
00001CFE                          1758  
00001CFE                          1759  
00001CFE                          1760  
00001CFE                          1761  
00001CFE                          1762  
00001CFE                          1763  -------------------- end include --------------------
00001CFE                          1764              INCLUDE 'STATES.X68'
00001CFE                          1765  ; =============================================================================
00001CFE                          1766  ; GAME STATE MANAGEMENT
00001CFE                          1767  ; =============================================================================
00001CFE                          1768  
00001CFE                          1769  ; -----------------------------------------------------------------------------
00001CFE                          1770  STAINIT
00001CFE                          1771  ; INITALIZES THE STATE MANAGER
00001CFE                          1772  ; INPUT    - NONE
00001CFE                          1773  ; OUTPUT   - NONE
00001CFE                          1774  ; MODIFIES - NONE
00001CFE                          1775  ; -----------------------------------------------------------------------------
00001CFE  33FC FFFF 00001DE8      1776              MOVE.W  #STANONE,(STACUR)
00001D06  4279 00001DEA           1777              CLR.W   (STANEXT)
00001D0C  4E75                    1778              RTS
00001D0E                          1779  
00001D0E                          1780  ; -----------------------------------------------------------------------------
00001D0E                          1781  STAUPD
00001D0E                          1782  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00001D0E                          1783  ; INPUT    - NONE
00001D0E                          1784  ; OUTPUT   - NONE
00001D0E                          1785  ; MODIFIES - NONE
00001D0E                          1786  ; -----------------------------------------------------------------------------
00001D0E  48E7 8080               1787              MOVEM.L D0/A0,-(A7)
00001D12                          1788              
00001D12  4280                    1789              CLR.L   D0
00001D14  3039 00001DEA           1790              MOVE.W  (STANEXT),D0
00001D1A  B079 00001DE8           1791              CMP.W   (STACUR),D0
00001D20  6700 0012               1792              BEQ     .DOUPD
00001D24  33C0 00001DE8           1793              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00001D2A  E588                    1794              LSL.L   #2,D0
00001D2C  2040                    1795              MOVE.L  D0,A0
00001D2E  2068 1D4C               1796              MOVE.L  .INITBL(A0),A0
00001D32  4E90                    1797              JSR     (A0)
00001D34  4280                    1798  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00001D36  3039 00001DE8           1799              MOVE.W  (STACUR),D0
00001D3C  E588                    1800              LSL.L   #2,D0
00001D3E  2040                    1801              MOVE.L  D0,A0
00001D40  2068 1D5C               1802              MOVE.L  .UPDTBL(A0),A0
00001D44  4E90                    1803              JSR     (A0)
00001D46                          1804              
00001D46  4CDF 0101               1805              MOVEM.L (A7)+,D0/A0
00001D4A  4E75                    1806              RTS
00001D4C= 00001A6A 00001AFE ...   1807  .INITBL     DC.L    ISCINIT,INSINIT,GAMINIT,GOVINIT
00001D5C= 00001A72 00001B00 ...   1808  .UPDTBL     DC.L    ISCUPD,INSUPD,GAMUPD,GOVUPD
00001D6C                          1809  
00001D6C                          1810  ; -----------------------------------------------------------------------------
00001D6C                          1811  STAPLOT
00001D6C                          1812  ; PERFORMS STATE PLOT
00001D6C                          1813  ; INPUT    - NONE
00001D6C                          1814  ; OUTPUT   - NONE
00001D6C                          1815  ; MODIFIES - NONE
00001D6C                          1816  ; -----------------------------------------------------------------------------
00001D6C  48E7 8080               1817              MOVEM.L D0/A0,-(A7)
00001D70  4280                    1818              CLR.L   D0
00001D72  3039 00001DE8           1819              MOVE.W  (STACUR),D0
00001D78  E588                    1820              LSL.L   #2,D0
00001D7A  2040                    1821              MOVE.L  D0,A0
00001D7C  2068 1D88               1822              MOVE.L  .PLTTBL(A0),A0
00001D80  4E90                    1823              JSR     (A0)
00001D82  4CDF 0101               1824              MOVEM.L (A7)+,D0/A0
00001D86  4E75                    1825              RTS
00001D88= 00001AA2 00001B02 ...   1826  .PLTTBL     DC.L    ISCPLOT,INSPLOT,GAMPLOT,GOVPLOT
00001D98                          1827  
00001D98                          1828  ; -----------------------------------------------------------------------------
00001D98                          1829  STAEMPTY
00001D98                          1830  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00001D98                          1831  ; INPUT    - NONE
00001D98                          1832  ; OUTPUT   - NONE
00001D98                          1833  ; MODIFIES - NONE
00001D98                          1834  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00001D98                          1835  ; -----------------------------------------------------------------------------
00001D98  4E75                    1836              RTS
00001D9A                          1837  
00001D9A                          1838  
00001D9A                          1839  
00001D9A                          1840  
00001D9A                          1841  
00001D9A                          1842  
00001D9A                          1843  
00001D9A                          1844  
00001D9A                          1845  
00001D9A                          1846  
00001D9A                          1847  -------------------- end include --------------------
00001D9A                          1848              
00001D9A                          1849  START:
00001D9A                          1850                  
00001D9A                          1851  ; --- INIZIALIZACIÓN ---------------------------------------------------------
00001D9A                          1852  
00001D9A  007C 0700               1853              ORI.W   #$0700,SR
00001D9E  4EB8 1000               1854              JSR     SYSINIT
00001DA2  4EB8 1182               1855              JSR     UTLINIT
00001DA6  4EB8 1CFE               1856              JSR     STAINIT
00001DAA                          1857  
00001DAA                          1858  
00001DAA                          1859  .LOOP
00001DAA                          1860  
00001DAA                          1861  ; --- ACTUALIZAR -------------------------------------------------------------
00001DAA                          1862  
00001DAA                          1863  ; LEER DISPOSITIVOS DE ENTRADA
00001DAA                          1864  
00001DAA  4E41                    1865              TRAP    #KBDUPTN
00001DAC                          1866  
00001DAC                          1867  ; ACTUALIZAR LÓGICA DEL JUEGO
00001DAC                          1868              
00001DAC  4EB8 1D0E               1869              JSR     STAUPD
00001DB0                          1870              
00001DB0                          1871  ; --- SINCRONIZACIÓN ---------------------------------------------------------
00001DB0                          1872              
00001DB0  4A39 000020F6           1873  .WINT       TST.B   (SCRINTCT)
00001DB6  67F8                    1874              BEQ     .WINT   
00001DB8  4239 000020F6           1875              CLR.B   (SCRINTCT)         
00001DBE                          1876  
00001DBE                          1877  
00001DBE                          1878  ; --- DIBUJAR ----------------------------------------------------------------
00001DBE                          1879              
00001DBE  4EB8 1D6C               1880              JSR     STAPLOT
00001DC2                          1881  
00001DC2                          1882  *            LEA     .TSTSTR,A0
00001DC2                          1883  *            MOVE.B  #5,D0
00001DC2                          1884  *            JSR     UTLPRINT
00001DC2                          1885  *            LEA     .STR2,A0
00001DC2                          1886  *            JSR     UTLPRINT
00001DC2                          1887              
00001DC2  4E40                    1888              TRAP    #SCRUPTN                      ; ACTUALIZA DOBLE BUFFER
00001DC4                          1889  
00001DC4                          1890  
00001DC4  60E4                    1891              BRA     .LOOP
00001DC6                          1892  
00001DC6  FFFF FFFF               1893              SIMHALT
00001DCA                          1894              
00001DCA                          1895  *.TSTSTR     DC.B    'THIS IS THE TEST STRING TO BE CENTEREED',0
00001DCA                          1896  *.STR2       DC.B    'HOLA MUNDO',0
00001DCA                          1897  
00001DCA                          1898              INCLUDE 'VARS.X68'
00001DCA                          1899  ; ----------------------------------------------------------------------------
00001DCA                          1900  ; VARIABLES DEL JUEGO
00001DCA                          1901  ; ----------------------------------------------------------------------------
00001DCA                          1902  
00001DCA                          1903  ; --- VARIABLES DE LA MANZANA ------------------------------------------------
00001DCA                          1904  
00001DCA                          1905  MNZPOSX     DS.W    1                       ; COORDENADA X DE LA MANZANA
00001DCC                          1906  MNZPOSY     DS.W    1                       ; COORDENADA Y DE LA MANZANA
00001DCE                          1907  
00001DCE                          1908  ; --- VARIABLES DE LA SERPIENTE ----------------------------------------------
00001DCE                          1909  
00001DCE                          1910  CBZPOSX     DS.W    1                       ; COORDENADA X CABEZA
00001DD0                          1911  CBZPOSY     DS.W    1                       ; COORDENADA Y CABEZA
00001DD2                          1912  CBZVELX     DS.W    1                       ; VELOCIDAD X CABEZA
00001DD4                          1913  CBZVELY     DS.W    1                       ; VELOCIDAD Y CABEZA
00001DD6                          1914  COLPOSX     DS.W    1                       ; COORDENADA X COLA
00001DD8                          1915  COLPOSY     DS.W    1                       ; COORDENADA Y COLA
00001DDA                          1916  SGMPOSX     DS.W    1                       ; COORDENADA X SEGMENTO
00001DDC                          1917  SGMPOSY     DS.W    1                       ; COORDENADA Y SEGMENTO
00001DDE                          1918  SGMPOSX2    DS.W    1                       ; COORDENADA X SEGMENTO 2
00001DE0                          1919  SGMPOSY2    DS.W    1                       ; COORDENADA Y SEGMENTO 2
00001DE2                          1920  SRPVEL      DS.W    1                       ; VELOCIDAD DE LA SERPIENTE
00001DE4                          1921  
00001DE4                          1922  ; --- VARIABLES DEL MARCADOR -------------------------------------------------
00001DE4                          1923  
00001DE4                          1924  JGOPNTS     DS.W    1                       ; PUNTUACIÓN DEL JUEGO
00001DE6                          1925  
00001DE6                          1926  ; --- INTRO STATE RELATED VARIABLES ------------------------------------------
00001DE6                          1927  
00001DE6                          1928  ISCTIMER    DS.W    1                       ; INTRO TIMER
00001DE8                          1929  
00001DE8                          1930  ; --- VARIABLES RELACIONADAS CON LOS ESTADOS ---------------------------------
00001DE8                          1931  
00001DE8                          1932  STACUR      DS.W    1                       ; ESTADO ACTUAL
00001DEA                          1933  STANEXT     DS.W    1                       ; ESTADO SIGUIENTE
00001DEC                          1934  
00001DEC                          1935  
00001DEC                          1936  
00001DEC                          1937  
00001DEC                          1938  
00001DEC                          1939  
00001DEC                          1940  
00001DEC                          1941  
00001DEC                          1942  
00001DEC                          1943  
00001DEC                          1944  
00001DEC                          1945  
00001DEC                          1946  
00001DEC                          1947  
00001DEC                          1948  
00001DEC                          1949  
00001DEC                          1950  
00001DEC                          1951  
00001DEC                          1952  -------------------- end include --------------------
00001DEC                          1953              INCLUDE 'LIB/UTLVARS.X68'
00001DEC                          1954  ; =============================================================================
00001DEC                          1955  ; UTILITY VARIABLES
00001DEC                          1956  ; =============================================================================
00001DEC                          1957  
00001DEC                          1958  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001DEE                          1959              DS.W    0
00001DEE                          1960  -------------------- end include --------------------
00001DEE                          1961              INCLUDE 'SYSVARS.X68'
00001DEE                          1962  ; ----------------------------------------------------------------------------
00001DEE                          1963  ; VARIABLES DEL SISTEMA
00001DEE                          1964  ; ----------------------------------------------------------------------------
00001DEE                          1965  
00001DEE                          1966  ; --- VARIABLES DE LA MATRIZ -------------------------------------------------
00001DEE                          1967  
00001DEE                          1968  ESTDCLDS    DS.B    TCELDAS                 ; ESTADO DE LAS CELDAS 0=VACÍO  1=COLA   2=SEGMENTO  TRZPLOT=CABEZA  4?=MANZANA    
000020EE                          1969  ESTDCBZ     DS.B    1                       ; 0= DERECHA, 1=ARRIBA, 2=IZQUIERDA, 3=ABAJO
000020EF                          1970  
000020EF                          1971  ; --- VARIABLES DE TECLADO ---------------------------------------------------
000020EF                          1972  
000020EF                          1973  KBDVAL      DS.B    1
000020F0                          1974  KBDEDGE     DS.B    1                       ; KEY EDGE
000020F2                          1975  LASTKEY     DS.L    1                       
000020F6                          1976  
000020F6                          1977  ;--- TIMED INTERRUPT RELATED VARIABLES ---------------------------------------
000020F6                          1978              
000020F6                          1979  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
000020F7                          1980  SCRCYCCT    DS.B    1                       ;CYCLE COUNTER
000020F8                          1981              DS.W    0
000020F8                          1982  
000020F8                          1983  
000020F8                          1984  
000020F8                          1985  
000020F8                          1986  
000020F8                          1987  
000020F8                          1988  
000020F8                          1989  
000020F8                          1990  
000020F8                          1991  
000020F8                          1992  
000020F8                          1993  
000020F8                          1994  
000020F8                          1995  
000020F8                          1996  
000020F8                          1997  -------------------- end include --------------------
000020F8                          1998      
000020F8                          1999      
000020F8                          2000              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
APPLEINIT           15F4
APPLEPLOT           1664
APPLEUPD            1626
ARR                 115C
CBZFCOL             AA00
CBZHEIGH            14
CBZOCPD             1878
CBZPCOL             FF00
CBZPOSX             1DCE
CBZPOSY             1DD0
CBZVEL              14
CBZVELX             1DD2
CBZVELY             1DD4
CBZWIDTH            14
CHCKUPDT            163E
CHECK               1600
CHECKCLD            1922
CHKCOL              1380
CINDMTRZ            183E
CLDFREE             193A
CLNCLDS             17BA
CNVICOOR            18E6
COLFCOL             AA00
COLFND              90EE90
COLHEIGH            A
COLOCPD             18BA
COLPCOL             FF00
COLPOSX             1DD6
COLPOSY             1DD8
COLWIDTH            A
CONTINU             117C
DER                 1150
DIVX                1846
DIVY                185A
DONEPLOT            1A40
DWN                 1174
ENDDIVX             1856
ENDDIVY             186A
ENDMULTX            190A
ENDMULTY            191C
ESTDCBZ             20EE
ESTDCLDS            1DEE
FIN                 13CA
FINUPD              15AE
FONPLOT             1940
GAMINIT             176A
GAMPLOT             1794
GAMUPD              1784
GENPOSMNZ           16E2
GOVINIT             1CA4
GOVPLOT             1CA8
GOVPLOT:DONE        1CDC
GOVPLOT:TXT1        1CE2
GOVPLOT:TXT2        1CEC
GOVUPD              1CA6
HEADINIT            12E8
HEADPLOT            13D0
HEADUPD             130E
INSINIT             1AFE
INSPLOT             1B02
INSPLOT:DONE        1B1E
INSPLOT:LOOP        1B10
INSPLOT:TXT1        1B24
INSPLOT:TXT2        1B4E
INSPLOT:TXT3        1B96
INSPLOT:TXT4        1BC7
INSPLOT:TXT5        1BF3
INSPLOT:TXT6        1C0E
INSPLOT:TXT7        1C54
INSPLOT:TXTLST      1C84
INSUPD              1B00
ISCINIT             1A6A
ISCPLOT             1AA2
ISCPLOT:DONE        1AD6
ISCPLOT:TXT1        1ADC
ISCPLOT:TXT2        1AEE
ISCTIMER            1DE6
ISCUPD              1A72
ISCUPD:CONT         1A86
ISCUPD:DONE         1AA0
IZQ                 1168
JGOPNTS             1DE4
KBDDOWN             28
KBDEDGE             20F0
KBDINIT             1106
KBDLEFT             25
KBDRIGHT            27
KBDUP               26
KBDUPD              1114
KBDUPTN             1
KBDVAL              20EF
LASTKEY             20F2
LNGINI              1
MARKMNZ             1618
MAXSGM              1
MCLDVCIA            188E
MNZFCOL             FF
MNZHEIGH            14
MNZOCPD             18D0
MNZPCOL             AAFF
MNZPOSX             1DCA
MNZPOSY             1DCC
MNZWIDTH            14
MTZINIT             17AC
MTZPLOT             19FC
MTZUPD              197E
MTZUPD:CLNCLDS      198C
MULTLOOPX           18FC
MULTLOOPY           190E
NEWMNZ              1656
NOCOL               13B2
NUMCLMNS            20
NUMFILAS            18
OJOFCOL             FFFFFF
OJOHEIGH            A
OJOPCOL             0
OJOWIDTH            A
PANHEIGH            1E0
PANWIDTH            280
PLOTAPPLE           1A64
PLOTCBZ             1A4C
PLOTCLDS            1A16
PLOTCOL             1A58
PLOTSEG             1A5E
PLOTVAC             1A52
PNTSFCOL            0
PNTSTEXT            65
SCOINIT             1714
SCOPLOT             1736
SCOPLOT:TXT1        1760
SCOUPD              171C
SCRCYCCT            20F7
SCRFPS              32
SCRINIT             109A
SCRINTCT            20F6
SCRINTN             1
SCRPLOT             10EC
SCRTIM              10DE
SCRUPTN             0
SEGINIT             1454
SEGPLOT             1514
SEGUPD              1482
SGMFCOL             AA00
SGMHEIGH            14
SGMOCPD             18A4
SGMPCOL             FF00
SGMPOSX             1DDA
SGMPOSX2            1DDE
SGMPOSY             1DDC
SGMPOSY2            1DE0
SGMWIDTH            14
SIGABA              1378
SIGARR              1360
SIGDER              1354
SIGIZQ              136C
SIZECLDA            14
SNDEAT              0
SNDGMOV             1
SNDINIT             103A
SNDINIT:DONE        1058
SNDINIT:LOOP        1046
SNDINIT:SNDEAT      105E
SNDINIT:SNDGMOV     106A
SNDINIT:SNDLIST     107C
SNDPLAY             1088
SNDPLTN             2
SRPVEL              1DE2
STACUR              1DE8
STAEMPTY            1D98
STAINIT             1CFE
STANEXT             1DEA
STANONE             FFFFFFFF
STAPLOT             1D6C
STAPLOT:PLTTBL      1D88
START               1D9A
START:LOOP          1DAA
START:WINT          1DB0
STAUPD              1D0E
STAUPD:DOUPD        1D34
STAUPD:INITBL       1D4C
STAUPD:UPDTBL       1D5C
SYSINIT             1000
TAILINIT            1554
TAILPLOT            15B4
TAILUPD             1566
TCELDAS             300
UTLCHRWD            8
UTLINIT             1182
UTLPRINT            1198
UTLPRINT:ENDLOOP    11AA
UTLPRINT:LOOP       11A0
UTLRAND             11CA
UTLRAND:RANDVEC     11E8
UTLRNDIX            1DEC
