000018F2 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 25/12/2024 16:42:31

00000000                             1  *-----------------------------------------------------------------------------
00000000                             2  * Title      : MAIN
00000000                             3  * Written by :
00000000                             4  * Date       :
00000000                             5  * Description:
00000000                             6  *-----------------------------------------------------------------------------
00000000                             7  
00001000                             8              ORG    $1000
00001000                             9              
00001000                            10              INCLUDE 'CONST.X68'
00001000                            11  ; ----------------------------------------------------------------------------
00001000                            12  ; CONSTANTES DEL JUEGO
00001000                            13  ; ----------------------------------------------------------------------------
00001000                            14     
00001000                            15  ; --- CONSTANTES DE LA MANZANA -----------------------------------------------
00001000                            16  
00001000  =00000014                 17  MNZWIDTH    EQU     20                      ; ANCHURA DE LA MANZANA (a determinar)
00001000  =00000014                 18  MNZHEIGH    EQU     20                      ; ALTURA DE LA MANZANA (a determinar)
00001000  =0000AAFF                 19  MNZPCOL     EQU     $0000AAFF               ; COLOR CONTORNO MANZANA (a determinar)
00001000  =000000FF                 20  MNZFCOL     EQU     $000000FF               ; COLOR RELLENO MANZANA (a determinar)
00001000                            21  
00001000                            22  ; --- CONSTANTES DE LA SERPIENTE ---------------------------------------------
00001000                            23  
00001000  =00000001                 24  MAXSGM      EQU     1                       ; TAMAÑO MÁXIMO DE SEGMENTOS (a determinar)
00001000  =00000001                 25  LNGINI      EQU     1                       ; LONGITUD INICIAL SERPIENTE (a determinar)
00001000  =00000014                 26  SGMWIDTH    EQU     20                      ; ANCHURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 27  SGMHEIGH    EQU     20                      ; ALTURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 28  CBZVEL      EQU     20                      ; VELOCIDAD DE LA CABEZA (a determinar)
00001000  =0000FF00                 29  SGMPCOL     EQU     $0000FF00               ; COLOR CONTORNO SEGMENTO (PROVISIONAL)
00001000  =0000AA00                 30  SGMFCOL     EQU     $0000AA00               ; COLOR RELLENO SEGMENTO (PROVISIONAL)
00001000  =0000000A                 31  COLWIDTH    EQU     10                      ; ANCHURA DE LA COLA (PROVISIONAL)
00001000  =0000000A                 32  COLHEIGH    EQU     10                      ; ALTURA DE LA COLA (PROVISIONAL)
00001000  =0000FF00                 33  COLPCOL     EQU     $0000FF00               ; COLOR CONTORNO COLA (PROVISIONAL)
00001000  =0000AA00                 34  COLFCOL     EQU     $0000AA00               ; COLOR RELLENO COLA (PROVISIONAL)
00001000  =00000014                 35  CBZWIDTH    EQU     20                      ; ANCHURA DE LA CABEZA (PROVISIONAL)
00001000  =00000014                 36  CBZHEIGH    EQU     20                      ; ALTURA DE LA CABEZA (PROVISIONAL)
00001000  =0000FF00                 37  CBZPCOL     EQU     $0000FF00               ; COLOR CONTORNO CABEZA (PROVISIONAL)
00001000  =0000AA00                 38  CBZFCOL     EQU     $0000AA00               ; COLOR RELLENO CABEZA (PROVISIONAL)
00001000  =0000000A                 39  OJOWIDTH    EQU     10                      ; ANCHURA DE OJO DE SERPIENTE
00001000  =0000000A                 40  OJOHEIGH    EQU     10                      ; ALTURA DE OJO DE SERPIENTE
00001000  =00000000                 41  OJOPCOL     EQU     $00000000               ; COLOR CONTORNO OJO
00001000  =00FFFFFF                 42  OJOFCOL     EQU     $00FFFFFF               ; COLOR RELLENO OJO
00001000                            43  
00001000                            44  
00001000                            45  
00001000                            46  ; --- CONSTANTES MARCADOR ----------------------------------------------------
00001000                            47  
00001000  =00000000                 48  PNTSFCOL    EQU     $00000000               ; COLOR FONDO MARCADOR (a determinar)
00001000  =00000065                 49  PNTSTEXT    EQU     0101                    ; COORDENADAS DEL MARCADOR (a determinar)
00001000                            50  
00001000                            51  
00001000                            52  
00001000                            53  
00001000                            54  
00001000                            55  
00001000                            56  
00001000                            57  -------------------- end include --------------------
00001000                            58              INCLUDE 'SYSCONST.X68'
00001000                            59  ; ----------------------------------------------------------------------------
00001000                            60  ; CONSTANTES DEL SISTEMA
00001000                            61  ; ----------------------------------------------------------------------------
00001000                            62  
00001000                            63  ; ---CONSTANTES DE LA PANTALLA------------------------------------------------
00001000                            64  
00001000  =00000280                 65  PANWIDTH    EQU     640                     ; ANCHO DE LA PANTALLA
00001000  =000001E0                 66  PANHEIGH    EQU     480                     ; ALTURA DE LA PANTALLA
00001000  =0090EE90                 67  COLFND      EQU     $90EE90                 ; COLOR DEL FONDO DE LA PANTALLA
00001000                            68  
00001000                            69  ; ---CONSTANTES DE LA MATRIZ--------------------------------------------------
00001000                            70  
00001000  =00000014                 71  SIZECLDA    EQU     20                      ; TAMAÑO DE CADA CELDA EN PIXELES
00001000  =00000020                 72  NUMCLMNS    EQU     32                      ; COLUMNAS DE CELDAS (640/10)
00001000  =00000018                 73  NUMFILAS    EQU     24                      ; FILAS DE CELDAS (480/10)
00001000  =00000300                 74  TCELDAS     EQU     768                     ; TOTAL DE CELDAS (64 * 48)
00001000                            75  
00001000                            76  ; ---CÓDIGOS DE TECLADO-------------------------------------------------------
00001000                            77  
00001000  =00000025                 78  KBDLEFT     EQU     $25
00001000  =00000026                 79  KBDUP       EQU     $26
00001000  =00000027                 80  KBDRIGHT    EQU     $27
00001000  =00000028                 81  KBDDOWN     EQU     $28
00001000                            82  
00001000                            83  
00001000                            84  -------------------- end include --------------------
00001000                            85              INCLUDE 'SYSTEM.X68'
00001000                            86   
00001000                            87   
00001000                            88  SYSINIT
00001000                            89  ; INICIA EL  SISTEMA
00001000                            90  ; INPUT    : NONE
00001000                            91  ; OUTPUT   : NONE
00001000                            92  ; MODIFIES : NONE
00001000                            93  ; ----------------------------------------------------------------------------
00001000  4EB9 0000101E             94              JSR     SCRINIT
00001006                            95              
00001006  21FC 0000104C 0080        96              MOVE.L  #SCRPLOT,($80)
0000100E  21FC 00001074 0084        97              MOVE.L  #KBDUPD,($84)
00001016                            98              
00001016  40E7                      99              MOVE.W  SR,-(A7)
00001018  0257 DFFF                100              ANDI.W  #$DFFF,(A7)
0000101C                           101              
0000101C  4E73                     102              RTE
0000101E                           103              
0000101E                           104  ; ------------------------------------------------------------------------------
0000101E                           105  SCRINIT
0000101E                           106  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
0000101E                           107  ; ENABLE DOUBLE BUFFER.
0000101E                           108  ; INPUT    : NONE
0000101E                           109  ; OUTPUT   : NONE
0000101E                           110  ; MODIFIES : NONE
0000101E                           111  ; ------------------------------------------------------------------------------
0000101E                           112  
0000101E  48E7 C000                113              MOVEM.L D0-D1,-(A7)
00001022                           114  
00001022                           115              ; SET SCREEN RESOLUTION
00001022  103C 0021                116              MOVE.B  #33,D0
00001026  223C 028001E0            117              MOVE.L  #PANWIDTH<<16|PANHEIGH,D1
0000102C  4E4F                     118              TRAP    #15
0000102E                           119              
0000102E                           120              ; SET WINDOWED MODE
0000102E  7201                     121              MOVE.L  #1,D1
00001030  4E4F                     122              TRAP    #15
00001032                           123              
00001032                           124              ; CLEAR SCREEN
00001032  103C 000B                125              MOVE.B  #11,D0
00001036  323C FF00                126              MOVE.W  #$FF00,D1
0000103A  4E4F                     127              TRAP    #15
0000103C                           128              
0000103C                           129              ; ENABLE DOUBLE BUFFER
0000103C  103C 005C                130              MOVE.B  #92,D0
00001040  123C 0011                131              MOVE.B  #17,D1
00001044  4E4F                     132              TRAP    #15
00001046                           133              
00001046  4CDF 0003                134              MOVEM.L (A7)+,D0-D1
0000104A                           135              
0000104A  4E75                     136              RTS    
0000104C                           137  
0000104C                           138  ; ------------------------------------------------------------------------------
0000104C                           139  SCRPLOT
0000104C                           140  ; UPDATES DOUBLE BUFFER
0000104C                           141  ; INPUT    : NONE
0000104C                           142  ; OUTPUT   : NONE
0000104C                           143  ; MODIFIES : NONE
0000104C                           144  ; ------------------------------------------------------------------------------
0000104C                           145  
0000104C  48A7 C000                146              MOVEM.W D0-D1,-(A7)
00001050                           147              
00001050                           148              ; SWITCH BUFFERS
00001050  103C 005E                149              MOVE.B  #94,D0
00001054  4E4F                     150              TRAP    #15
00001056                           151              
00001056                           152              ; CLEAR HIDDEN BUFFER
00001056  103C 000B                153              MOVE.B  #11,D0
0000105A  323C FF00                154              MOVE.W  #$FF00,D1
0000105E  4E4F                     155              TRAP    #15
00001060                           156              
00001060  4C9F 0003                157              MOVEM.W (A7)+,D0-D1
00001064                           158              
00001064  4E73                     159              RTE
00001066                           160          
00001066                           161  ; ------------------------------------------------------------------------------
00001066                           162  KBDINIT
00001066                           163  ; INIT KEYBOARD
00001066                           164  ; INPUT    : NONE
00001066                           165  ; OUTPUT   : NONE
00001066                           166  ; MODIFIES : NONE
00001066                           167  ; ------------------------------------------------------------------------------
00001066                           168  
00001066  4239 00001E03            169              CLR.B   (KBDVAL)
0000106C  4239 00001E04            170              CLR.B   (KBDEDGE)
00001072  4E75                     171              RTS
00001074                           172  
00001074                           173  ; ------------------------------------------------------------------------------
00001074                           174  KBDUPD
00001074                           175  ; UPDATE KEYBOARD INFO.  
00001074                           176  ; 7 -> PAUSE
00001074                           177  ; 6 -> FIRE 3
00001074                           178  ; 5 -> FIRE 2
00001074                           179  ; 4 -> FIRE 1
00001074                           180  ; 3 -> DOWN
00001074                           181  ; 2 -> RIGHT
00001074                           182  ; 1 -> UP
00001074                           183  ; 0 -> LEFT
00001074                           184  ; INPUT    : NONE
00001074                           185  ; OUTPUT   : NONE
00001074                           186  ; MODIFIES : NONE
00001074                           187  ; ------------------------------------------------------------------------------
00001074                           188  
00001074  48E7 C000                189              MOVEM.L D0-D1,-(A7)
00001078                           190  
00001078                           191              ; LEE ESTADO DEL TECLADO
00001078  103C 0013                192              MOVE.B  #19,D0
0000107C  223C 25262728            193              MOVE.L  #KBDLEFT<<24|KBDUP<<16|KBDRIGHT<<8|KBDDOWN,D1
00001082  4E4F                     194              TRAP    #15                  ; Lee las teclas y guarda en D1
00001084                           195  
00001084  B2BC 000000FF            196              CMP.L   #$000000FF,D1
0000108A  6700 0048                197              BEQ     DWN
0000108E  B2BC 0000FF00            198              CMP.L   #$0000FF00,D1
00001094  6700 001A                199              BEQ     DER
00001098  B2BC 00FF0000            200              CMP.L   #$00FF0000,D1
0000109E  6700 001C                201              BEQ     ARR
000010A2  B2BC FF000000            202              CMP.L   #$FF000000,D1
000010A8  6700 001E                203              BEQ     IZQ
000010AC                           204  
000010AC                           205              ; Si no hay pulsaciones, mantener estado
000010AC  6000 002E                206              BRA     CONTINU
000010B0                           207  
000010B0  33FC 0000 00001E02       208  DER:        MOVE.W  #0,(ESTDCBZ)           ; Actualiza estado a DERECHA
000010B8  6000 0022                209              BRA     CONTINU
000010BC                           210              
000010BC  33FC 0001 00001E02       211  ARR:        MOVE.W  #1,(ESTDCBZ)           ; Actualiza estado a ARRIBA
000010C4  6000 0016                212              BRA     CONTINU
000010C8                           213  
000010C8  33FC 0002 00001E02       214  IZQ:        MOVE.W  #2,(ESTDCBZ)           ; Actualiza estado a IZQUIERDA
000010D0  6000 000A                215              BRA     CONTINU                    
000010D4                           216  
000010D4  33FC 0003 00001E02       217  DWN:        MOVE.W  #3,(ESTDCBZ)           ; Actualiza estado a ABAJO
000010DC                           218  
000010DC                           219  CONTINU:
000010DC  4CDF 0003                220              MOVEM.L (A7)+,D0-D1
000010E0  4E73                     221              RTE
000010E2                           222              
000010E2                           223  ; RESIDUOS CODIGO ANTERIOR 
000010E2                           224  
000010E2                           225              ;MOVE.B  D2,(KBDVAL)
000010E2                           226              
000010E2                           227  
000010E2                           228  
000010E2                           229  
000010E2                           230  
000010E2                           231  ; CODIGO ANTERIOR ANTERIOR
000010E2                           232  
000010E2                           233  
000010E2                           234  
000010E2                           235  
000010E2                           236  
000010E2                           237  
000010E2                           238  
000010E2                           239  
000010E2                           240  
000010E2                           241  
000010E2                           242  
000010E2                           243  
000010E2                           244  
000010E2                           245  
000010E2                           246  
000010E2                           247  
000010E2                           248  
000010E2                           249  
000010E2                           250  
000010E2                           251  
000010E2                           252  
000010E2                           253  
000010E2                           254  
000010E2                           255  
000010E2                           256  
000010E2                           257  
000010E2                           258  
000010E2                           259  
000010E2                           260  
000010E2                           261  
000010E2                           262  
000010E2                           263  
000010E2                           264  
000010E2                           265  
000010E2                           266  
000010E2                           267  
000010E2                           268  
000010E2                           269  
000010E2                           270  -------------------- end include --------------------
000010E2                           271              INCLUDE 'LIB/UTLCODE.X68'
000010E2                           272  ; =============================================================================
000010E2                           273  ; UTILITY CODE
000010E2                           274  ; =============================================================================
000010E2                           275  
000010E2                           276  ; -----------------------------------------------------------------------------
000010E2                           277  UTLINIT
000010E2                           278  ; INITIALIZES UTILITY CODE
000010E2                           279  ; INPUT    - NONE
000010E2                           280  ; OUTPUT   - NONE
000010E2                           281  ; MODIFIES - NONE
000010E2                           282  ; -----------------------------------------------------------------------------
000010E2  48E7 C000                283              MOVEM.L D0-D1,-(A7)
000010E6  103C 0008                284              MOVE.B  #8,D0
000010EA  4E4F                     285              TRAP    #15
000010EC  13C1 00001B00            286              MOVE.B  D1,(UTLRNDIX)
000010F2  4CDF 0003                287              MOVEM.L (A7)+,D0-D1
000010F6  4E75                     288              RTS
000010F8                           289  
000010F8                           290  ; -----------------------------------------------------------------------------
000010F8                           291  UTLRAND
000010F8                           292  ; PROVIDES A PSEUDO-RANDOM BYTE
000010F8                           293  ; INPUT    - NONE
000010F8                           294  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000010F8                           295  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010F8                           296  ; -----------------------------------------------------------------------------
000010F8  2F08                     297              MOVE.L  A0,-(A7)
000010FA  41F9 00001116            298              LEA     .RANDVEC,A0
00001100  4280                     299              CLR.L   D0
00001102  1039 00001B00            300              MOVE.B  (UTLRNDIX),D0
00001108  1030 0800                301              MOVE.B  (A0,D0.L),D0
0000110C  5239 00001B00            302              ADDQ.B  #1,(UTLRNDIX)
00001112  205F                     303              MOVE.L  (A7)+,A0
00001114  4E75                     304              RTS
00001116                           305  
00001116                           306  
00001116= A2 EE 9A 0C F5 24 ...    307  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000111E= 2A A3 51 26 E0 AC ...    308              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001126= 75 51 CA FD 33 EB ...    309              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000112E= 60 CC E7 B8 9A EB ...    310              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001136= 1D 76 B5 95 B0 89 ...    311              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
0000113E= 39 15 48 C9 6E CA ...    312              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001146= 43 E7 E2 7C 37 25 ...    313              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
0000114E= E9 94 CE E9 E4 52 ...    314              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001156= 37 6D 9A 84 A2 28 ...    315              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
0000115E= 19 E2 C6 77 80 D4 ...    316              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001166= 0A 5A 32 67 33 C2 ...    317              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
0000116E= 59 80 DC 0E 57 FC ...    318              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001176= 8A AB BC F7 07 4D ...    319              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
0000117E= EF D5 77 6E 1E BB ...    320              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001186= D6 E0 2A 8F BD 28 ...    321              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
0000118E= 13 4F 66 EC 0A 64 ...    322              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001196= 56 52 9A 16 9B 90 ...    323              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000119E= 06 8A A4 F7 01 DA ...    324              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000011A6= F2 E7 77 28 B1 76 ...    325              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
000011AE= A4 42 E3 81 B1 67 ...    326              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000011B6= BF CE FA 16 BF 38 ...    327              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000011BE= D1 8B 50 0C 5F 49 ...    328              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
000011C6= DE 4C 14 A2 40 DC ...    329              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
000011CE= B6 9B 0A 38 5D AB ...    330              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
000011D6= E2 1B DD 75 15 82 ...    331              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000011DE= 8A 26 51 30 9F 47 ...    332              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000011E6= 1E 8A BB 71 C6 6E ...    333              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000011EE= 9F 47 E5 34 94 27 ...    334              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000011F6= 7D 06 D6 BA 30 0F ...    335              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000011FE= EC 7F 7E 03 CF 2D ...    336              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001206= 94 5B 23 F2 8B CD ...    337              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000120E= 74 33 EC B9 0F D5 ...    338              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
0000120E= 74 33 EC B9 0F D5 ...    339  -------------------- end include --------------------
00001216                           340              INCLUDE 'HEADSRP.X68'
00001216                           341  
00001216                           342  ; ------------------------------------------------------------------------------
00001216                           343  HEADINIT
00001216                           344  ; INICIALIZAR CABEZA.
00001216                           345  ; INPUT    : NONE 
00001216                           346  ; OUTPUT   : NONE
00001216                           347  ; MODIFIES : NONE
00001216                           348  ; ------------------------------------------------------------------------------
00001216  33FC 0140 00001954       349              MOVE.W  #PANWIDTH/2,(CBZPOSX)
0000121E  33FC 00F0 00001956       350              MOVE.W  #PANHEIGH/2,(CBZPOSY)
00001226  4279 00001964            351              CLR     (TRZPLOT)
0000122C  13FC 0003 00001964       352              MOVE.B  #3,(TRZPLOT)
00001234  4279 00001E02            353              CLR.W   (ESTDCBZ)
0000123A  33FC 0000 00001E02       354              MOVE.W  #0,(ESTDCBZ)
00001242  4E75                     355              RTS
00001244                           356              
00001244                           357  ; ------------------------------------------------------------------------------
00001244                           358  HEADUPD
00001244                           359  ; ACTUALIZAR CABEZA.
00001244                           360  ; INPUT    : NONE 
00001244                           361  ; OUTPUT   : NONE
00001244                           362  ; MODIFIES : NONE
00001244                           363  ; ------------------------------------------------------------------------------
00001244                           364  
00001244  48A7 E000                365              MOVEM.W D0-D2,-(A7)            ; Guardar registros
00001248                           366  
00001248                           367  
00001248                           368              ; Marcar celda actual como vacía
00001248  3239 00001954            369              MOVE.W  (CBZPOSX),D1
0000124E  3439 00001956            370              MOVE.W  (CBZPOSY),D2
00001254  4EB9 000016C2            371              JSR     CINDMTRZ
0000125A  4EB9 00001728            372              JSR     MCLDVCIA               ; RESTAMOS 1 A LA CELDA ACTUAL
00001260                           373              
00001260                           374              
00001260                           375              ; Actualiza la posición de la cabeza según ESTDCBZ
00001260                           376              ;CLR.W   D0
00001260  3039 00001E02            377              MOVE.W  (ESTDCBZ),D0
00001266  B07C 0000                378              CMP.W   #0,D0
0000126A  6700 001E                379              BEQ     SIGDER
0000126E  B07C 0001                380              CMP.W   #1,D0
00001272  6700 0022                381              BEQ     SIGARR
00001276  B07C 0002                382              CMP.W   #2,D0
0000127A  6700 0026                383              BEQ     SIGIZQ
0000127E  B07C 0003                384              CMP.W   #3,D0
00001282  6700 002A                385              BEQ     SIGABA
00001286                           386  
00001286                           387  
00001286                           388  
00001286                           389              ; Si no hay dirección válida, sale
00001286  6000 0072                390              BRA     FIN
0000128A                           391  
0000128A                           392  SIGDER:
0000128A  0679 0014 00001954       393              ADD.W   #CBZVEL, (CBZPOSX)
00001292  6000 0022                394              BRA     CHKCOL
00001296                           395  
00001296                           396  SIGARR:
00001296  0479 0014 00001956       397              SUB.W   #CBZVEL, (CBZPOSY)
0000129E  6000 0016                398              BRA     CHKCOL
000012A2                           399  
000012A2                           400  SIGIZQ:
000012A2  0479 0014 00001954       401              SUB.W   #CBZVEL, (CBZPOSX)
000012AA  6000 000A                402              BRA     CHKCOL
000012AE                           403  
000012AE                           404  SIGABA:
000012AE  0679 0014 00001956       405              ADD.W   #CBZVEL, (CBZPOSY)
000012B6                           406              
000012B6                           407  CHKCOL:
000012B6                           408              ; Verifica la colisión con la manzana
000012B6  3239 00001954            409              MOVE.W  (CBZPOSX),D1
000012BC  3439 00001956            410              MOVE.W  (CBZPOSY),D2
000012C2  B279 00001950            411              CMP.W   (MNZPOSX),D1
000012C8  6600 0018                412              BNE     NOCOL
000012CC  B479 00001952            413              CMP.W   (MNZPOSY),D2
000012D2  6600 000E                414              BNE     NOCOL
000012D6                           415              
000012D6                           416              ; Colisión detectada
000012D6  4EB9 000014F6            417              JSR     APPLEUPD
000012DC  4EB9 000015FA            418              JSR     SCOUPD
000012E2                           419              
000012E2                           420              
000012E2                           421  
000012E2                           422  NOCOL:
000012E2                           423              ; Convierte la posición nueva a índice
000012E2  3239 00001954            424              MOVE.W  (CBZPOSX),D1
000012E8  3439 00001956            425              MOVE.W  (CBZPOSY),D2
000012EE  4EB9 000016C2            426              JSR     CINDMTRZ
000012F4  4EB9 000016FC            427              JSR     CBZOCPD                 ; Marca la celda como ocupada
000012FA                           428  
000012FA                           429  
000012FA                           430  FIN:
000012FA  4C9F 0007                431              MOVEM.W (A7)+,D0-D2
000012FE                           432  
000012FE  4E75                     433              RTS
00001300                           434              
00001300                           435  ; ------------------------------------------------------------------------------
00001300                           436  HEADPLOT
00001300                           437  ; DIBUJAR CABEZA.
00001300                           438  ; INPUT    : NONE 
00001300                           439  ; OUTPUT   : NONE
00001300                           440  ; MODIFIES : NONE
00001300                           441  ; ------------------------------------------------------------------------------
00001300                           442                         
00001300  3F00                     443              MOVE.W  D0,-(A7)               ; GUARDAMOS D0
00001302  3003                     444              MOVE.W  D3,D0                  ; PONEMOS EL INDICE DE LA CELDA EN D0 PARA CALCULAR SUS COORDENADAS
00001304  4EB9 00001780            445              JSR     CNVICOOR
0000130A  2F01                     446              MOVE.L  D1,-(A7)
0000130C                           447              
0000130C                           448              ; SET COLOR DEL CONTORNO CABEZA
0000130C  103C 0050                449              MOVE.B  #80,D0
00001310  223C 0000FF00            450              MOVE.L  #CBZPCOL,D1
00001316  4E4F                     451              TRAP    #15
00001318                           452              
00001318                           453              ; SET COLOR DEL RELLENO CABEZA
00001318  103C 0051                454              MOVE.B  #81,D0
0000131C  223C 0000AA00            455              MOVE.L  #CBZFCOL,D1
00001322  4E4F                     456              TRAP    #15
00001324                           457              
00001324                           458              ; DIBUJAR CABEZA
00001324  103C 0057                459              MOVE.B  #87,D0
00001328  221F                     460              MOVE.L  (A7)+,D1
0000132A  3F03                     461              MOVE.W  D3,-(A7)
0000132C  3601                     462              MOVE.W  D1,D3
0000132E  0643 0014                463              ADD.W   #CBZWIDTH,D3
00001332  3802                     464              MOVE.W  D2,D4
00001334  0644 0014                465              ADD.W   #CBZHEIGH,D4
00001338  4E4F                     466              TRAP    #15
0000133A                           467              
0000133A  2F01                     468              MOVE.L  D1,-(A7)
0000133C                           469              
0000133C                           470              ; SET COLOR DEL CONTORNO OJO
0000133C  103C 0050                471              MOVE.B  #80,D0
00001340  7200                     472              MOVE.L  #OJOPCOL,D1
00001342  4E4F                     473              TRAP    #15
00001344                           474              
00001344                           475              ; SET COLOR DEL RELLENO OJO
00001344  103C 0051                476              MOVE.B  #81,D0
00001348  223C 00FFFFFF            477              MOVE.L  #OJOFCOL,D1
0000134E  4E4F                     478              TRAP    #15
00001350                           479              
00001350                           480              ; DIBUJAR OJO
00001350  103C 0058                481              MOVE.B  #88,D0
00001354  221F                     482              MOVE.L  (A7)+,D1
00001356  2F01                     483              MOVE.L  D1,-(A7)
00001358  2F02                     484              MOVE.L  D2,-(A7)
0000135A  5A41                     485              ADD.W   #OJOWIDTH/2,D1            
0000135C  3601                     486              MOVE.W  D1,D3
0000135E  0643 000A                487              ADD.W   #OJOWIDTH,D3
00001362  5A42                     488              ADD.W   #OJOHEIGH/2,D2
00001364  3802                     489              MOVE.W  D2,D4
00001366  0644 000A                490              ADD.W   #OJOHEIGH,D4
0000136A  4E4F                     491              TRAP    #15                     ; DIBUJAMOS EL PRIMER OJO
0000136C                           492              
0000136C                           493  
0000136C                           494              ; DEFINIR COORDENADAS IRIS
0000136C  241F                     495              MOVE.L  (A7)+,D2
0000136E  221F                     496              MOVE.L  (A7)+,D1
00001370  0641 000A                497              ADD.W   #OJOWIDTH,D1
00001374  0642 000A                498              ADD.W   #OJOHEIGH,D2
00001378  103C 0052                499              MOVE.B  #82,D0
0000137C  4E4F                     500              TRAP    #15                     ; DIBUJAMOS EL PRIMER IRIS
0000137E                           501              
0000137E  361F                     502              MOVE.W  (A7)+,D3
00001380  301F                     503              MOVE.W  (A7)+,D0
00001382                           504  
00001382  4E75                     505              RTS
00001384                           506  
00001384                           507  
00001384                           508  
00001384                           509  
00001384                           510  
00001384                           511  
00001384                           512  
00001384                           513  
00001384                           514  
00001384                           515  
00001384                           516  
00001384                           517  
00001384                           518  
00001384                           519  
00001384                           520  
00001384                           521  
00001384                           522  
00001384                           523  
00001384                           524  
00001384                           525  
00001384                           526  
00001384                           527  
00001384                           528  
00001384                           529  
00001384                           530  
00001384                           531  
00001384                           532  
00001384                           533  
00001384                           534  
00001384                           535  -------------------- end include --------------------
00001384                           536              INCLUDE 'SEGSRP.X68'
00001384                           537  
00001384                           538  ; ------------------------------------------------------------------------------
00001384                           539  SEGINIT
00001384                           540  ; INICIALIZAR SEGMENTO.
00001384                           541  ; INPUT    : NONE 
00001384                           542  ; OUTPUT   : NONE
00001384                           543  ; MODIFIES : NONE
00001384                           544  ; ------------------------------------------------------------------------------
00001384  33FC 012C 00001960       545              MOVE.W  #(PANWIDTH/2)-CBZWIDTH,(SGMPOSX)
0000138C  33FC 00F0 00001962       546              MOVE.W  #PANHEIGH/2,(SGMPOSY)
00001394  4E75                     547              RTS
00001396                           548              
00001396                           549  ; ------------------------------------------------------------------------------
00001396                           550  SEGUPD
00001396                           551  ; ACTUALIZAR SEGMENTO.
00001396                           552  ; INPUT    : NONE 
00001396                           553  ; OUTPUT   : NONE
00001396                           554  ; MODIFIES : NONE
00001396                           555  ; ------------------------------------------------------------------------------
00001396  48A7 6000                556              MOVEM.W D1-D2,-(A7)
0000139A                           557              
0000139A                           558              ; Marcar posición anterior del segmento como vacía
0000139A  3239 00001960            559              MOVE.W  (SGMPOSX),D1             ; Cargar posición X actual del segmento
000013A0  3439 00001962            560              MOVE.W  (SGMPOSY),D2             ; Cargar posición Y actual del segmento
000013A6  4EB9 000016C2            561              JSR     CINDMTRZ                ; Obtener índice de celda en D0
000013AC  4EB9 00001728            562              JSR     MCLDVCIA                ; Marcar celda como vacía
000013B2                           563              
000013B2                           564              ; Actualizar posición del segmento para seguir a la cabeza
000013B2  33F9 00001954 00001960   565              MOVE.W  (CBZPOSX),(SGMPOSX)        ; Actualizar X del segmento con la X de la cabeza
000013BC  33F9 00001956 00001962   566              MOVE.W  (CBZPOSY),(SGMPOSY)        ; Actualizar Y del segmento con la Y de la cabeza
000013C6                           567  
000013C6                           568              ; Marcar nueva posición del segmento como ocupada
000013C6  3239 00001960            569              MOVE.W  (SGMPOSX),D1             ; Cargar nueva posición X
000013CC  3439 00001962            570              MOVE.W  (SGMPOSY),D2             ; Cargar nueva posición Y
000013D2  4EB9 000016C2            571              JSR     CINDMTRZ                ; Obtener índice de celda en D0
000013D8  4EB9 0000173E            572              JSR     SGMOCPD                 ; Marcar celda como ocupada por segmento
000013DE                           573              
000013DE                           574              
000013DE  4C9F 0006                575              MOVEM.W (A7)+,D1-D2            
000013E2  4E75                     576              RTS
000013E4                           577              
000013E4                           578  ; ------------------------------------------------------------------------------
000013E4                           579  SEGPLOT
000013E4                           580  ; DIBUJAR SEGMENTO.
000013E4                           581  ; INPUT    : NONE 
000013E4                           582  ; OUTPUT   : NONE
000013E4                           583  ; MODIFIES : NONE
000013E4                           584  ; ------------------------------------------------------------------------------
000013E4  3F00                     585              MOVE.W  D0,-(A7)
000013E6  3003                     586              MOVE.W  D3,D0
000013E8  4EB9 00001780            587              JSR     CNVICOOR
000013EE  2F01                     588              MOVE.L  D1,-(A7)
000013F0                           589              
000013F0  103C 0050                590              MOVE.B  #80,D0
000013F4  223C 0000FF00            591              MOVE.L  #SGMPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DEL SEGMENTO
000013FA  4E4F                     592              TRAP    #15
000013FC                           593              
000013FC  103C 0051                594              MOVE.B  #81,D0
00001400  223C 0000AA00            595              MOVE.L  #SGMFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DEL SEGMENTO
00001406  4E4F                     596              TRAP    #15
00001408                           597              
00001408  103C 0057                598              MOVE.B  #87,D0
0000140C  221F                     599              MOVE.L  (A7)+,D1
0000140E  3F03                     600              MOVE.W  D3,-(A7)
00001410  3601                     601              MOVE.W  D1,D3
00001412  0643 0014                602              ADD.W   #SIZECLDA,D3
00001416  3802                     603              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001418  0644 0014                604              ADD.W   #SIZECLDA,D4
0000141C  4E4F                     605              TRAP    #15                     
0000141E                           606                          
0000141E  361F                     607              MOVE.W  (A7)+,D3  
00001420  301F                     608              MOVE.W  (A7)+,D0
00001422                           609  
00001422                           610  
00001422  4E75                     611              RTS
00001424                           612  
00001424                           613  
00001424                           614  
00001424                           615  
00001424                           616  
00001424                           617  
00001424                           618  
00001424                           619  
00001424                           620  
00001424                           621  
00001424                           622  
00001424                           623  -------------------- end include --------------------
00001424                           624              INCLUDE 'TAILSRP.X68'
00001424                           625     
00001424                           626  ; ------------------------------------------------------------------------------
00001424                           627  TAILINIT
00001424                           628  ; INICIALIZAR COLA.
00001424                           629  ; INPUT    : NONE 
00001424                           630  ; OUTPUT   : NONE
00001424                           631  ; MODIFIES : NONE
00001424                           632  ; ------------------------------------------------------------------------------
00001424                           633  
00001424  33FC 011D 0000195C       634              MOVE.W  #(PANWIDTH/2)-CBZWIDTH-SGMWIDTH+(COLWIDTH/2),(COLPOSX)
0000142C  33FC 00F0 0000195E       635              MOVE.W  #(PANHEIGH/2),(COLPOSY)
00001434                           636              
00001434  4E75                     637              RTS
00001436                           638              
00001436                           639              
00001436                           640  ; ------------------------------------------------------------------------------
00001436                           641  TAILUPD
00001436                           642  ; ACTUALIZAR COLA.
00001436                           643  ; INPUT    : NONE 
00001436                           644  ; OUTPUT   : NONE
00001436                           645  ; MODIFIES : NONE
00001436                           646  ; ------------------------------------------------------------------------------
00001436  48A7 6000                647              MOVEM.W D1-D2,-(A7)
0000143A                           648              
0000143A                           649              ; Marca la posición actual de la cola como vacía
0000143A  3239 0000195C            650              MOVE.W  (COLPOSX),D1
00001440  3439 0000195E            651              MOVE.W  (COLPOSY),D2
00001446  4EB9 000016C2            652              JSR     CINDMTRZ
0000144C  4EB9 00001728            653              JSR     MCLDVCIA
00001452                           654              ; Actualiza la posición de la cola para seguir al último segmento
00001452  33F9 00001960 0000195C   655              MOVE.W  (SGMPOSX),(COLPOSX)
0000145C  33F9 00001962 0000195E   656              MOVE.W  (SGMPOSY),(COLPOSY)
00001466                           657  
00001466                           658              ; Marca la nueva posición como cola
00001466  3239 0000195C            659              MOVE.W  (COLPOSX),D1
0000146C  3439 0000195E            660              MOVE.W  (COLPOSY),D2
00001472  4EB9 000016C2            661              JSR     CINDMTRZ
00001478  4EB9 00001754            662              JSR     COLOCPD
0000147E                           663  
0000147E                           664  ; CRECER SEGMENTOS
0000147E                           665              
0000147E                           666  
0000147E                           667  FINUPD
0000147E  4C9F 0006                668              MOVEM.W (A7)+,D1-D2
00001482  4E75                     669              RTS
00001484                           670              
00001484                           671  ; ------------------------------------------------------------------------------
00001484                           672  TAILPLOT
00001484                           673  ; DIBUJAR COLA
00001484                           674  ; INPUT    : NONE 
00001484                           675  ; OUTPUT   : NONE
00001484                           676  ; MODIFIES : NONE
00001484                           677  ; ------------------------------------------------------------------------------
00001484                           678  
00001484                           679              ; Itera sobre cada segmento de la cola y lo dibuja
00001484                           680              ; Convierte la posición de segmento actual a coordenadas
00001484                           681  
00001484                           682              ; Dibuja segmento actual
00001484                           683  
00001484                           684              ; Ir al siguiente segmento
00001484                           685              ; (Lógica de iteración según cómo estén almacenados los segmentos)
00001484                           686  
00001484                           687  
00001484                           688  
00001484                           689  
00001484                           690  
00001484                           691  
00001484                           692  
00001484                           693  
00001484                           694  
00001484  3F00                     695              MOVE.W  D0,-(A7)
00001486  3003                     696              MOVE.W  D3,D0
00001488  4EB9 00001780            697              JSR     CNVICOOR
0000148E  2F01                     698              MOVE.L  D1,-(A7)
00001490                           699              
00001490  103C 0050                700              MOVE.B  #80,D0
00001494  223C 0000FF00            701              MOVE.L  #COLPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA COLA
0000149A  4E4F                     702              TRAP    #15
0000149C                           703              
0000149C  103C 0051                704              MOVE.B  #81,D0
000014A0  223C 0000AA00            705              MOVE.L  #COLFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA COLA
000014A6  4E4F                     706              TRAP    #15
000014A8                           707              
000014A8  103C 0057                708              MOVE.B  #87,D0
000014AC  221F                     709              MOVE.L  (A7)+,D1
000014AE  3F03                     710              MOVE.W  D3,-(A7)
000014B0  3601                     711              MOVE.W  D1,D3
000014B2  0643 0014                712              ADD.W   #SIZECLDA,D3
000014B6  3802                     713              MOVE.W  D2,D4                    
000014B8  0644 0014                714              ADD.W   #SIZECLDA,D4
000014BC  4E4F                     715              TRAP    #15                    ; DIBUJAMOS EL CUADRADO 
000014BE                           716                          
000014BE  361F                     717              MOVE.W  (A7)+,D3  
000014C0  301F                     718              MOVE.W  (A7)+,D0
000014C2                           719  
000014C2  4E75                     720              RTS
000014C4                           721  
000014C4                           722  
000014C4                           723  
000014C4                           724  
000014C4                           725  
000014C4                           726  
000014C4                           727  
000014C4                           728  
000014C4                           729  
000014C4                           730  
000014C4                           731  
000014C4                           732  
000014C4                           733  
000014C4                           734  
000014C4                           735  
000014C4                           736  
000014C4                           737  -------------------- end include --------------------
000014C4                           738              INCLUDE 'APPLE.X68'
000014C4                           739     
000014C4                           740  ; ------------------------------------------------------------------------------
000014C4                           741  APPLEINIT
000014C4                           742  ; Inicializa la manzana en una posición aleatoria
000014C4                           743  ; INPUT    : NONE 
000014C4                           744  ; OUTPUT   : NONE
000014C4                           745  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
000014C4                           746  ; ------------------------------------------------------------------------------
000014C4                           747  
000014C4                           748              ; Llama a la función para generar la posición aleatoria
000014C4  4EB9 000015C0            749              JSR     GENPOSMNZ
000014CA                           750  
000014CA                           751              ; Convierte las coordenadas de la manzana a índice de la matriz
000014CA  4EB9 000016C2            752              JSR     CINDMTRZ
000014D0                           753  
000014D0                           754              ; Verifica si la celda está ocupada o libre
000014D0                           755  CHECK:
000014D0  4EB9 000017BC            756              JSR     CHECKCLD
000014D6  6700 0010                757              BEQ     MARKMNZ                  ; Si está libre
000014DA                           758  
000014DA                           759              ; Si la celda está ocupada
000014DA  4EB9 000015C0            760              JSR     GENPOSMNZ                ; Genera una nueva posición
000014E0  4EB9 000016C2            761              JSR     CINDMTRZ                 ; Convierte las nuevas coordenadas
000014E6  60E8                     762              BRA     CHECK                    ; Repite la comprobación
000014E8                           763  
000014E8                           764  MARKMNZ:
000014E8                           765              ; Marca la celda como ocupada con la manzana (estado 4)
000014E8  4EB9 0000176A            766              JSR     MNZOCPD
000014EE                           767  
000014EE                           768              ; Dibuja la manzana en la pantalla
000014EE  4EB9 00001542            769              JSR     APPLEPLOT
000014F4                           770  
000014F4  4E75                     771              RTS
000014F6                           772              
000014F6                           773              ;MOVE.W  #30,(MNZPOSX)   ;DE MOMENTO PONGO X E Y ELEGIDAS MANUALMENTE, EN TEORÍA DEBE SER ALEATORIO
000014F6                           774              ;MOVE.W  #30,(MNZPOSY)
000014F6                           775  
000014F6                           776  ; ------------------------------------------------------------------------------
000014F6                           777  APPLEUPD
000014F6                           778  ; Actualiza la posición de la manzana cuando la serpiente come
000014F6                           779  ; INPUT    : NONE 
000014F6                           780  ; OUTPUT   : NONE
000014F6                           781  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
000014F6                           782  ; ------------------------------------------------------------------------------
000014F6                           783  
000014F6                           784              ; Incrementar el tamaño de la serpiente
000014F6  3039 00001966            785              MOVE.W  NUMSGMS, D0
000014FC  5240                     786              ADD.W   #1,D0
000014FE  33C0 00001966            787              MOVE.W  D0,(NUMSGMS)
00001504                           788  
00001504                           789              ; Convierte las coordenadas actuales de la manzana a índice de la matriz
00001504  4EB9 000016C2            790              JSR     CINDMTRZ
0000150A                           791  
0000150A                           792              ; Marca la celda anterior como vacía
0000150A  4EB9 00001728            793              JSR     MCLDVCIA
00001510                           794  
00001510                           795              ; Llama a la función para generar una nueva posición aleatoria
00001510  4EB9 000015C0            796              JSR     GENPOSMNZ
00001516                           797  
00001516                           798              ; Convierte las nuevas coordenadas de la manzana a índice de la matriz
00001516  4EB9 000016C2            799              JSR     CINDMTRZ
0000151C                           800  
0000151C                           801  CHCKUPDT:
0000151C  4EB9 000017BC            802              JSR     CHECKCLD             ; Verifica si la celda está libre
00001522  6700 0010                803              BEQ     NEWMNZ               ; Si está libre
00001526                           804  
00001526                           805              ; Si la celda está ocupada
00001526  4EB9 000015C0            806              JSR     GENPOSMNZ            ; Genera una nueva posición
0000152C  4EB9 000016C2            807              JSR     CINDMTRZ             ; Convierte las nuevas coordenadas
00001532  60E8                     808              BRA     CHCKUPDT             ; Repite la comprobación
00001534                           809  
00001534                           810  NEWMNZ:
00001534                           811              ; Marca la celda como ocupada con la manzana (estado 4)
00001534  4EB9 0000176A            812              JSR     MNZOCPD
0000153A                           813  
0000153A                           814              ; Dibuja la nueva manzana en la pantalla
0000153A  4EB9 00001542            815              JSR     APPLEPLOT
00001540                           816  
00001540  4E75                     817              RTS
00001542                           818              
00001542                           819  ; ------------------------------------------------------------------------------
00001542                           820  APPLEPLOT
00001542                           821  ; Dibuja la manzana
00001542                           822  ; INPUT    : NONE 
00001542                           823  ; OUTPUT   : NONE
00001542                           824  ; MODIFIES : NONE
00001542                           825  ; ------------------------------------------------------------------------------
00001542  3F00                     826              MOVE.W  D0,-(A7)
00001544  3003                     827              MOVE.W  D3,D0
00001546  4EB9 00001780            828              JSR     CNVICOOR
0000154C  2F01                     829              MOVE.L  D1,-(A7)                ; PRIMERO DEBEMOS DIBUJAR EL FONDO Y LUEGO LA MANZANA
0000154E                           830              
0000154E  103C 0050                831              MOVE.B  #80,D0
00001552  223C 0090EE90            832              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001558  4E4F                     833              TRAP    #15
0000155A                           834              
0000155A  103C 0051                835              MOVE.B  #81,D0
0000155E  223C 0090EE90            836              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001564  4E4F                     837              TRAP    #15
00001566                           838              
00001566  103C 0057                839              MOVE.B  #87,D0
0000156A  221F                     840              MOVE.L  (A7)+,D1
0000156C  3F03                     841              MOVE.W  D3,-(A7)
0000156E  3601                     842              MOVE.W  D1,D3
00001570  0643 0014                843              ADD.W   #SIZECLDA,D3
00001574  3802                     844              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001576  0644 0014                845              ADD.W   #SIZECLDA,D4
0000157A  4E4F                     846              TRAP    #15                     
0000157C                           847                          
0000157C  361F                     848              MOVE.W  (A7)+,D3  
0000157E  301F                     849              MOVE.W  (A7)+,D0
00001580                           850  
00001580  3F00                     851              MOVE.W  D0,-(A7)
00001582  3003                     852              MOVE.W  D3,D0
00001584  4EB9 00001780            853              JSR     CNVICOOR
0000158A  2F01                     854              MOVE.L  D1,-(A7)
0000158C                           855              
0000158C  103C 0050                856              MOVE.B  #80,D0
00001590  223C 0000AAFF            857              MOVE.L  #MNZPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA MANZANA
00001596  4E4F                     858              TRAP    #15
00001598                           859              
00001598  103C 0051                860              MOVE.B  #81,D0
0000159C  223C 000000FF            861              MOVE.L  #MNZFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA MANZANA
000015A2  4E4F                     862              TRAP    #15
000015A4                           863              
000015A4  103C 0058                864              MOVE.B  #88,D0
000015A8  221F                     865              MOVE.L  (A7)+,D1
000015AA  3F03                     866              MOVE.W  D3,-(A7)
000015AC  3601                     867              MOVE.W  D1,D3
000015AE  0643 0014                868              ADD.W   #SIZECLDA,D3
000015B2  3802                     869              MOVE.W  D2,D4                    ; DIBUJAMOS EL CIRCULO
000015B4  0644 0014                870              ADD.W   #SIZECLDA,D4
000015B8  4E4F                     871              TRAP    #15                     
000015BA                           872                          
000015BA  361F                     873              MOVE.W  (A7)+,D3  
000015BC  301F                     874              MOVE.W  (A7)+,D0
000015BE                           875  
000015BE                           876  
000015BE  4E75                     877              RTS
000015C0                           878  ; ----------------------------------------------------------------------------
000015C0                           879  GENPOSMNZ
000015C0                           880  ; Genera una posición aleatoria para la manzana
000015C0                           881  ; INPUT: NONE
000015C0                           882  ; OUTPUT:
000015C0                           883  ; MODIFIES: MNZPOSX, MNZPOSY
000015C0                           884  ; ----------------------------------------------------------------------------
000015C0                           885  
000015C0  48E7 8000                886              MOVEM.L D0,-(A7)
000015C4                           887  
000015C4                           888              ; Genera la coordenada X aleatoria
000015C4  4EB8 10F8                889              JSR     UTLRAND
000015C8  0240 001F                890              ANDI.W  #NUMCLMNS-1, D0       ; Asegura que esté en [0, NUMCLMNS-1]
000015CC  C0FC 0014                891              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
000015D0  3200                     892              MOVE.W  D0,D1
000015D2  33C0 00001950            893              MOVE.W  D0, MNZPOSX           ; Guarda la coordenada X generada
000015D8                           894              
000015D8                           895              ; Generar coordenada Y aleatoria
000015D8  4EB8 10F8                896              JSR     UTLRAND
000015DC  0240 0017                897              ANDI.W  #NUMFILAS-1, D0       ; Asegura que esté en el rango [0, NUMFILAS-1]
000015E0  C0FC 0014                898              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
000015E4  3400                     899              MOVE.W  D0,D2
000015E6  33C0 00001952            900              MOVE.W  D0, MNZPOSY           ; Guarda la coordenada Y generada
000015EC                           901              
000015EC  4CDF 0001                902              MOVEM.L (A7)+,D0
000015F0  4E75                     903              RTS 
000015F2                           904  
000015F2                           905  
000015F2                           906  
000015F2                           907  
000015F2                           908  -------------------- end include --------------------
000015F2                           909              INCLUDE 'SCORE.X68'
000015F2                           910     
000015F2                           911  ; ------------------------------------------------------------------------------
000015F2                           912  SCOINIT
000015F2                           913  ; INICIALIZAR MARCADOR.
000015F2                           914  ; INPUT    : NONE 
000015F2                           915  ; OUTPUT   : NONE
000015F2                           916  ; MODIFIES : NONE
000015F2                           917  ; ------------------------------------------------------------------------------
000015F2  4279 00001AFE            918              CLR.W   (JGOPNTS)
000015F8  4E75                     919              RTS
000015FA                           920              
000015FA                           921  ; ------------------------------------------------------------------------------
000015FA                           922  SCOUPD
000015FA                           923  ; ACTUALIZAR MARCADOR.
000015FA                           924  ; INPUT    : NONE 
000015FA                           925  ; OUTPUT   : NONE
000015FA                           926  ; MODIFIES : NONE
000015FA                           927  ; ------------------------------------------------------------------------------
000015FA                           928              
000015FA  48E7 8000                929              MOVEM.L D0,-(A7)
000015FE                           930              
000015FE                           931              ;Incrementa el marcador
000015FE  3039 00001AFE            932              MOVE.W  (JGOPNTS),D0
00001604  0640 0019                933              ADD.W  #25,D0
00001608  33C0 00001AFE            934              MOVE.W  D0,(JGOPNTS)
0000160E                           935              
0000160E  4CDF 0001                936              MOVEM.L (A7)+,D0
00001612                           937  
00001612  4E75                     938              RTS
00001614                           939              
00001614                           940  ; ------------------------------------------------------------------------------
00001614                           941  SCOPLOT
00001614                           942  ; DIBUJAR MARCADOR.
00001614                           943  ; INPUT    : NONE 
00001614                           944  ; OUTPUT   : NONE
00001614                           945  ; MODIFIES : NONE
00001614                           946  ; ------------------------------------------------------------------------------
00001614  48E7 C040                947             MOVEM.L  D0-D1/A1,-(A7)
00001618                           948             ; SET COLOR DE FONDO
00001618  103C 0051                949             MOVE.B   #81,D0
0000161C  223C 0090EE90            950             MOVE.L   #COLFND,D1
00001622  4E4F                     951             TRAP     #15
00001624                           952             
00001624                           953             
00001624                           954             
00001624                           955             ; DIBUJAR LINEA DE PUNTUACIÓN
00001624  43F9 0000163E            956              LEA     .TXT1,A1
0000162A  4281                     957              CLR.L   D1
0000162C  3239 00001AFE            958              MOVE.W  (JGOPNTS),D1
00001632  103C 0011                959              MOVE.B  #17,D0
00001636  4E4F                     960              TRAP    #15
00001638                           961              
00001638  4CDF 0203                962              MOVEM.L (A7)+,D0-D1/A1
0000163C  4E75                     963              RTS
0000163E                           964  
0000163E                           965  
0000163E= 50 55 4E 54 4F 53 ...    966  .TXT1       DC.B    'PUNTOS : ',0
00001648                           967  
00001648                           968  
00001648                           969  
00001648                           970  
00001648                           971  -------------------- end include --------------------
00001648                           972              INCLUDE 'MATRIZ.X68'
00001648                           973  ; ----------------------------------------------------------------------------
00001648                           974  ; MATRIZ
00001648                           975  ; ----------------------------------------------------------------------------
00001648                           976  
00001648                           977  ;-----------------------------------------------------------------------------
00001648                           978  MTZINIT
00001648                           979  ; INICIALIZA LA MATRIZ, AL PRINCIPIO ESTÁ VACÍA
00001648                           980  ; INPUT    : NONE
00001648                           981  ; OUTPUT   : NONE
00001648                           982  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001648                           983  ; ----------------------------------------------------------------------------
00001648                           984              
00001648  48A7 E080                985              MOVEM.W D0-D2/A0,-(A7)
0000164C                           986              
0000164C  41F9 00001B02            987              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
00001652  303C 0300                988              MOVE.W #TCELDAS, D0    ; Número total de celdas
00001656                           989  
00001656                           990  CLNCLDS:
00001656  4218                     991              CLR.B (A0)+            ; Coloca 0 en cada celda
00001658  5340                     992              SUBI.W #1, D0          ; Decrementa el contador de celdas
0000165A  66FA                     993              BNE CLNCLDS            ; Repite hasta que esten vacías
0000165C                           994              
0000165C                           995              
0000165C  3239 00001954            996              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
00001662  3439 00001956            997              MOVE.W  CBZPOSY, D2
00001668  4EB9 000016C2            998              JSR     CINDMTRZ
0000166E  4EB9 000016FC            999              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
00001674                          1000              
00001674  3239 00001960           1001              MOVE.W  SGMPOSX, D1
0000167A  3439 00001962           1002              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
00001680  4EB9 000016C2           1003              JSR     CINDMTRZ
00001686  4EB9 0000173E           1004              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
0000168C                          1005              
0000168C  3239 0000195C           1006              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
00001692  3439 0000195E           1007              MOVE.W  COLPOSY, D2
00001698  4EB9 000016C2           1008              JSR     CINDMTRZ
0000169E  4EB9 00001754           1009              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
000016A4                          1010              
000016A4  3239 00001950           1011              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
000016AA  3439 00001952           1012              MOVE.W  MNZPOSY, D2
000016B0  4EB9 000016C2           1013              JSR     CINDMTRZ
000016B6  4EB9 0000176A           1014              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
000016BC                          1015              
000016BC                          1016              
000016BC  4C9F 0107               1017              MOVEM.W (A7)+,D0-D2/A0
000016C0                          1018  
000016C0  4E75                    1019              RTS
000016C2                          1020  
000016C2                          1021  ;-----------------------------------------------------------------------------
000016C2                          1022  CINDMTRZ
000016C2                          1023  ; CALCULA EL ÍNDICE DE UNA CELDA
000016C2                          1024  ; INPUT    : D1 = coordenada X pantalla, D2 = coordenada Y pantalla
000016C2                          1025  ; OUTPUT   : D0 = índice de la celda en ESTDCLDS
000016C2                          1026  ; MODIFIES : NONE
000016C2                          1027  ; ----------------------------------------------------------------------------
000016C2                          1028  
000016C2  48A7 7000               1029               MOVEM.W D1-D3,-(A7)     ; Guarda los registros D1-D3 en la pila
000016C6                          1030  
000016C6                          1031              ; Divide X por SIZECLDA
000016C6  3601                    1032              MOVE.W  D1, D3          ; Copia X a D3
000016C8  4241                    1033              CLR.W   D1              ; Inicializa el cociente de X
000016CA                          1034  
000016CA  B67C 0014               1035  DIVX:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
000016CE  6D00 000A               1036              BLT     ENDDIVX         ; Si D3 < SIZECLDA, salta a ENDDIVX
000016D2  0443 0014               1037              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
000016D6  5241                    1038              ADDQ.W  #1, D1          ; Incrementa el cociente de X
000016D8  60F0                    1039              BRA     DIVX            ; Repite el bucle
000016DA                          1040  
000016DA                          1041  ENDDIVX:
000016DA                          1042  
000016DA                          1043              ; Divide Y por SIZECLDA
000016DA  3602                    1044              MOVE.W  D2, D3          ; Copia Y a D3
000016DC  4242                    1045              CLR.W   D2              ; Inicializa el cociente de Y
000016DE                          1046  
000016DE  B67C 0014               1047  DIVY:       CMP.W   #SIZECLDA, D3    ; Compara D3 con SIZECLDA
000016E2  6D00 000A               1048              BLT     ENDDIVY         ; Si D3 < SIZECLDA, salta a ENDDIVY
000016E6  0443 0014               1049              SUB.W   #SIZECLDA, D3   ; Resta SIZECLDA de D3
000016EA  5242                    1050              ADDQ.W  #1, D2          ; Incrementa el cociente de Y
000016EC  60F0                    1051              BRA     DIVY            ; Repite el bucle
000016EE                          1052  
000016EE                          1053  ENDDIVY:
000016EE                          1054  
000016EE                          1055              ; Calcula el índice
000016EE  4240                    1056              CLR.W   D0
000016F0  3002                    1057              MOVE.W  D2, D0          ; D0 = Y_CELDA
000016F2  EB40                    1058              ASL.W   #5, D0          ; D0 = Y_CELDA * NUMCLMNS (32 = 2^5)
000016F4  D041                    1059              ADD.W   D1, D0          ; D0 = Y_CELDA * NUMCLMNS + X_CELDA
000016F6                          1060  
000016F6  4C9F 000E               1061              MOVEM.W (A7)+,D1-D3     ; Restaura los registros D1-D3 desde la pila
000016FA                          1062  
000016FA  4E75                    1063              RTS  
000016FC                          1064              
000016FC                          1065  ;-----------------------------------------------------------------------------
000016FC                          1066  CBZOCPD
000016FC                          1067  ; MARCA UNA CELDA COMO OCUPADA POR LA CABEZA
000016FC                          1068  ; INPUT    : D0 = índice de la celda en ESTDCLDS
000016FC                          1069  ; OUTPUT   : NONE
000016FC                          1070  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
000016FC                          1071  ; ----------------------------------------------------------------------------
000016FC                          1072  
000016FC  48A7 0080               1073              MOVEM.W A0,-(A7)
00001700                          1074  
00001700  41F9 00001B02           1075              LEA     ESTDCLDS, A0                ; Dirección de la matriz en A0
00001706  11B9 00001964 0000      1076              MOVE.B  TRZPLOT, (A0, D0.W)           ; Marca la celda como ocupada
0000170E                          1077              
0000170E  4C9F 0100               1078              MOVEM.W (A7)+,A0
00001712                          1079              
00001712  4E75                    1080              RTS
00001714                          1081              
00001714                          1082              
00001714                          1083              
00001714                          1084  ;-----------------------------------------------------------------------------
00001714                          1085  RSTCLD
00001714                          1086  ; RESTA 1 A LA CELDA PASADA POR PARÁMETRO
00001714                          1087  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001714                          1088  ; OUTPUT   : NONE
00001714                          1089  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001714                          1090  ; ----------------------------------------------------------------------------
00001714                          1091  
00001714  48A7 0080               1092              MOVEM.W A0,-(A7)
00001718                          1093  
00001718  41F9 00001B02           1094              LEA     ESTDCLDS, A0              ; Dirección de la matriz en A0
0000171E  5330 0000               1095              SUBQ.B   #1, (A0, D0.W)           ; Marca la celda como ocupada
00001722                          1096              
00001722  4C9F 0100               1097              MOVEM.W (A7)+,A0
00001726                          1098              
00001726  4E75                    1099              RTS
00001728                          1100             
00001728                          1101  ;-----------------------------------------------------------------------------
00001728                          1102  MCLDVCIA
00001728                          1103  ; MARCA UNA CELDA COMO VACÍA
00001728                          1104  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001728                          1105  ; OUTPUT   : NONE
00001728                          1106  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001728                          1107  ; ----------------------------------------------------------------------------
00001728                          1108  
00001728  48A7 0080               1109              MOVEM.W A0,-(A7)
0000172C                          1110  
0000172C  41F9 00001B02           1111              LEA ESTDCLDS, A0                ; Direccion de la matriz en A0
00001732  11BC 0000 0000          1112              MOVE.B #0, (A0, D0.W)           ; Marca la celda como vacía
00001738                          1113              
00001738  4C9F 0100               1114              MOVEM.W (A7)+,A0
0000173C                          1115              
0000173C  4E75                    1116              RTS
0000173E                          1117  
0000173E                          1118  ;-----------------------------------------------------------------------------
0000173E                          1119  SGMOCPD
0000173E                          1120  ; MARCA UNA CELDA COMO OCUPADA POR EL SEGMENTO
0000173E                          1121  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000173E                          1122  ; OUTPUT   : NONE
0000173E                          1123  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000173E                          1124  ; ----------------------------------------------------------------------------
0000173E                          1125  
0000173E  48A7 0080               1126              MOVEM.W A0,-(A7)
00001742                          1127  
00001742  41F9 00001B02           1128              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
00001748  11BC 0002 0000          1129              MOVE.B #2, (A0, D0.W)           ; Marca la celda como ocupada
0000174E                          1130              
0000174E  4C9F 0100               1131              MOVEM.W (A7)+,A0
00001752                          1132              
00001752  4E75                    1133              RTS
00001754                          1134              
00001754                          1135  ;-----------------------------------------------------------------------------
00001754                          1136  COLOCPD
00001754                          1137  ; MARCA UNA CELDA COMO OCUPADA POR LA COLA
00001754                          1138  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001754                          1139  ; OUTPUT   : NONE
00001754                          1140  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001754                          1141  ; ----------------------------------------------------------------------------
00001754                          1142  
00001754  48A7 0080               1143              MOVEM.W A0,-(A7)
00001758                          1144  
00001758  41F9 00001B02           1145              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
0000175E  11BC 0001 0000          1146              MOVE.B #1, (A0, D0.W)           ; Marca la celda como ocupada
00001764                          1147              
00001764  4C9F 0100               1148              MOVEM.W (A7)+,A0
00001768                          1149              
00001768  4E75                    1150              RTS
0000176A                          1151  
0000176A                          1152  
0000176A                          1153  ;-----------------------------------------------------------------------------
0000176A                          1154  MNZOCPD
0000176A                          1155  ; MARCA UNA CELDA COMO OCUPADA POR LA MANZANA
0000176A                          1156  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000176A                          1157  ; OUTPUT   : NONE
0000176A                          1158  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000176A                          1159  ; ----------------------------------------------------------------------------
0000176A                          1160  
0000176A  48A7 0080               1161              MOVEM.W A0,-(A7)
0000176E                          1162  
0000176E  41F9 00001B02           1163              LEA ESTDCLDS, A0                ; Dirección de la matriz en A0
00001774  11BC 0004 0000          1164              MOVE.B #4, (A0, D0.W)           ; Marca la celda como ocupada
0000177A                          1165              
0000177A  4C9F 0100               1166              MOVEM.W (A7)+,A0
0000177E                          1167              
0000177E  4E75                    1168              RTS
00001780                          1169  
00001780                          1170              
00001780                          1171  ;-----------------------------------------------------------------------------
00001780                          1172  CNVICOOR
00001780                          1173  ; Convierte un índice de celda a coordenadas de pantalla (X, Y)
00001780                          1174  ; INPUT    : D0 = índice de la celda en ESTADO_CELDAS
00001780                          1175  ; OUTPUT   : D1 = coordenada X, D2 = coordenada Y
00001780                          1176  ; MODIFIES : NONE
00001780                          1177  ; ----------------------------------------------------------------------------
00001780                          1178  
00001780  48A7 9800               1179              MOVEM.W D0/D3-D4,-(A7)
00001784                          1180  
00001784  3400                    1181              MOVE.W  D0,D2         ; Copia índice a D2 para calcular la fila
00001786  EA4A                    1182              LSR.W   #5,D2         ; D2 = índice / NUM_COLUMNAS (32 = 2^5)
00001788  3200                    1183              MOVE.W  D0,D1         ; Copia índice a D1 para calcular la columna
0000178A  C27C 001F               1184              AND.W   #$1F,D1       ; D1 = índice % NUM_COLUMNAS (31 = 0x1F) (CREO)
0000178E                          1185  
0000178E                          1186              ; Multiplica por TAMAÑO_CELDA = 10
0000178E  363C 0014               1187              MOVE.W  #SIZECLDA, D3
00001792  3801                    1188              MOVE.W  D1,D4         ; Copia D1 para multiplicar por 10
00001794  4241                    1189              CLR.W   D1            ; Inicializa resultado
00001796                          1190  
00001796                          1191  
00001796                          1192  MULTLOOPX: 
00001796  B87C 0000               1193              CMP.W   #0, D4        ; ¿Quedan iteraciones?
0000179A  6700 0008               1194              BEQ     ENDMULTX
0000179E  D243                    1195              ADD.W   D3,D1         ; Suma TAMANO_CELDA (10) repetidamente
000017A0                          1196  
000017A0  5344                    1197              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
000017A2  60F2                    1198              BRA     MULTLOOPX     ; Repite mientras no sea 0
000017A4                          1199  ENDMULTX: 
000017A4  3802                    1200              MOVE.W  D2,D4         ; Copia D2 para multiplicar por 10
000017A6  4242                    1201              CLR.W   D2            ; Inicializa resultado
000017A8                          1202  
000017A8                          1203  MULTLOOPY: 
000017A8  B87C 0000               1204              CMP.W   #0, D4        ; ¿Quedan iteraciones?
000017AC  6700 0008               1205              BEQ     ENDMULTY
000017B0  D443                    1206              ADD.W   D3,D2         ; Suma TAMANO_CELDA (10) repetidamente
000017B2  5344                    1207              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
000017B4  60F2                    1208              BRA     MULTLOOPY     ; Repite mientras no sea 0
000017B6                          1209  ENDMULTY:
000017B6  4C9F 0019               1210              MOVEM.W (A7)+,D0/D3-D4
000017BA                          1211  
000017BA  4E75                    1212              RTS
000017BC                          1213  
000017BC                          1214  ; ----------------------------------------------------------------------------
000017BC                          1215  CHECKCLD
000017BC                          1216  ; INPUT: D0 = índice de la celda
000017BC                          1217  ; OUTPUT: D0 = 0 si está vacía, 1 si está ocupada
000017BC                          1218  ; MODIFIES: Ninguno
000017BC                          1219  ; ----------------------------------------------------------------------------
000017BC                          1220  
000017BC  41F9 00001B02           1221              LEA     ESTDCLDS, A0    ; Carga la dirección de la matriz ESTDCLDS
000017C2  1230 0000               1222              MOVE.B  (A0, D0.W),D1   ; Carga el estado de la celda en D1
000017C6  B23C 0000               1223              CMP.B   #0, D1          ; Compara si está vacía (0)
000017CA  6700 0008               1224              BEQ     CLDFREE         ; Si está vacía
000017CE  303C 0001               1225              MOVE.W  #1, D0          ; Si está ocupada, devuelve 1 (ocupada)
000017D2                          1226  
000017D2  4E75                    1227              RTS
000017D4                          1228  
000017D4                          1229  CLDFREE:
000017D4  303C 0000               1230              MOVE.W  #0, D0                 ; Devuelve 0 (libre)
000017D8                          1231  
000017D8  4E75                    1232              RTS
000017DA                          1233  
000017DA                          1234  
000017DA                          1235  ;-----------------------------------------------------------------------------
000017DA                          1236  FONPLOT
000017DA                          1237  ; DIBUJADO DEL FONDO
000017DA                          1238  ; INPUT    : NONE
000017DA                          1239  ; OUTPUT   : NONE
000017DA                          1240  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000017DA                          1241  ; ----------------------------------------------------------------------------
000017DA                          1242  
000017DA  3F00                    1243              MOVE.W  D0,-(A7)
000017DC  3003                    1244              MOVE.W  D3,D0
000017DE  4EB8 1780               1245              JSR     CNVICOOR
000017E2  2F01                    1246              MOVE.L  D1,-(A7)
000017E4                          1247              
000017E4  103C 0050               1248              MOVE.B  #80,D0
000017E8  223C 0090EE90           1249              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
000017EE  4E4F                    1250              TRAP    #15
000017F0                          1251              
000017F0  103C 0051               1252              MOVE.B  #81,D0
000017F4  223C 0090EE90           1253              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
000017FA  4E4F                    1254              TRAP    #15
000017FC                          1255              
000017FC  103C 0057               1256              MOVE.B  #87,D0
00001800  221F                    1257              MOVE.L  (A7)+,D1
00001802  3F03                    1258              MOVE.W  D3,-(A7)
00001804  3601                    1259              MOVE.W  D1,D3
00001806  0643 0014               1260              ADD.W   #SIZECLDA,D3
0000180A  3802                    1261              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
0000180C  0644 0014               1262              ADD.W   #SIZECLDA,D4
00001810  4E4F                    1263              TRAP    #15                     
00001812                          1264                          
00001812  361F                    1265              MOVE.W  (A7)+,D3  
00001814  301F                    1266              MOVE.W  (A7)+,D0
00001816  4E75                    1267              RTS         
00001818                          1268  
00001818                          1269  
00001818                          1270  
00001818                          1271  ;-----------------------------------------------------------------------------
00001818                          1272  MTZUPD
00001818                          1273  ; ACTUALIZA LA MATRIZ CASILLA A CASILLA
00001818                          1274  ; INPUT    : NONE
00001818                          1275  ; OUTPUT   : NONE
00001818                          1276  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001818                          1277  ; ----------------------------------------------------------------------------
00001818                          1278  
00001818                          1279  
00001818  48A7 E080               1280              MOVEM.W D0-D2/A0,-(A7)
0000181C                          1281              
0000181C  41F9 00001B02           1282              LEA ESTDCLDS, A0       ; Apunta al inicio de ESTDCLDS
00001822  303C 0300               1283              MOVE.W #TCELDAS, D0    ; Número total de celdas
00001826                          1284  
00001826                          1285  .CLNCLDS:
00001826  4218                    1286              CLR.B (A0)+            ; Coloca 0 en cada celda
00001828  5340                    1287              SUBI.W #1, D0          ; Decrementa el contador de celdas
0000182A  66FA                    1288              BNE .CLNCLDS           ; Repite hasta que esten vacías
0000182C                          1289              
0000182C                          1290              
0000182C  3239 00001954           1291              MOVE.W  CBZPOSX, D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
00001832  3439 00001956           1292              MOVE.W  CBZPOSY, D2
00001838  4EB8 16C2               1293              JSR     CINDMTRZ
0000183C  4EB8 16FC               1294              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
00001840                          1295              
00001840  3239 00001960           1296              MOVE.W  SGMPOSX, D1
00001846  3439 00001962           1297              MOVE.W  SGMPOSY, D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
0000184C  4EB8 16C2               1298              JSR     CINDMTRZ
00001850  4EB8 173E               1299              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
00001854                          1300              
00001854  3239 0000195C           1301              MOVE.W  COLPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
0000185A  3439 0000195E           1302              MOVE.W  COLPOSY, D2
00001860  4EB8 16C2               1303              JSR     CINDMTRZ
00001864  4EB8 1754               1304              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
00001868                          1305              
00001868  3239 00001950           1306              MOVE.W  MNZPOSX, D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
0000186E  3439 00001952           1307              MOVE.W  MNZPOSY, D2
00001874  4EB8 16C2               1308              JSR     CINDMTRZ
00001878  4EB8 176A               1309              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
0000187C                          1310              
0000187C                          1311              
0000187C  4C9F 0107               1312              MOVEM.W (A7)+,D0-D2/A0
00001880                          1313  
00001880  4E75                    1314              RTS
00001882                          1315  
00001882                          1316  
00001882                          1317  
00001882                          1318  ;-----------------------------------------------------------------------------
00001882                          1319  MTZPLOT
00001882                          1320  ; DIBUJA LA MATRIZ CASILLA A CASILLA
00001882                          1321  ; INPUT    : NONE
00001882                          1322  ; OUTPUT   : NONE
00001882                          1323  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001882                          1324  ; ----------------------------------------------------------------------------
00001882  48E7 F080               1325              MOVEM.L D0-D3/A0,-(A7)
00001886                          1326  
00001886  4240                    1327              CLR.W   D0
00001888  4243                    1328              CLR.W   D3
0000188A  41F9 00001B02           1329              LEA     ESTDCLDS, A0            ; Apunta al inicio de ESTDCLDS
00001890  303C 0300               1330              MOVE.W  #TCELDAS, D0            ; Número total de celdas
00001894  363C 0000               1331              MOVE.W  #0,D3                   ; LO UTILIZAMOS PARA SABER EL INDICE EN EL QUE NOS ENCONTRAMOS
00001898  4241                    1332              CLR.W   D1
0000189A  4242                    1333              CLR.W   D2
0000189C                          1334              
0000189C                          1335  
0000189C                          1336  PLOTCLDS:
0000189C  1218                    1337              MOVE.B  (A0)+,D1                ; MOVEMOS EL VALOR DE LA CELDA A D1
0000189E  B23C 0000               1338              CMP.B   #0,D1
000018A2  6700 0036               1339              BEQ     PLOTVAC                 ; SALTA A DIBUJAR POSICIÓN VACÍA
000018A6  B23C 0001               1340              CMP.B   #1,D1 
000018AA  6700 0034               1341              BEQ     PLOTCOL                 ; SALTA A DIBUJAR COLA
000018AE  B23C 0002               1342              CMP.B   #2,D1
000018B2  6700 0032               1343              BEQ     PLOTSEG                 ; SALTA A DIBUJAR SEGMENTO
000018B6  B239 00001964           1344              CMP.B   TRZPLOT,D1
000018BC  6700 0016               1345              BEQ     PLOTCBZ                 ; SALTA A DIBUJAR CABEZA
000018C0  B23C 0004               1346              CMP.B   #4,D1                 
000018C4  6700 0026               1347              BEQ     PLOTAPPLE               ; SALTA A DIBUJAR MANZANA
000018C8                          1348    
000018C8                          1349  DONEPLOT            
000018C8  5243                    1350              ADDQ    #1,D3                   ; AUMENTAMOS EL INDICE DE CELDA PARA LA SIGUIENTE
000018CA  5340                    1351              SUBI.W  #1, D0                  ; Decrementa el contador de celdas
000018CC  66CE                    1352              BNE     PLOTCLDS                ; Repite hasta que esten vacías
000018CE  4CDF 010F               1353              MOVEM.L (A7)+,D0-D3/A0
000018D2  4E75                    1354              RTS
000018D4                          1355  PLOTCBZ:
000018D4  4EB8 1300               1356              JSR     HEADPLOT
000018D8  60EE                    1357              BRA     DONEPLOT
000018DA                          1358  
000018DA                          1359  PLOTVAC:    
000018DA  4EB8 17DA               1360              JSR     FONPLOT
000018DE  60E8                    1361              BRA     DONEPLOT                ; DIBUJADO HECHO 
000018E0                          1362  
000018E0                          1363  PLOTCOL:   
000018E0  4EB8 1484               1364              JSR     TAILPLOT 
000018E4  60E2                    1365              BRA     DONEPLOT                ; DIBUJADO HECHO 
000018E6                          1366              
000018E6                          1367  PLOTSEG:    
000018E6  4EB8 13E4               1368              JSR     SEGPLOT
000018EA  60DC                    1369              BRA     DONEPLOT                ; DIBUJADO HECHO    
000018EC                          1370  
000018EC                          1371  PLOTAPPLE:
000018EC  4EB8 1542               1372              JSR     APPLEPLOT
000018F0  60D6                    1373              BRA     DONEPLOT            
000018F2                          1374  
000018F2                          1375  
000018F2                          1376  
000018F2                          1377  
000018F2                          1378  
000018F2                          1379  
000018F2                          1380  
000018F2                          1381  
000018F2                          1382  
000018F2                          1383  
000018F2                          1384  
000018F2                          1385  
000018F2                          1386  
000018F2                          1387  
000018F2                          1388  -------------------- end include --------------------
000018F2                          1389  START:
000018F2                          1390                  
000018F2                          1391  ; --- INIZIALIZACIÓN ---------------------------------------------------------
000018F2                          1392  
000018F2  4EB8 1000               1393              JSR     SYSINIT
000018F6  4EB8 10E2               1394              JSR     UTLINIT
000018FA  4EB8 1066               1395              JSR     KBDINIT
000018FE  4EB8 1648               1396              JSR     MTZINIT
00001902  4EB8 1216               1397              JSR     HEADINIT                
00001906  4EB8 1384               1398              JSR     SEGINIT
0000190A  4EB8 1424               1399              JSR     TAILINIT
0000190E  4EB8 15F2               1400              JSR     SCOINIT
00001912  4EB8 14C4               1401              JSR     APPLEINIT
00001916                          1402              
00001916                          1403  
00001916                          1404  .LOOP
00001916                          1405  
00001916                          1406  ; --- ACTUALIZAR -------------------------------------------------------------
00001916                          1407  
00001916                          1408  ; LEER DISPOSITIVOS DE ENTRADA
00001916                          1409  
00001916  4E41                    1410              TRAP    #1
00001918                          1411  
00001918                          1412  ; ACTUALIZAR LÓGICA DEL JUEGO
00001918                          1413              
00001918  4EB8 1436               1414              JSR     TAILUPD
0000191C  4EB8 1396               1415              JSR     SEGUPD
00001920  4EB8 1244               1416              JSR     HEADUPD
00001924                          1417              ;JSR     APPLEUPD  
00001924  4EB8 1818               1418              JSR     MTZUPD
00001928                          1419              ;JSR     SCOUPD
00001928                          1420              
00001928                          1421  ; --- SINCRONIZACIÓN ---------------------------------------------------------
00001928                          1422              ; THE FOLLOWING SYNC STRATEGY IS ****WRONG****
00001928  103C 0017               1423              MOVE.B  #23,D0
0000192C  7201                    1424              MOVE.L  #1,D1
0000192E  4E4F                    1425              TRAP    #15
00001930                          1426  
00001930                          1427  
00001930                          1428  ;---DIBUJAR-------------------------------------------------------------------
00001930  4EB8 1300               1429               JSR    HEADPLOT
00001934  4EB8 13E4               1430               JSR    SEGPLOT
00001938  4EB8 1484               1431               JSR    TAILPLOT
0000193C  4EB8 1542               1432               JSR    APPLEPLOT
00001940  4EB8 1882               1433               JSR    MTZPLOT
00001944  4EB8 1614               1434               JSR    SCOPLOT
00001948                          1435              
00001948  4E40                    1436              TRAP    #0                      ; ACTUALIZA DOBLE BUFFER
0000194A                          1437  
0000194A                          1438  
0000194A  60CA                    1439              BRA     .LOOP
0000194C                          1440  
0000194C  FFFF FFFF               1441              SIMHALT
00001950                          1442              
00001950                          1443              INCLUDE 'VARS.X68'
00001950                          1444  ; ----------------------------------------------------------------------------
00001950                          1445  ; VARIABLES DEL JUEGO
00001950                          1446  ; ----------------------------------------------------------------------------
00001950                          1447  
00001950                          1448  ; --- VARIABLES DE LA MANZANA ------------------------------------------------
00001950                          1449  
00001950                          1450  MNZPOSX     DS.W    1                       ; COORDENADA X DE LA MANZANA
00001952                          1451  MNZPOSY     DS.W    1                       ; COORDENADA Y DE LA MANZANA
00001954                          1452  
00001954                          1453  ; --- VARIABLES DE LA SERPIENTE ----------------------------------------------
00001954                          1454  
00001954                          1455  CBZPOSX     DS.W    1                       ; COORDENADA X CABEZA
00001956                          1456  CBZPOSY     DS.W    1                       ; COORDENADA Y CABEZA
00001958                          1457  CBZVELX     DS.W    1                       ; VELOCIDAD X CABEZA
0000195A                          1458  CBZVELY     DS.W    1                       ; VELOCIDAD Y CABEZA
0000195C                          1459  COLPOSX     DS.W    1                       ; COORDENADA X COLA
0000195E                          1460  COLPOSY     DS.W    1                       ; COORDENADA Y COLA
00001960                          1461  SGMPOSX     DS.W    1                       ; COORDENADA X SEGMENTO
00001962                          1462  SGMPOSY     DS.W    1                       ; COORDENADA Y SEGMENTO
00001964                          1463  TRZPLOT     DS.B    1                       ; NÚMERO DE TROZOS A DIBUJAR
00001965                          1464  
00001966                          1465  NUMSGMS     DS.W    1           ; Número de segmentos de la serpiente
00001968                          1466  LASTCOLX    DS.W    1           ; Última posición X de la cola
0000196A                          1467  LASTCOLY    DS.W    1           ; Última posición Y de la cola
0000196C                          1468  
0000196C                          1469  COLSEGSX    DS.W    100        ; Máximo 100 segmentos, coordenadas X
00001A34                          1470  COLSEGSY    DS.W    100        ; Máximo 100 segmentos, coordenadas Y
00001AFC                          1471  COLSIZE     DS.W    1          ; Tamaño actual de la cola
00001AFE                          1472  
00001AFE                          1473  
00001AFE                          1474  ; --- VARIABLES DEL MARCADOR -------------------------------------------------
00001AFE                          1475  
00001AFE                          1476  JGOPNTS     DS.W    1                       ; PUNTUACIÓN DEL JUEGO
00001B00                          1477  
00001B00                          1478  
00001B00                          1479  
00001B00                          1480  
00001B00                          1481  
00001B00                          1482  
00001B00                          1483  -------------------- end include --------------------
00001B00                          1484              INCLUDE 'LIB/UTLVARS.X68'
00001B00                          1485  ; =============================================================================
00001B00                          1486  ; UTILITY VARIABLES
00001B00                          1487  ; =============================================================================
00001B00                          1488  
00001B00                          1489  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001B02                          1490              DS.W    0
00001B02                          1491  -------------------- end include --------------------
00001B02                          1492              INCLUDE 'SYSVARS.X68'
00001B02                          1493  ; ----------------------------------------------------------------------------
00001B02                          1494  ; VARIABLES DEL SISTEMA
00001B02                          1495  ; ----------------------------------------------------------------------------
00001B02                          1496  
00001B02                          1497  ; --- VARIABLES DE LA MATRIZ -------------------------------------------------
00001B02                          1498  
00001B02                          1499  ESTDCLDS    DS.B    TCELDAS                 ; ESTADO DE LAS CELDAS 0=VACÍO  1=COLA   2=SEGMENTO  TRZPLOT=CABEZA  4?=MANZANA    
00001E02                          1500  ESTDCBZ     DS.B    1                       ; 0= DERECHA, 1=ARRIBA, 2=IZQUIERDA, 3=ABAJO
00001E03                          1501  
00001E03                          1502  ; --- VARIABLES DE TECLADO ---------------------------------------------------
00001E03                          1503  
00001E03                          1504  KBDVAL      DS.B    1
00001E04                          1505  KBDEDGE     DS.B    1                       ; KEY EDGE
00001E06                          1506  LASTKEY     DS.L    1                       
00001E0A                          1507  
00001E0A                          1508  
00001E0A                          1509  
00001E0A                          1510  
00001E0A                          1511  
00001E0A                          1512  
00001E0A                          1513  
00001E0A                          1514  
00001E0A                          1515  
00001E0A                          1516  
00001E0A                          1517  
00001E0A                          1518  
00001E0A                          1519  
00001E0A                          1520  
00001E0A                          1521  
00001E0A                          1522  
00001E0A                          1523  -------------------- end include --------------------
00001E0A                          1524      
00001E0A                          1525      
00001E0A                          1526              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
APPLEINIT           14C4
APPLEPLOT           1542
APPLEUPD            14F6
ARR                 10BC
CBZFCOL             AA00
CBZHEIGH            14
CBZOCPD             16FC
CBZPCOL             FF00
CBZPOSX             1954
CBZPOSY             1956
CBZVEL              14
CBZVELX             1958
CBZVELY             195A
CBZWIDTH            14
CHCKUPDT            151C
CHECK               14D0
CHECKCLD            17BC
CHKCOL              12B6
CINDMTRZ            16C2
CLDFREE             17D4
CLNCLDS             1656
CNVICOOR            1780
COLFCOL             AA00
COLFND              90EE90
COLHEIGH            A
COLOCPD             1754
COLPCOL             FF00
COLPOSX             195C
COLPOSY             195E
COLSEGSX            196C
COLSEGSY            1A34
COLSIZE             1AFC
COLWIDTH            A
CONTINU             10DC
DER                 10B0
DIVX                16CA
DIVY                16DE
DONEPLOT            18C8
DWN                 10D4
ENDDIVX             16DA
ENDDIVY             16EE
ENDMULTX            17A4
ENDMULTY            17B6
ESTDCBZ             1E02
ESTDCLDS            1B02
FIN                 12FA
FINUPD              147E
FONPLOT             17DA
GENPOSMNZ           15C0
HEADINIT            1216
HEADPLOT            1300
HEADUPD             1244
IZQ                 10C8
JGOPNTS             1AFE
KBDDOWN             28
KBDEDGE             1E04
KBDINIT             1066
KBDLEFT             25
KBDRIGHT            27
KBDUP               26
KBDUPD              1074
KBDVAL              1E03
LASTCOLX            1968
LASTCOLY            196A
LASTKEY             1E06
LNGINI              1
MARKMNZ             14E8
MAXSGM              1
MCLDVCIA            1728
MNZFCOL             FF
MNZHEIGH            14
MNZOCPD             176A
MNZPCOL             AAFF
MNZPOSX             1950
MNZPOSY             1952
MNZWIDTH            14
MTZINIT             1648
MTZPLOT             1882
MTZUPD              1818
MTZUPD:CLNCLDS      1826
MULTLOOPX           1796
MULTLOOPY           17A8
NEWMNZ              1534
NOCOL               12E2
NUMCLMNS            20
NUMFILAS            18
NUMSGMS             1966
OJOFCOL             FFFFFF
OJOHEIGH            A
OJOPCOL             0
OJOWIDTH            A
PANHEIGH            1E0
PANWIDTH            280
PLOTAPPLE           18EC
PLOTCBZ             18D4
PLOTCLDS            189C
PLOTCOL             18E0
PLOTSEG             18E6
PLOTVAC             18DA
PNTSFCOL            0
PNTSTEXT            65
RSTCLD              1714
SCOINIT             15F2
SCOPLOT             1614
SCOPLOT:TXT1        163E
SCOUPD              15FA
SCRINIT             101E
SCRPLOT             104C
SEGINIT             1384
SEGPLOT             13E4
SEGUPD              1396
SGMFCOL             AA00
SGMHEIGH            14
SGMOCPD             173E
SGMPCOL             FF00
SGMPOSX             1960
SGMPOSY             1962
SGMWIDTH            14
SIGABA              12AE
SIGARR              1296
SIGDER              128A
SIGIZQ              12A2
SIZECLDA            14
START               18F2
START:LOOP          1916
SYSINIT             1000
TAILINIT            1424
TAILPLOT            1484
TAILUPD             1436
TCELDAS             300
TRZPLOT             1964
UTLINIT             10E2
UTLRAND             10F8
UTLRAND:RANDVEC     1116
UTLRNDIX            1B00
