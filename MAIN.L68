00001A22 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 30/12/2024 11:56:18

00000000                             1  *-----------------------------------------------------------------------------
00000000                             2  * Title      : MAIN
00000000                             3  * Written by :
00000000                             4  * Date       :
00000000                             5  * Description:
00000000                             6  *-----------------------------------------------------------------------------
00000000                             7  
00001000                             8              ORG    $1000
00001000                             9              
00001000                            10              INCLUDE 'CONST.X68'
00001000                            11  ; ----------------------------------------------------------------------------
00001000                            12  ; CONSTANTES DEL JUEGO
00001000                            13  ; ----------------------------------------------------------------------------
00001000                            14     
00001000                            15  ; --- CONSTANTES DE LA MANZANA -----------------------------------------------
00001000                            16  
00001000  =00000014                 17  MNZWIDTH    EQU     20                      ; ANCHURA DE LA MANZANA (a determinar)
00001000  =00000014                 18  MNZHEIGH    EQU     20                      ; ALTURA DE LA MANZANA (a determinar)
00001000  =0000AAFF                 19  MNZPCOL     EQU     $0000AAFF               ; COLOR CONTORNO MANZANA (a determinar)
00001000  =000000FF                 20  MNZFCOL     EQU     $000000FF               ; COLOR RELLENO MANZANA (a determinar)
00001000                            21  
00001000                            22  ; --- CONSTANTES DE LA SERPIENTE ---------------------------------------------
00001000                            23  
00001000  =00000001                 24  MAXSGM      EQU     1                       ; TAMAÑO MÁXIMO DE SEGMENTOS (a determinar)
00001000  =00000001                 25  LNGINI      EQU     1                       ; LONGITUD INICIAL SERPIENTE (a determinar)
00001000  =00000014                 26  CBZVEL      EQU     20                      ; VELOCIDAD DE LA CABEZA (a determinar)
00001000  =00000014                 27  SGMWIDTH    EQU     20                      ; ANCHURA DE UN SEGMENTO (PROVISIONAL)
00001000  =00000014                 28  SGMHEIGH    EQU     20                      ; ALTURA DE UN SEGMENTO (PROVISIONAL)
00001000  =0000FF00                 29  SGMPCOL     EQU     $0000FF00               ; COLOR CONTORNO SEGMENTO (PROVISIONAL)
00001000  =0000AA00                 30  SGMFCOL     EQU     $0000AA00               ; COLOR RELLENO SEGMENTO (PROVISIONAL)
00001000  =0000000A                 31  COLWIDTH    EQU     10                      ; ANCHURA DE LA COLA (PROVISIONAL)
00001000  =0000000A                 32  COLHEIGH    EQU     10                      ; ALTURA DE LA COLA (PROVISIONAL)
00001000  =0000FF00                 33  COLPCOL     EQU     $0000FF00               ; COLOR CONTORNO COLA (PROVISIONAL)
00001000  =0000AA00                 34  COLFCOL     EQU     $0000AA00               ; COLOR RELLENO COLA (PROVISIONAL)
00001000  =00000014                 35  CBZWIDTH    EQU     20                      ; ANCHURA DE LA CABEZA (PROVISIONAL)
00001000  =00000014                 36  CBZHEIGH    EQU     20                      ; ALTURA DE LA CABEZA (PROVISIONAL)
00001000  =0000FF00                 37  CBZPCOL     EQU     $0000FF00               ; COLOR CONTORNO CABEZA (PROVISIONAL)
00001000  =0000AA00                 38  CBZFCOL     EQU     $0000AA00               ; COLOR RELLENO CABEZA (PROVISIONAL)
00001000  =0000000A                 39  OJOWIDTH    EQU     10                      ; ANCHURA DE OJO DE SERPIENTE
00001000  =0000000A                 40  OJOHEIGH    EQU     10                      ; ALTURA DE OJO DE SERPIENTE
00001000  =00000000                 41  OJOPCOL     EQU     $00000000               ; COLOR CONTORNO OJO
00001000  =00FFFFFF                 42  OJOFCOL     EQU     $00FFFFFF               ; COLOR RELLENO OJO            
00001000                            43  
00001000                            44  ; --- CONSTANTES MARCADOR ----------------------------------------------------
00001000                            45  
00001000  =00000000                 46  PNTSFCOL    EQU     $00000000               ; COLOR FONDO MARCADOR (a determinar)
00001000  =00000065                 47  PNTSTEXT    EQU     0101                    ; COORDENADAS DEL MARCADOR (a determinar)
00001000                            48  
00001000                            49  
00001000                            50  
00001000                            51  
00001000                            52  
00001000                            53  
00001000                            54  
00001000                            55  
00001000                            56  
00001000                            57  
00001000                            58  
00001000                            59  
00001000                            60  
00001000                            61  
00001000                            62  
00001000                            63  
00001000                            64  -------------------- end include --------------------
00001000                            65              INCLUDE 'SYSCONST.X68'
00001000                            66  ; ----------------------------------------------------------------------------
00001000                            67  ; CONSTANTES DEL SISTEMA
00001000                            68  ; ----------------------------------------------------------------------------
00001000                            69  
00001000                            70  ; ---CONSTANTES DE LA PANTALLA------------------------------------------------
00001000                            71  
00001000  =00000280                 72  PANWIDTH    EQU     640                     ; ANCHO DE LA PANTALLA
00001000  =000001E0                 73  PANHEIGH    EQU     480                     ; ALTURA DE LA PANTALLA
00001000  =0090EE90                 74  COLFND      EQU     $90EE90                 ; COLOR DEL FONDO DE LA PANTALLA
00001000  =00000032                 75  SCRFPS      EQU     50
00001000                            76  
00001000                            77  ; ---CONSTANTES DE LA MATRIZ--------------------------------------------------
00001000                            78  
00001000  =00000014                 79  SIZECLDA    EQU     20                      ; TAMAÑO DE CADA CELDA EN PIXELES
00001000  =00000020                 80  NUMCLMNS    EQU     32                      ; COLUMNAS DE CELDAS (640/10)
00001000  =00000018                 81  NUMFILAS    EQU     24                      ; FILAS DE CELDAS (480/10)
00001000  =00000300                 82  TCELDAS     EQU     768                     ; TOTAL DE CELDAS (64 * 48)
00001000                            83  
00001000                            84  ; ---CÓDIGOS DE TECLADO-------------------------------------------------------
00001000                            85  
00001000  =00000025                 86  KBDLEFT     EQU     $25
00001000  =00000026                 87  KBDUP       EQU     $26
00001000  =00000027                 88  KBDRIGHT    EQU     $27
00001000  =00000028                 89  KBDDOWN     EQU     $28
00001000                            90  
00001000                            91  ; --- IDENTIFICADORES DE SONIDO ----------------------------------------------
00001000                            92  
00001000  =00000000                 93  SNDEAT      EQU     0
00001000  =00000001                 94  SNDGMOV     EQU     1
00001000                            95  
00001000                            96  ; --- NÚMEROS DE TRAP --------------------------------------------------------
00001000                            97  
00001000  =00000000                 98  SCRUPTN     EQU     0                       ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 99  KBDUPTN     EQU     1                       ; KEYBOARD TRAP NUMBER
00001000  =00000002                100  SNDPLTN     EQU     2                       ; SOUND TRAP NUMBER
00001000                           101  
00001000                           102  ; --- NÚMEROS DE INTERRUPCIÓN ------------------------------------------------
00001000                           103  
00001000  =00000001                104  SCRINTN     EQU     1     
00001000                           105  
00001000                           106  
00001000                           107  
00001000                           108  
00001000                           109  
00001000                           110  
00001000                           111  -------------------- end include --------------------
00001000                           112              INCLUDE 'SYSTEM.X68'
00001000                           113   
00001000                           114   
00001000                           115  SYSINIT
00001000                           116  ; INICIA EL  SISTEMA
00001000                           117  ; INPUT    : NONE
00001000                           118  ; OUTPUT   : NONE
00001000                           119  ; MODIFIES : NONE
00001000                           120  ; ----------------------------------------------------------------------------
00001000                           121              
00001000  21FC 000010E6 0080       122              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
00001008  21FC 0000110E 0084       123              MOVE.L  #KBDUPD,($80+KBDUPTN*4)
00001010  21FC 00001088 0088       124              MOVE.L  #SNDPLAY,($80+SNDPLTN*4)
00001018  21FC 000010DE 0064       125              MOVE.L  #SCRTIM,($60+SCRINTN*4)
00001020                           126              
00001020  4EB9 0000109A            127              JSR     SCRINIT
00001026  4EB9 00001100            128              JSR     KBDINIT
0000102C  4EB9 0000103A            129              JSR     SNDINIT
00001032                           130              
00001032  40E7                     131              MOVE.W  SR,-(A7)
00001034  0257 D8FF                132              ANDI.W  #$D8FF,(A7)
00001038                           133              
00001038  4E73                     134              RTE
0000103A                           135              
0000103A                           136  ; ----------------------------------------------------------------------------
0000103A                           137  SNDINIT
0000103A                           138  ; SOUND SYSTEM INIT
0000103A                           139  ; INPUT    : NONE
0000103A                           140  ; OUTPUT   : NONE
0000103A                           141  ; MODIFIES : NONE
0000103A                           142  ; ----------------------------------------------------------------------------
0000103A                           143  
0000103A  48E7 C0C0                144              MOVEM.L D0-D1/A0-A1,-(A7)
0000103E                           145  
0000103E  4201                     146              CLR.B   D1
00001040  41F9 0000107C            147              LEA     .SNDLIST,A0
00001046  2018                     148  .LOOP       MOVE.L  (A0)+,D0
00001048  6700 000E                149              BEQ     .DONE
0000104C  2240                     150              MOVE.L  D0,A1
0000104E  103C 0047                151              MOVE.B  #71,D0
00001052  4E4F                     152              TRAP    #15
00001054  5201                     153              ADDQ.B  #1,D1
00001056  60EE                     154              BRA     .LOOP
00001058                           155              
00001058  4CDF 0303                156  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
0000105C  4E75                     157              RTS
0000105E                           158              
0000105E= 53 4E 44 2F 45 41 ...    159  .SNDEAT     DC.B    'SND/EAT.wav',0
0000106A= 53 4E 44 2F 47 41 ...    160  .SNDGMOV    DC.B    'SND/GAMEOVER.wav',0
0000107C= 0000105E 0000106A ...    161  .SNDLIST    DC.L    .SNDEAT,.SNDGMOV,0
00001088                           162              
00001088                           163  ; ----------------------------------------------------------------------------
00001088                           164  SNDPLAY
00001088                           165  ; PLAY SOUND
00001088                           166  ; INPUT    : D7 SOUND ID
00001088                           167  ; OUTPUT   : NONE
00001088                           168  ; MODIFIES : NONE
00001088                           169  ; ----------------------------------------------------------------------------            
00001088                           170              
00001088  48A7 C000                171              MOVEM.W D0-D1,-(A7)
0000108C                           172              
0000108C  103C 0048                173              MOVE.B  #72,D0
00001090  1207                     174              MOVE.B  D7,D1
00001092  4E4F                     175              TRAP    #15
00001094                           176              
00001094  4C9F 0003                177              MOVEM.W (A7)+,D0-D1
00001098  4E73                     178              RTE
0000109A                           179               
0000109A                           180              
0000109A                           181  ; ----------------------------------------------------------------------------
0000109A                           182  SCRINIT
0000109A                           183  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
0000109A                           184  ; ENABLE DOUBLE BUFFER, ENABLED TIMED INTERRUPT.
0000109A                           185  ; INPUT    : NONE
0000109A                           186  ; OUTPUT   : NONE
0000109A                           187  ; MODIFIES : NONE
0000109A                           188  ; ----------------------------------------------------------------------------
0000109A                           189  
0000109A  48E7 C000                190              MOVEM.L D0-D1,-(A7)
0000109E                           191  
0000109E                           192              ; SET SCREEN RESOLUTION
0000109E  103C 0021                193              MOVE.B  #33,D0
000010A2  223C 028001E0            194              MOVE.L  #PANWIDTH<<16|PANHEIGH,D1
000010A8  4E4F                     195              TRAP    #15
000010AA                           196              
000010AA                           197              ; SET WINDOWED MODE
000010AA  7201                     198              MOVE.L  #1,D1
000010AC  4E4F                     199              TRAP    #15
000010AE                           200              
000010AE                           201              ; CLEAR SCREEN
000010AE  103C 000B                202              MOVE.B  #11,D0
000010B2  323C FF00                203              MOVE.W  #$FF00,D1
000010B6  4E4F                     204              TRAP    #15
000010B8                           205              
000010B8                           206              ; ENABLE DOUBLE BUFFER
000010B8  103C 005C                207              MOVE.B  #92,D0
000010BC  123C 0011                208              MOVE.B  #17,D1
000010C0  4E4F                     209              TRAP    #15
000010C2                           210              
000010C2                           211              ; ENABLE TIMED INTERRUPT
000010C2  103C 0020                212              MOVE.B  #32,D0
000010C6  123C 0006                213              MOVE.B  #6,D1
000010CA  143C 0081                214              MOVE.B  #$80|SCRINTN,D2
000010CE  7614                     215              MOVE.L  #1000/SCRFPS,D3                  ; CON 20 SE CONSIUGUEN 50 FPS
000010D0  4E4F                     216              TRAP    #15
000010D2                           217              
000010D2                           218              ; CLEAR INTERRUPT COUNTER
000010D2  4239 00001DAC            219              CLR.B   (SCRINTCT)
000010D8                           220              
000010D8  4CDF 0003                221              MOVEM.L (A7)+,D0-D1
000010DC                           222              
000010DC  4E75                     223              RTS    
000010DE                           224              
000010DE                           225  ; ------------------------------------------------------------------------------
000010DE                           226  SCRTIM
000010DE                           227  ; TIMED INTERRUPT SERVICE ROUTINE
000010DE                           228  ; INPUT    : NONE
000010DE                           229  ; OUTPUT   : NONE
000010DE                           230  ; MODIFIES : NONE
000010DE                           231  ; ------------------------------------------------------------------------------
000010DE  5239 00001DAC            232              ADDQ.B  #1,(SCRINTCT)
000010E4  4E73                     233              RTE
000010E6                           234              
000010E6                           235  
000010E6                           236  ; ------------------------------------------------------------------------------
000010E6                           237  SCRPLOT
000010E6                           238  ; UPDATES DOUBLE BUFFER
000010E6                           239  ; INPUT    : NONE
000010E6                           240  ; OUTPUT   : NONE
000010E6                           241  ; MODIFIES : NONE
000010E6                           242  ; ------------------------------------------------------------------------------
000010E6                           243  
000010E6  48A7 C000                244              MOVEM.W D0-D1,-(A7)
000010EA                           245              
000010EA                           246              ; SWITCH BUFFERS
000010EA  103C 005E                247              MOVE.B  #94,D0
000010EE  4E4F                     248              TRAP    #15
000010F0                           249              
000010F0                           250              ; CLEAR HIDDEN BUFFER
000010F0  103C 000B                251              MOVE.B  #11,D0
000010F4  323C FF00                252              MOVE.W  #$FF00,D1
000010F8  4E4F                     253              TRAP    #15
000010FA                           254              
000010FA  4C9F 0003                255              MOVEM.W (A7)+,D0-D1
000010FE                           256              
000010FE  4E73                     257              RTE
00001100                           258          
00001100                           259  ; ------------------------------------------------------------------------------
00001100                           260  KBDINIT
00001100                           261  ; INIT KEYBOARD
00001100                           262  ; INPUT    : NONE
00001100                           263  ; OUTPUT   : NONE
00001100                           264  ; MODIFIES : NONE
00001100                           265  ; ------------------------------------------------------------------------------
00001100                           266  
00001100  4239 00001DA5            267              CLR.B   (KBDVAL)
00001106  4239 00001DA6            268              CLR.B   (KBDEDGE)
0000110C  4E75                     269              RTS
0000110E                           270  
0000110E                           271  ; ------------------------------------------------------------------------------
0000110E                           272  KBDUPD
0000110E                           273  ; UPDATE KEYBOARD INFO.  
0000110E                           274  ; 7 -> PAUSE
0000110E                           275  ; 6 -> FIRE 3
0000110E                           276  ; 5 -> FIRE 2
0000110E                           277  ; 4 -> FIRE 1
0000110E                           278  ; 3 -> DOWN
0000110E                           279  ; 2 -> RIGHT
0000110E                           280  ; 1 -> UP
0000110E                           281  ; 0 -> LEFT
0000110E                           282  ; INPUT    : NONE
0000110E                           283  ; OUTPUT   : NONE
0000110E                           284  ; MODIFIES : NONE
0000110E                           285  ; ------------------------------------------------------------------------------
0000110E                           286  
0000110E  48E7 C000                287              MOVEM.L D0-D1,-(A7)
00001112                           288  
00001112                           289              ; LEE ESTADO DEL TECLADO
00001112  103C 0013                290              MOVE.B  #19,D0
00001116  223C 25262728            291              MOVE.L  #KBDLEFT<<24|KBDUP<<16|KBDRIGHT<<8|KBDDOWN,D1
0000111C  4E4F                     292              TRAP    #15                  ; Lee las teclas y guarda en D1
0000111E                           293  
0000111E  B2BC 000000FF            294              CMP.L   #$000000FF,D1
00001124  6700 0048                295              BEQ     DWN
00001128  B2BC 0000FF00            296              CMP.L   #$0000FF00,D1
0000112E  6700 001A                297              BEQ     DER
00001132  B2BC 00FF0000            298              CMP.L   #$00FF0000,D1
00001138  6700 001C                299              BEQ     ARR
0000113C  B2BC FF000000            300              CMP.L   #$FF000000,D1
00001142  6700 001E                301              BEQ     IZQ
00001146                           302  
00001146                           303              ; Si no hay pulsaciones, mantener estado
00001146  6000 002E                304              BRA     CONTINU
0000114A                           305  
0000114A  33FC 0000 00001DA4       306  DER:        MOVE.W  #0,(ESTDCBZ)           ; Actualiza estado a DERECHA
00001152  6000 0022                307              BRA     CONTINU
00001156                           308              
00001156  33FC 0001 00001DA4       309  ARR:        MOVE.W  #1,(ESTDCBZ)           ; Actualiza estado a ARRIBA
0000115E  6000 0016                310              BRA     CONTINU
00001162                           311  
00001162  33FC 0002 00001DA4       312  IZQ:        MOVE.W  #2,(ESTDCBZ)           ; Actualiza estado a IZQUIERDA
0000116A  6000 000A                313              BRA     CONTINU                    
0000116E                           314  
0000116E  33FC 0003 00001DA4       315  DWN:        MOVE.W  #3,(ESTDCBZ)           ; Actualiza estado a ABAJO
00001176                           316  
00001176                           317  CONTINU:
00001176  4CDF 0003                318              MOVEM.L (A7)+,D0-D1
0000117A  4E73                     319              RTE
0000117C                           320              
0000117C                           321  ; RESIDUOS CODIGO ANTERIOR 
0000117C                           322  
0000117C                           323              ;MOVE.B  D2,(KBDVAL)
0000117C                           324              
0000117C                           325  
0000117C                           326  
0000117C                           327  
0000117C                           328  
0000117C                           329  ; CODIGO ANTERIOR ANTERIOR
0000117C                           330  
0000117C                           331  
0000117C                           332  
0000117C                           333  
0000117C                           334  
0000117C                           335  
0000117C                           336  
0000117C                           337  
0000117C                           338  
0000117C                           339  
0000117C                           340  
0000117C                           341  
0000117C                           342  
0000117C                           343  
0000117C                           344  
0000117C                           345  
0000117C                           346  
0000117C                           347  
0000117C                           348  
0000117C                           349  
0000117C                           350  
0000117C                           351  
0000117C                           352  
0000117C                           353  
0000117C                           354  
0000117C                           355  
0000117C                           356  
0000117C                           357  
0000117C                           358  
0000117C                           359  
0000117C                           360  
0000117C                           361  
0000117C                           362  
0000117C                           363  
0000117C                           364  
0000117C                           365  
0000117C                           366  
0000117C                           367  
0000117C                           368  
0000117C                           369  
0000117C                           370  
0000117C                           371  
0000117C                           372  
0000117C                           373  
0000117C                           374  
0000117C                           375  
0000117C                           376  
0000117C                           377  -------------------- end include --------------------
0000117C                           378              INCLUDE 'LIB/UTLCODE.X68'
0000117C                           379  ; =============================================================================
0000117C                           380  ; UTILITY CODE
0000117C                           381  ; =============================================================================
0000117C                           382  
0000117C                           383  ; -----------------------------------------------------------------------------
0000117C                           384  UTLINIT
0000117C                           385  ; INITIALIZES UTILITY CODE
0000117C                           386  ; INPUT    - NONE
0000117C                           387  ; OUTPUT   - NONE
0000117C                           388  ; MODIFIES - NONE
0000117C                           389  ; -----------------------------------------------------------------------------
0000117C  48E7 C000                390              MOVEM.L D0-D1,-(A7)
00001180  103C 0008                391              MOVE.B  #8,D0
00001184  4E4F                     392              TRAP    #15
00001186  13C1 00001AA2            393              MOVE.B  D1,(UTLRNDIX)
0000118C  4CDF 0003                394              MOVEM.L (A7)+,D0-D1
00001190  4E75                     395              RTS
00001192                           396  
00001192                           397  
00001192                           398  ; -----------------------------------------------------------------------------
00001192                           399  UTLPRINT
00001192                           400  ; PRINT SCREEN CENTERED TEXT
00001192                           401  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001192                           402  ;            D0.B SCREEN ROW TO PRINT TEXT
00001192                           403  ; OUTPUT   : D0.B NEXT ROW
00001192                           404  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001192                           405  ; -----------------------------------------------------------------------------
00001192  48E7 C0C0                406              MOVEM.L D0-D1/A0-A1,-(A7)
00001196  4201                     407              CLR.B   D1
00001198  2248                     408              MOVE.L  A0,A1
0000119A  4A18                     409  .LOOP       TST.B   (A0)+
0000119C  6700 0006                410              BEQ     .ENDLOOP
000011A0  5201                     411              ADDQ.B  #1,D1
000011A2  60F6                     412              BRA     .LOOP
000011A4  E209                     413  .ENDLOOP    LSR.B   #1,D1
000011A6  0401 0028                414              SUB.B   #(PANWIDTH/UTLCHRWD)/2,D1
000011AA  4401                     415              NEG.B   D1
000011AC  E141                     416              ASL.W   #8,D1
000011AE  8240                     417              OR.W    D0,D1
000011B0  103C 000B                418              MOVE.B  #11,D0
000011B4  4E4F                     419              TRAP    #15
000011B6  103C 000D                420              MOVE.B  #13,D0
000011BA  4E4F                     421              TRAP    #15
000011BC  4CDF 0303                422              MOVEM.L (A7)+,D0-D1/A0-A1
000011C0  5200                     423              ADDQ.B  #1,D0
000011C2  4E75                     424              RTS
000011C4                           425              
000011C4                           426              
000011C4                           427  
000011C4                           428  
000011C4                           429              ; (SCRWIDTH/UTLCHRWD)/2 - D1/2
000011C4                           430  
000011C4                           431  ; -----------------------------------------------------------------------------
000011C4                           432  UTLRAND
000011C4                           433  ; PROVIDES A PSEUDO-RANDOM BYTE
000011C4                           434  ; INPUT    - NONE
000011C4                           435  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000011C4                           436  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000011C4                           437  ; -----------------------------------------------------------------------------
000011C4  2F08                     438              MOVE.L  A0,-(A7)
000011C6  41F9 000011E2            439              LEA     .RANDVEC,A0
000011CC  4280                     440              CLR.L   D0
000011CE  1039 00001AA2            441              MOVE.B  (UTLRNDIX),D0
000011D4  1030 0800                442              MOVE.B  (A0,D0.L),D0
000011D8  5239 00001AA2            443              ADDQ.B  #1,(UTLRNDIX)
000011DE  205F                     444              MOVE.L  (A7)+,A0
000011E0  4E75                     445              RTS
000011E2                           446  
000011E2                           447  
000011E2= A2 EE 9A 0C F5 24 ...    448  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000011EA= 2A A3 51 26 E0 AC ...    449              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000011F2= 75 51 CA FD 33 EB ...    450              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000011FA= 60 CC E7 B8 9A EB ...    451              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001202= 1D 76 B5 95 B0 89 ...    452              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
0000120A= 39 15 48 C9 6E CA ...    453              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001212= 43 E7 E2 7C 37 25 ...    454              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
0000121A= E9 94 CE E9 E4 52 ...    455              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001222= 37 6D 9A 84 A2 28 ...    456              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
0000122A= 19 E2 C6 77 80 D4 ...    457              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001232= 0A 5A 32 67 33 C2 ...    458              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
0000123A= 59 80 DC 0E 57 FC ...    459              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001242= 8A AB BC F7 07 4D ...    460              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
0000124A= EF D5 77 6E 1E BB ...    461              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001252= D6 E0 2A 8F BD 28 ...    462              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
0000125A= 13 4F 66 EC 0A 64 ...    463              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001262= 56 52 9A 16 9B 90 ...    464              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000126A= 06 8A A4 F7 01 DA ...    465              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001272= F2 E7 77 28 B1 76 ...    466              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000127A= A4 42 E3 81 B1 67 ...    467              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001282= BF CE FA 16 BF 38 ...    468              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
0000128A= D1 8B 50 0C 5F 49 ...    469              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001292= DE 4C 14 A2 40 DC ...    470              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000129A= B6 9B 0A 38 5D AB ...    471              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
000012A2= E2 1B DD 75 15 82 ...    472              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000012AA= 8A 26 51 30 9F 47 ...    473              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000012B2= 1E 8A BB 71 C6 6E ...    474              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000012BA= 9F 47 E5 34 94 27 ...    475              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000012C2= 7D 06 D6 BA 30 0F ...    476              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000012CA= EC 7F 7E 03 CF 2D ...    477              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000012D2= 94 5B 23 F2 8B CD ...    478              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000012DA= 74 33 EC B9 0F D5 ...    479              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000012E2                           480  
000012E2                           481  -------------------- end include --------------------
000012E2                           482              INCLUDE 'LIB/UTLCONST.X68'
000012E2                           483  ; ==============================================================================
000012E2                           484  ; UTIL CONSTANTS
000012E2                           485  ; ==============================================================================
000012E2                           486  
000012E2  =00000008                487  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
000012E2  =00000008                488  -------------------- end include --------------------
000012E2                           489              INCLUDE 'HEADSRP.X68'
000012E2                           490  
000012E2                           491  ; ------------------------------------------------------------------------------
000012E2                           492  HEADINIT
000012E2                           493  ; INICIALIZAR CABEZA.
000012E2                           494  ; INPUT    : NONE 
000012E2                           495  ; OUTPUT   : NONE
000012E2                           496  ; MODIFIES : NONE
000012E2                           497  ; ------------------------------------------------------------------------------
000012E2  33FC 0140 00001A8A       498              MOVE.W  #PANWIDTH/2,(CBZPOSX)
000012EA  33FC 00F0 00001A8C       499              MOVE.W  #PANHEIGH/2,(CBZPOSY)
000012F2  4279 00001A9E            500              CLR.W   (SRPVEL)
000012F8                           501              ;ADD.W   #20,(CBZVEL)
000012F8  4279 00001DA4            502              CLR.W   (ESTDCBZ)
000012FE  33FC 0000 00001DA4       503              MOVE.W  #0,(ESTDCBZ)
00001306  4E75                     504              RTS
00001308                           505              
00001308                           506  ; ------------------------------------------------------------------------------
00001308                           507  HEADUPD
00001308                           508  ; ACTUALIZAR CABEZA.
00001308                           509  ; INPUT    : NONE 
00001308                           510  ; OUTPUT   : NONE
00001308                           511  ; MODIFIES : NONE
00001308                           512  ; ------------------------------------------------------------------------------
00001308                           513  
00001308  48A7 E000                514              MOVEM.W D0-D2,-(A7)
0000130C                           515  
0000130C                           516              ; Marcar celda actual como vacía
0000130C  3239 00001A8A            517              MOVE.W  (CBZPOSX),D1
00001312  3439 00001A8C            518              MOVE.W  (CBZPOSY),D2
00001318  4EB9 000017F6            519              JSR     CINDMTRZ
0000131E  4EB9 00001846            520              JSR     MCLDVCIA
00001324                           521              
00001324                           522              
00001324                           523              ; Actualiza la posición de la cabeza según ESTDCBZ
00001324  3039 00001DA4            524              MOVE.W  (ESTDCBZ),D0
0000132A  B07C 0000                525              CMP.W   #0,D0
0000132E  6700 001E                526              BEQ     SIGDER
00001332  B07C 0001                527              CMP.W   #1,D0
00001336  6700 0022                528              BEQ     SIGARR
0000133A  B07C 0002                529              CMP.W   #2,D0
0000133E  6700 0026                530              BEQ     SIGIZQ
00001342  B07C 0003                531              CMP.W   #3,D0
00001346  6700 002A                532              BEQ     SIGABA
0000134A                           533  
0000134A                           534              ; Si no hay dirección válida, sale
0000134A  6000 0078                535              BRA     FIN
0000134E                           536  
0000134E                           537  SIGDER:
0000134E  0679 0014 00001A8A       538              ADD.W   #CBZVEL,(CBZPOSX)
00001356  6000 0022                539              BRA     CHKCOL
0000135A                           540  
0000135A                           541  SIGARR:
0000135A  0479 0014 00001A8C       542              SUB.W   #CBZVEL,(CBZPOSY)
00001362  6000 0016                543              BRA     CHKCOL
00001366                           544  
00001366                           545  SIGIZQ:
00001366  0479 0014 00001A8A       546              SUB.W   #CBZVEL,(CBZPOSX)
0000136E  6000 000A                547              BRA     CHKCOL
00001372                           548  
00001372                           549  SIGABA:
00001372  0679 0014 00001A8C       550              ADD.W   #CBZVEL,(CBZPOSY)
0000137A                           551              
0000137A                           552  CHKCOL:
0000137A                           553              ; Verifica la colisión con la manzana
0000137A  3239 00001A8A            554              MOVE.W  (CBZPOSX),D1
00001380  3439 00001A8C            555              MOVE.W  (CBZPOSY),D2
00001386  B279 00001A86            556              CMP.W   (MNZPOSX),D1
0000138C  6600 001E                557              BNE     NOCOL
00001390  B479 00001A88            558              CMP.W   (MNZPOSY),D2
00001396  6600 0014                559              BNE     NOCOL
0000139A                           560              
0000139A                           561              ; Colisión detectada
0000139A  4EB9 00001620            562              JSR     APPLEUPD
000013A0  4EB9 00001716            563              JSR     SCOUPD
000013A6  1E3C 0000                564              MOVE.B  #SNDEAT,D7
000013AA  4E42                     565              TRAP    #SNDPLTN
000013AC                           566              ;ADDQ.W  #2,(CBZVEL)
000013AC                           567  
000013AC                           568  NOCOL:
000013AC                           569              ; Convierte la posición nueva a índice
000013AC  3239 00001A8A            570              MOVE.W  (CBZPOSX),D1
000013B2  3439 00001A8C            571              MOVE.W  (CBZPOSY),D2
000013B8  4EB9 000017F6            572              JSR     CINDMTRZ
000013BE  4EB9 00001830            573              JSR     CBZOCPD                 ; Marca la celda como ocupada
000013C4                           574  
000013C4                           575  
000013C4                           576  FIN:
000013C4  4C9F 0007                577              MOVEM.W (A7)+,D0-D2
000013C8                           578  
000013C8  4E75                     579              RTS
000013CA                           580              
000013CA                           581  ; ------------------------------------------------------------------------------
000013CA                           582  HEADPLOT
000013CA                           583  ; DIBUJAR CABEZA.
000013CA                           584  ; INPUT    : NONE 
000013CA                           585  ; OUTPUT   : NONE
000013CA                           586  ; MODIFIES : NONE
000013CA                           587  ; ------------------------------------------------------------------------------
000013CA                           588                         
000013CA  3F00                     589              MOVE.W  D0,-(A7)               ; GUARDAMOS D0
000013CC  3003                     590              MOVE.W  D3,D0                  ; PONEMOS EL INDICE DE LA CELDA EN D0 PARA CALCULAR SUS COORDENADAS
000013CE  4EB9 0000189E            591              JSR     CNVICOOR
000013D4  2F01                     592              MOVE.L  D1,-(A7)
000013D6                           593              
000013D6                           594              ; SET COLOR DEL CONTORNO CABEZA
000013D6  103C 0050                595              MOVE.B  #80,D0
000013DA  223C 0000FF00            596              MOVE.L  #CBZPCOL,D1
000013E0  4E4F                     597              TRAP    #15
000013E2                           598              
000013E2                           599              ; SET COLOR DEL RELLENO CABEZA
000013E2  103C 0051                600              MOVE.B  #81,D0
000013E6  223C 0000AA00            601              MOVE.L  #CBZFCOL,D1
000013EC  4E4F                     602              TRAP    #15
000013EE                           603              
000013EE                           604              ; DIBUJAR CABEZA
000013EE  103C 0057                605              MOVE.B  #87,D0
000013F2  221F                     606              MOVE.L  (A7)+,D1
000013F4  3F03                     607              MOVE.W  D3,-(A7)
000013F6  3601                     608              MOVE.W  D1,D3
000013F8  0643 0014                609              ADD.W   #CBZWIDTH,D3
000013FC  3802                     610              MOVE.W  D2,D4
000013FE  0644 0014                611              ADD.W   #CBZHEIGH,D4
00001402  4E4F                     612              TRAP    #15
00001404                           613              
00001404  2F01                     614              MOVE.L  D1,-(A7)
00001406                           615              
00001406                           616              ; SET COLOR DEL CONTORNO OJO
00001406  103C 0050                617              MOVE.B  #80,D0
0000140A  7200                     618              MOVE.L  #OJOPCOL,D1
0000140C  4E4F                     619              TRAP    #15
0000140E                           620              
0000140E                           621              ; SET COLOR DEL RELLENO OJO
0000140E  103C 0051                622              MOVE.B  #81,D0
00001412  223C 00FFFFFF            623              MOVE.L  #OJOFCOL,D1
00001418  4E4F                     624              TRAP    #15
0000141A                           625              
0000141A                           626              ; DIBUJAR OJO
0000141A  103C 0058                627              MOVE.B  #88,D0
0000141E  221F                     628              MOVE.L  (A7)+,D1
00001420  2F01                     629              MOVE.L  D1,-(A7)
00001422  2F02                     630              MOVE.L  D2,-(A7)
00001424  5A41                     631              ADD.W   #OJOWIDTH/2,D1            
00001426  3601                     632              MOVE.W  D1,D3
00001428  0643 000A                633              ADD.W   #OJOWIDTH,D3
0000142C  5A42                     634              ADD.W   #OJOHEIGH/2,D2
0000142E  3802                     635              MOVE.W  D2,D4
00001430  0644 000A                636              ADD.W   #OJOHEIGH,D4
00001434  4E4F                     637              TRAP    #15                     ; DIBUJAMOS EL PRIMER OJO
00001436                           638              
00001436                           639  
00001436                           640              ; DEFINIR COORDENADAS IRIS
00001436  241F                     641              MOVE.L  (A7)+,D2
00001438  221F                     642              MOVE.L  (A7)+,D1
0000143A  0641 000A                643              ADD.W   #OJOWIDTH,D1
0000143E  0642 000A                644              ADD.W   #OJOHEIGH,D2
00001442  103C 0052                645              MOVE.B  #82,D0
00001446  4E4F                     646              TRAP    #15                     ; DIBUJAMOS EL PRIMER IRIS
00001448                           647              
00001448  361F                     648              MOVE.W  (A7)+,D3
0000144A  301F                     649              MOVE.W  (A7)+,D0
0000144C                           650  
0000144C  4E75                     651              RTS
0000144E                           652  
0000144E                           653  
0000144E                           654  
0000144E                           655  
0000144E                           656  
0000144E                           657  
0000144E                           658  
0000144E                           659  
0000144E                           660  
0000144E                           661  
0000144E                           662  
0000144E                           663  
0000144E                           664  
0000144E                           665  
0000144E                           666  
0000144E                           667  
0000144E                           668  
0000144E                           669  
0000144E                           670  
0000144E                           671  
0000144E                           672  
0000144E                           673  
0000144E                           674  
0000144E                           675  
0000144E                           676  
0000144E                           677  
0000144E                           678  
0000144E                           679  
0000144E                           680  
0000144E                           681  
0000144E                           682  
0000144E                           683  
0000144E                           684  
0000144E                           685  
0000144E                           686  
0000144E                           687  
0000144E                           688  
0000144E                           689  
0000144E                           690  
0000144E                           691  
0000144E                           692  -------------------- end include --------------------
0000144E                           693              INCLUDE 'SEGSRP.X68'
0000144E                           694  
0000144E                           695  ; ------------------------------------------------------------------------------
0000144E                           696  SEGINIT
0000144E                           697  ; INICIALIZAR SEGMENTO.
0000144E                           698  ; INPUT    : NONE 
0000144E                           699  ; OUTPUT   : NONE
0000144E                           700  ; MODIFIES : NONE
0000144E                           701  ; ------------------------------------------------------------------------------
0000144E  33FC 012C 00001A96       702              MOVE.W  #(PANWIDTH/2)-CBZWIDTH,(SGMPOSX)
00001456  33FC 00F0 00001A98       703              MOVE.W  #PANHEIGH/2,(SGMPOSY)
0000145E  33F9 00001A96 00001A9A   704              MOVE.W  (SGMPOSX),(SGMPOSX2)
00001468  33F9 00001A98 00001A9C   705              MOVE.W  (SGMPOSY),(SGMPOSY2)
00001472  0479 0014 00001A9A       706              SUB.W   #SGMWIDTH,(SGMPOSX2)
0000147A  4E75                     707              RTS
0000147C                           708              
0000147C                           709  ; ------------------------------------------------------------------------------
0000147C                           710  SEGUPD
0000147C                           711  ; ACTUALIZAR SEGMENTO.
0000147C                           712  ; INPUT    : NONE 
0000147C                           713  ; OUTPUT   : NONE
0000147C                           714  ; MODIFIES : NONE
0000147C                           715  ; ------------------------------------------------------------------------------
0000147C                           716  
0000147C  48A7 6000                717              MOVEM.W D1-D2,-(A7)
00001480                           718              
00001480                           719              ; Marcar posición anterior del segmento como vacía
00001480  3239 00001A96            720              MOVE.W  (SGMPOSX),D1             ; Cargar posición X actual del segmento2
00001486  3439 00001A98            721              MOVE.W  (SGMPOSY),D2             ; Cargar posición Y actual del segmento2
0000148C  4EB9 000017F6            722              JSR     CINDMTRZ                ; Obtener índice de celda en D0
00001492  4EB9 00001846            723              JSR     MCLDVCIA                ; Marcar celda como vacía
00001498                           724              
00001498                           725              ; Marcar posición anterior del segmento como vacía
00001498  3239 00001A9A            726              MOVE.W  (SGMPOSX2),D1             ; Cargar posición X actual del segmento2
0000149E  3439 00001A9C            727              MOVE.W  (SGMPOSY2),D2             ; Cargar posición Y actual del segmento2
000014A4  4EB9 000017F6            728              JSR     CINDMTRZ                ; Obtener índice de celda en D0
000014AA  4EB9 00001846            729              JSR     MCLDVCIA                ; Marcar celda como vacía
000014B0                           730              
000014B0                           731              ; Actualizar posición del segmento para seguir a la cabeza
000014B0  33F9 00001A96 00001A9A   732              MOVE.W  (SGMPOSX),(SGMPOSX2)    ; MARCAMOS LOS SEGMENTOS COMO SEGUNDA COORDENADA X
000014BA  33F9 00001A98 00001A9C   733              MOVE.W  (SGMPOSY),(SGMPOSY2)    ; MARCAMOS LOS SEGMENTOS COMO SEGUNDA COORDENADA Y
000014C4  33F9 00001A8A 00001A96   734              MOVE.W  (CBZPOSX),(SGMPOSX)        ; Actualizar X del segmento con la X de la cabeza
000014CE  33F9 00001A8C 00001A98   735              MOVE.W  (CBZPOSY),(SGMPOSY)        ; Actualizar Y del segmento con la Y de la cabeza
000014D8                           736  
000014D8                           737              ; Marcar nueva posición del segmento como ocupada
000014D8  3239 00001A96            738              MOVE.W  (SGMPOSX),D1             ; Cargar nueva posición X
000014DE  3439 00001A98            739              MOVE.W  (SGMPOSY),D2             ; Cargar nueva posición Y
000014E4  4EB9 000017F6            740              JSR     CINDMTRZ                ; Obtener índice de celda en D0
000014EA  4EB9 0000185C            741              JSR     SGMOCPD                 ; Marcar celda como ocupada por segmento
000014F0                           742              
000014F0  3239 00001A9A            743              MOVE.W  (SGMPOSX2),D1             ; Cargar nueva posición X DEL SEGMENTO 2
000014F6  3439 00001A9C            744              MOVE.W  (SGMPOSY2),D2             ; Cargar nueva posición Y DEL SEGMENTO 2
000014FC  4EB9 000017F6            745              JSR     CINDMTRZ                ; Obtener índice de celda en D0
00001502  4EB9 0000185C            746              JSR     SGMOCPD                 ; Marcar celda como ocupada por segmento
00001508                           747              
00001508  4C9F 0006                748              MOVEM.W (A7)+,D1-D2            
0000150C  4E75                     749              RTS
0000150E                           750  ;CODIGO ANTIGUO
0000150E                           751              
0000150E                           752              
0000150E                           753              
0000150E                           754  ; ------------------------------------------------------------------------------
0000150E                           755  SEGPLOT
0000150E                           756  ; DIBUJAR SEGMENTO.
0000150E                           757  ; INPUT    : NONE 
0000150E                           758  ; OUTPUT   : NONE
0000150E                           759  ; MODIFIES : NONE
0000150E                           760  ; ------------------------------------------------------------------------------
0000150E  3F00                     761              MOVE.W  D0,-(A7)
00001510  3003                     762              MOVE.W  D3,D0
00001512  4EB9 0000189E            763              JSR     CNVICOOR
00001518  2F01                     764              MOVE.L  D1,-(A7)
0000151A                           765              
0000151A  103C 0050                766              MOVE.B  #80,D0
0000151E  223C 0000FF00            767              MOVE.L  #SGMPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DEL SEGMENTO
00001524  4E4F                     768              TRAP    #15
00001526                           769              
00001526  103C 0051                770              MOVE.B  #81,D0
0000152A  223C 0000AA00            771              MOVE.L  #SGMFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DEL SEGMENTO
00001530  4E4F                     772              TRAP    #15
00001532                           773              
00001532  103C 0057                774              MOVE.B  #87,D0
00001536  221F                     775              MOVE.L  (A7)+,D1
00001538  3F03                     776              MOVE.W  D3,-(A7)
0000153A  3601                     777              MOVE.W  D1,D3
0000153C  0643 0014                778              ADD.W   #SIZECLDA,D3
00001540  3802                     779              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001542  0644 0014                780              ADD.W   #SIZECLDA,D4
00001546  4E4F                     781              TRAP    #15                     
00001548                           782                          
00001548  361F                     783              MOVE.W  (A7)+,D3  
0000154A  301F                     784              MOVE.W  (A7)+,D0
0000154C                           785  
0000154C  4E75                     786              RTS
0000154E                           787  
0000154E                           788  -------------------- end include --------------------
0000154E                           789              INCLUDE 'TAILSRP.X68'
0000154E                           790     
0000154E                           791  ; ------------------------------------------------------------------------------
0000154E                           792  TAILINIT
0000154E                           793  ; INICIALIZAR COLA.
0000154E                           794  ; INPUT    : NONE 
0000154E                           795  ; OUTPUT   : NONE
0000154E                           796  ; MODIFIES : NONE
0000154E                           797  ; ------------------------------------------------------------------------------
0000154E                           798  
0000154E  33FC 011D 00001A92       799              MOVE.W  #(PANWIDTH/2)-CBZWIDTH-SGMWIDTH+(COLWIDTH/2),(COLPOSX)
00001556  33FC 00F0 00001A94       800              MOVE.W  #(PANHEIGH/2),(COLPOSY)
0000155E                           801              
0000155E  4E75                     802              RTS
00001560                           803              
00001560                           804              
00001560                           805  ; ------------------------------------------------------------------------------
00001560                           806  TAILUPD
00001560                           807  ; ACTUALIZAR COLA.
00001560                           808  ; INPUT    : NONE 
00001560                           809  ; OUTPUT   : NONE
00001560                           810  ; MODIFIES : NONE
00001560                           811  ; ------------------------------------------------------------------------------
00001560  48A7 6000                812              MOVEM.W D1-D2,-(A7)
00001564                           813              
00001564                           814              ; Marca la posición actual de la cola como vacía
00001564  3239 00001A92            815              MOVE.W  (COLPOSX),D1
0000156A  3439 00001A94            816              MOVE.W  (COLPOSY),D2
00001570  4EB9 000017F6            817              JSR     CINDMTRZ
00001576  4EB9 00001846            818              JSR     MCLDVCIA
0000157C                           819              ; Actualiza la posición de la cola para seguir al último segmento
0000157C  33F9 00001A9A 00001A92   820              MOVE.W  (SGMPOSX2),(COLPOSX)
00001586  33F9 00001A9C 00001A94   821              MOVE.W  (SGMPOSY2),(COLPOSY)    ; MARCAMOS LA COOORDENADA DE LA COLA COMO COORDENADA DEL SEGMENTO 2
00001590                           822              ; Marca la nueva posición como cola
00001590  3239 00001A92            823              MOVE.W  (COLPOSX),D1
00001596  3439 00001A94            824              MOVE.W  (COLPOSY),D2
0000159C  4EB9 000017F6            825              JSR     CINDMTRZ
000015A2  4EB9 00001872            826              JSR     COLOCPD
000015A8                           827  
000015A8                           828  FINUPD
000015A8  4C9F 0006                829              MOVEM.W (A7)+,D1-D2
000015AC  4E75                     830              RTS
000015AE                           831              
000015AE                           832  ; ------------------------------------------------------------------------------
000015AE                           833  TAILPLOT
000015AE                           834  ; DIBUJAR COLA
000015AE                           835  ; INPUT    : NONE 
000015AE                           836  ; OUTPUT   : NONE
000015AE                           837  ; MODIFIES : NONE
000015AE                           838  ; ------------------------------------------------------------------------------
000015AE                           839  
000015AE  3F00                     840              MOVE.W  D0,-(A7)
000015B0  3003                     841              MOVE.W  D3,D0
000015B2  4EB9 0000189E            842              JSR     CNVICOOR
000015B8  2F01                     843              MOVE.L  D1,-(A7)
000015BA                           844              
000015BA  103C 0050                845              MOVE.B  #80,D0
000015BE  223C 0000FF00            846              MOVE.L  #COLPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA COLA
000015C4  4E4F                     847              TRAP    #15
000015C6                           848              
000015C6  103C 0051                849              MOVE.B  #81,D0
000015CA  223C 0000AA00            850              MOVE.L  #COLFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA COLA
000015D0  4E4F                     851              TRAP    #15
000015D2                           852              
000015D2  103C 0057                853              MOVE.B  #87,D0
000015D6  221F                     854              MOVE.L  (A7)+,D1
000015D8  3F03                     855              MOVE.W  D3,-(A7)
000015DA  3601                     856              MOVE.W  D1,D3
000015DC  0643 0014                857              ADD.W   #SIZECLDA,D3
000015E0  3802                     858              MOVE.W  D2,D4                    
000015E2  0644 0014                859              ADD.W   #SIZECLDA,D4
000015E6  4E4F                     860              TRAP    #15                    ; DIBUJAMOS EL CUADRADO 
000015E8                           861                          
000015E8  361F                     862              MOVE.W  (A7)+,D3  
000015EA  301F                     863              MOVE.W  (A7)+,D0
000015EC                           864  
000015EC  4E75                     865              RTS
000015EE                           866  
000015EE                           867  
000015EE                           868  -------------------- end include --------------------
000015EE                           869              INCLUDE 'APPLE.X68'
000015EE                           870     
000015EE                           871  ; ------------------------------------------------------------------------------
000015EE                           872  APPLEINIT
000015EE                           873  ; Inicializa la manzana en una posición aleatoria
000015EE                           874  ; INPUT    : NONE 
000015EE                           875  ; OUTPUT   : NONE
000015EE                           876  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
000015EE                           877  ; ------------------------------------------------------------------------------
000015EE                           878  
000015EE                           879              ; Llama a la función para generar la posición aleatoria
000015EE  4EB9 000016DC            880              JSR     GENPOSMNZ
000015F4                           881  
000015F4                           882              ; Convierte las coordenadas de la manzana a índice de la matriz
000015F4  4EB9 000017F6            883              JSR     CINDMTRZ
000015FA                           884  
000015FA                           885              ; Verifica si la celda está ocupada o libre
000015FA                           886  CHECK:
000015FA  4EB9 000018DA            887              JSR     CHECKCLD
00001600  6700 0010                888              BEQ     MARKMNZ                  ; Si está libre
00001604                           889  
00001604                           890              ; Si la celda está ocupada
00001604  4EB9 000016DC            891              JSR     GENPOSMNZ                ; Genera una nueva posición
0000160A  4EB9 000017F6            892              JSR     CINDMTRZ                 ; Convierte las nuevas coordenadas
00001610  60E8                     893              BRA     CHECK                    ; Repite la comprobación
00001612                           894  
00001612                           895  MARKMNZ:
00001612                           896              ; Marca la celda como ocupada con la manzana (estado 4)
00001612  4EB9 00001888            897              JSR     MNZOCPD
00001618                           898  
00001618                           899              ; Dibuja la manzana en la pantalla
00001618  4EB9 0000165E            900              JSR     APPLEPLOT
0000161E                           901  
0000161E  4E75                     902              RTS
00001620                           903  
00001620                           904  ; ------------------------------------------------------------------------------
00001620                           905  APPLEUPD
00001620                           906  ; Actualiza la posición de la manzana cuando la serpiente come
00001620                           907  ; INPUT    : NONE 
00001620                           908  ; OUTPUT   : NONE
00001620                           909  ; MODIFIES : MNZPOSX, MNZPOSY, ESTDCLDS
00001620                           910  ; ------------------------------------------------------------------------------
00001620                           911  
00001620                           912  
00001620                           913              ; Convierte las coordenadas actuales de la manzana a índice de la matriz
00001620  4EB9 000017F6            914              JSR     CINDMTRZ
00001626                           915  
00001626                           916              ; Marca la celda anterior como vacía
00001626  4EB9 00001846            917              JSR     MCLDVCIA
0000162C                           918  
0000162C                           919              ; Llama a la función para generar una nueva posición aleatoria
0000162C  4EB9 000016DC            920              JSR     GENPOSMNZ
00001632                           921  
00001632                           922              ; Convierte las nuevas coordenadas de la manzana a índice de la matriz
00001632  4EB9 000017F6            923              JSR     CINDMTRZ
00001638                           924  
00001638                           925  CHCKUPDT:
00001638  4EB9 000018DA            926              JSR     CHECKCLD             ; Verifica si la celda está libre
0000163E  6700 0010                927              BEQ     NEWMNZ               ; Si está libre
00001642                           928  
00001642                           929              ; Si la celda está ocupada
00001642  4EB9 000016DC            930              JSR     GENPOSMNZ            ; Genera una nueva posición
00001648  4EB9 000017F6            931              JSR     CINDMTRZ             ; Convierte las nuevas coordenadas
0000164E  60E8                     932              BRA     CHCKUPDT             ; Repite la comprobación
00001650                           933  
00001650                           934  NEWMNZ:
00001650                           935              ; Marca la celda como ocupada con la manzana (estado 4)
00001650  4EB9 00001888            936              JSR     MNZOCPD
00001656                           937  
00001656                           938              ; Dibuja la nueva manzana en la pantalla
00001656  4EB9 0000165E            939              JSR     APPLEPLOT
0000165C                           940  
0000165C  4E75                     941              RTS
0000165E                           942              
0000165E                           943  ; ------------------------------------------------------------------------------
0000165E                           944  APPLEPLOT
0000165E                           945  ; Dibuja la manzana
0000165E                           946  ; INPUT    : NONE 
0000165E                           947  ; OUTPUT   : NONE
0000165E                           948  ; MODIFIES : NONE
0000165E                           949  ; ------------------------------------------------------------------------------
0000165E  3F00                     950              MOVE.W  D0,-(A7)
00001660  3003                     951              MOVE.W  D3,D0
00001662  4EB9 0000189E            952              JSR     CNVICOOR
00001668  2F01                     953              MOVE.L  D1,-(A7)                ; PRIMERO DEBEMOS DIBUJAR EL FONDO Y LUEGO LA MANZANA
0000166A                           954              
0000166A  103C 0050                955              MOVE.B  #80,D0
0000166E  223C 0090EE90            956              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001674  4E4F                     957              TRAP    #15
00001676                           958              
00001676  103C 0051                959              MOVE.B  #81,D0
0000167A  223C 0090EE90            960              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001680  4E4F                     961              TRAP    #15
00001682                           962              
00001682  103C 0057                963              MOVE.B  #87,D0
00001686  221F                     964              MOVE.L  (A7)+,D1
00001688  3F03                     965              MOVE.W  D3,-(A7)
0000168A  3601                     966              MOVE.W  D1,D3
0000168C  0643 0014                967              ADD.W   #SIZECLDA,D3
00001690  3802                     968              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
00001692  0644 0014                969              ADD.W   #SIZECLDA,D4
00001696  4E4F                     970              TRAP    #15                     
00001698                           971                          
00001698  361F                     972              MOVE.W  (A7)+,D3  
0000169A  301F                     973              MOVE.W  (A7)+,D0
0000169C                           974  
0000169C  3F00                     975              MOVE.W  D0,-(A7)
0000169E  3003                     976              MOVE.W  D3,D0
000016A0  4EB9 0000189E            977              JSR     CNVICOOR
000016A6  2F01                     978              MOVE.L  D1,-(A7)
000016A8                           979              
000016A8  103C 0050                980              MOVE.B  #80,D0
000016AC  223C 0000AAFF            981              MOVE.L  #MNZPCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL CONTORNO DE LA MANZANA
000016B2  4E4F                     982              TRAP    #15
000016B4                           983              
000016B4  103C 0051                984              MOVE.B  #81,D0
000016B8  223C 000000FF            985              MOVE.L  #MNZFCOL,D1            ; PONEMOS EL COLOR DE DIBUJADO AL COLOR DEL RELLENO DE LA MANZANA
000016BE  4E4F                     986              TRAP    #15
000016C0                           987              
000016C0  103C 0058                988              MOVE.B  #88,D0
000016C4  221F                     989              MOVE.L  (A7)+,D1
000016C6  3F03                     990              MOVE.W  D3,-(A7)
000016C8  3601                     991              MOVE.W  D1,D3
000016CA  0643 0014                992              ADD.W   #SIZECLDA,D3
000016CE  3802                     993              MOVE.W  D2,D4                    ; DIBUJAMOS EL CIRCULO
000016D0  0644 0014                994              ADD.W   #SIZECLDA,D4
000016D4  4E4F                     995              TRAP    #15                     
000016D6                           996                          
000016D6  361F                     997              MOVE.W  (A7)+,D3  
000016D8  301F                     998              MOVE.W  (A7)+,D0
000016DA                           999  
000016DA                          1000  
000016DA  4E75                    1001              RTS
000016DC                          1002  ; ----------------------------------------------------------------------------
000016DC                          1003  GENPOSMNZ
000016DC                          1004  ; Genera una posición aleatoria para la manzana
000016DC                          1005  ; INPUT: NONE
000016DC                          1006  ; OUTPUT:
000016DC                          1007  ; MODIFIES: MNZPOSX, MNZPOSY
000016DC                          1008  ; ----------------------------------------------------------------------------
000016DC                          1009  
000016DC  48E7 8000               1010              MOVEM.L D0,-(A7)
000016E0                          1011  
000016E0                          1012              ; Genera la coordenada X aleatoria
000016E0  4EB8 11C4               1013              JSR     UTLRAND
000016E4  0240 001F               1014              ANDI.W  #NUMCLMNS-1, D0       ; Asegura que esté en [0, NUMCLMNS-1]
000016E8  C0FC 0014               1015              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
000016EC  3200                    1016              MOVE.W  D0,D1
000016EE  33C0 00001A86           1017              MOVE.W  D0, MNZPOSX           ; Guarda la coordenada X generada
000016F4                          1018              
000016F4                          1019              ; Generar coordenada Y aleatoria
000016F4  4EB8 11C4               1020              JSR     UTLRAND
000016F8  0240 0017               1021              ANDI.W  #NUMFILAS-1, D0       ; Asegura que esté en el rango [0, NUMFILAS-1]
000016FC  C0FC 0014               1022              MULU    #SIZECLDA, D0         ; Escala al tamaño real de las celdas
00001700  3400                    1023              MOVE.W  D0,D2
00001702  33C0 00001A88           1024              MOVE.W  D0, MNZPOSY           ; Guarda la coordenada Y generada
00001708                          1025              
00001708  4CDF 0001               1026              MOVEM.L (A7)+,D0
0000170C  4E75                    1027              RTS 
0000170E                          1028  
0000170E                          1029  
0000170E                          1030  
0000170E                          1031  
0000170E                          1032  
0000170E                          1033  
0000170E                          1034  -------------------- end include --------------------
0000170E                          1035              INCLUDE 'SCORE.X68'
0000170E                          1036     
0000170E                          1037  ; ------------------------------------------------------------------------------
0000170E                          1038  SCOINIT
0000170E                          1039  ; INICIALIZAR MARCADOR.
0000170E                          1040  ; INPUT    : NONE 
0000170E                          1041  ; OUTPUT   : NONE
0000170E                          1042  ; MODIFIES : NONE
0000170E                          1043  ; ------------------------------------------------------------------------------
0000170E  4279 00001AA0           1044              CLR.W   (JGOPNTS)
00001714  4E75                    1045              RTS
00001716                          1046              
00001716                          1047  ; ------------------------------------------------------------------------------
00001716                          1048  SCOUPD
00001716                          1049  ; ACTUALIZAR MARCADOR.
00001716                          1050  ; INPUT    : NONE 
00001716                          1051  ; OUTPUT   : NONE
00001716                          1052  ; MODIFIES : NONE
00001716                          1053  ; ------------------------------------------------------------------------------
00001716                          1054              
00001716  48E7 8000               1055              MOVEM.L D0,-(A7)
0000171A                          1056              
0000171A                          1057              ;Incrementa el marcador
0000171A  3039 00001AA0           1058              MOVE.W  (JGOPNTS),D0
00001720  0640 0019               1059              ADD.W  #25,D0
00001724  33C0 00001AA0           1060              MOVE.W  D0,(JGOPNTS)
0000172A                          1061              
0000172A  4CDF 0001               1062              MOVEM.L (A7)+,D0
0000172E                          1063  
0000172E  4E75                    1064              RTS
00001730                          1065              
00001730                          1066  ; ------------------------------------------------------------------------------
00001730                          1067  SCOPLOT
00001730                          1068  ; DIBUJAR MARCADOR.
00001730                          1069  ; INPUT    : NONE 
00001730                          1070  ; OUTPUT   : NONE
00001730                          1071  ; MODIFIES : NONE
00001730                          1072  ; ------------------------------------------------------------------------------
00001730  48E7 C040               1073             MOVEM.L  D0-D1/A1,-(A7)
00001734                          1074             ; SET COLOR DE FONDO
00001734  103C 0051               1075             MOVE.B   #81,D0
00001738  223C 0090EE90           1076             MOVE.L   #COLFND,D1
0000173E  4E4F                    1077             TRAP     #15
00001740                          1078             
00001740                          1079             
00001740                          1080             
00001740                          1081             ; DIBUJAR LINEA DE PUNTUACIÓN
00001740  43F9 0000175A           1082              LEA     .TXT1,A1
00001746  4281                    1083              CLR.L   D1
00001748  3239 00001AA0           1084              MOVE.W  (JGOPNTS),D1
0000174E  103C 0011               1085              MOVE.B  #17,D0
00001752  4E4F                    1086              TRAP    #15
00001754                          1087              
00001754  4CDF 0203               1088              MOVEM.L (A7)+,D0-D1/A1
00001758  4E75                    1089              RTS
0000175A                          1090  
0000175A                          1091  
0000175A= 50 55 4E 54 4F 53 ...   1092  .TXT1       DC.B    'PUNTOS : ',0
00001764                          1093  
00001764                          1094  
00001764                          1095  
00001764                          1096  
00001764                          1097  -------------------- end include --------------------
00001764                          1098              INCLUDE 'MATRIZ.X68'
00001764                          1099  ; ----------------------------------------------------------------------------
00001764                          1100  ; MATRIZ
00001764                          1101  ; ----------------------------------------------------------------------------
00001764                          1102  
00001764                          1103  ;-----------------------------------------------------------------------------
00001764                          1104  MTZINIT
00001764                          1105  ; INICIALIZA LA MATRIZ, AL PRINCIPIO ESTÁ VACÍA
00001764                          1106  ; INPUT    : NONE
00001764                          1107  ; OUTPUT   : NONE
00001764                          1108  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001764                          1109  ; ----------------------------------------------------------------------------
00001764                          1110              
00001764  48A7 E080               1111              MOVEM.W D0-D2/A0,-(A7)
00001768                          1112              
00001768  41F9 00001AA4           1113              LEA ESTDCLDS,A0       ; Apunta al inicio de ESTDCLDS
0000176E  303C 0300               1114              MOVE.W #TCELDAS,D0    ; Número total de celdas
00001772                          1115  
00001772                          1116  CLNCLDS:
00001772  4218                    1117              CLR.B (A0)+            ; Coloca 0 en cada celda
00001774  5340                    1118              SUBI.W #1, D0          ; Decrementa el contador de celdas
00001776  66FA                    1119              BNE CLNCLDS            ; Repite hasta que esten vacías
00001778                          1120              
00001778                          1121              
00001778  3239 00001A8A           1122              MOVE.W  (CBZPOSX),D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
0000177E  3439 00001A8C           1123              MOVE.W  (CBZPOSY),D2
00001784  4EB9 000017F6           1124              JSR     CINDMTRZ
0000178A  4EB9 00001830           1125              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
00001790                          1126              
00001790  3239 00001A96           1127              MOVE.W  (SGMPOSX),D1
00001796  3439 00001A98           1128              MOVE.W  (SGMPOSY),D2             ; VEMOS LA POSICIÓN DEL SEGMENTO
0000179C  4EB9 000017F6           1129              JSR     CINDMTRZ
000017A2  4EB9 0000185C           1130              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
000017A8                          1131              
000017A8  3239 00001A9A           1132              MOVE.W  (SGMPOSX2),D1
000017AE  3439 00001A9C           1133              MOVE.W  (SGMPOSY2),D2            ; VEMOS LA POSICIÓN DEL SEGMENTO 2
000017B4  4EB9 000017F6           1134              JSR     CINDMTRZ
000017BA  4EB9 0000185C           1135              JSR     SGMOCPD                 ; MARCAMOS LA POSICION DEL SEGMENTO 2
000017C0                          1136              
000017C0  3239 00001A92           1137              MOVE.W  (COLPOSX),D1             ; VEMOS LA POSICIÓN DE LA COLA
000017C6  3439 00001A94           1138              MOVE.W  (COLPOSY),D2
000017CC  4EB9 000017F6           1139              JSR     CINDMTRZ
000017D2  4EB9 00001872           1140              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
000017D8                          1141              
000017D8  3239 00001A86           1142              MOVE.W  (MNZPOSX),D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
000017DE  3439 00001A88           1143              MOVE.W  (MNZPOSY),D2
000017E4  4EB9 000017F6           1144              JSR     CINDMTRZ
000017EA  4EB9 00001888           1145              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
000017F0                          1146              
000017F0                          1147              
000017F0  4C9F 0107               1148              MOVEM.W (A7)+,D0-D2/A0
000017F4                          1149  
000017F4  4E75                    1150              RTS
000017F6                          1151  
000017F6                          1152  ;-----------------------------------------------------------------------------
000017F6                          1153  CINDMTRZ
000017F6                          1154  ; CALCULA EL ÍNDICE DE UNA CELDA
000017F6                          1155  ; INPUT    : D1 = coordenada X pantalla, D2 = coordenada Y pantalla
000017F6                          1156  ; OUTPUT   : D0 = índice de la celda en ESTDCLDS
000017F6                          1157  ; MODIFIES : NONE
000017F6                          1158  ; ----------------------------------------------------------------------------
000017F6                          1159  
000017F6  48A7 7000               1160               MOVEM.W D1-D3,-(A7)     ; Guarda los registros D1-D3 en la pila
000017FA                          1161  
000017FA                          1162              ; Divide X por SIZECLDA
000017FA  3601                    1163              MOVE.W  D1,D3          ; Copia X a D3
000017FC  4241                    1164              CLR.W   D1              ; Inicializa el cociente de X
000017FE                          1165  
000017FE  B67C 0014               1166  DIVX:       CMP.W   #SIZECLDA,D3    ; Compara D3 con SIZECLDA
00001802  6D00 000A               1167              BLT     ENDDIVX         ; Si D3 < SIZECLDA, salta a ENDDIVX
00001806  0443 0014               1168              SUB.W   #SIZECLDA,D3   ; Resta SIZECLDA de D3
0000180A  5241                    1169              ADDQ.W  #1,D1          ; Incrementa el cociente de X
0000180C  60F0                    1170              BRA     DIVX            ; Repite el bucle
0000180E                          1171  
0000180E                          1172  ENDDIVX:
0000180E                          1173  
0000180E                          1174              ; Divide Y por SIZECLDA
0000180E  3602                    1175              MOVE.W  D2,D3          ; Copia Y a D3
00001810  4242                    1176              CLR.W   D2              ; Inicializa el cociente de Y
00001812                          1177  
00001812  B67C 0014               1178  DIVY:       CMP.W   #SIZECLDA,D3    ; Compara D3 con SIZECLDA
00001816  6D00 000A               1179              BLT     ENDDIVY         ; Si D3 < SIZECLDA, salta a ENDDIVY
0000181A  0443 0014               1180              SUB.W   #SIZECLDA,D3   ; Resta SIZECLDA de D3
0000181E  5242                    1181              ADDQ.W  #1, D2          ; Incrementa el cociente de Y
00001820  60F0                    1182              BRA     DIVY            ; Repite el bucle
00001822                          1183  
00001822                          1184  ENDDIVY:
00001822                          1185  
00001822                          1186              ; Calcula el índice
00001822  4240                    1187              CLR.W   D0
00001824  3002                    1188              MOVE.W  D2, D0          ; D0 = Y_CELDA
00001826  EB40                    1189              ASL.W   #5, D0          ; D0 = Y_CELDA * NUMCLMNS (32 = 2^5)
00001828  D041                    1190              ADD.W   D1, D0          ; D0 = Y_CELDA * NUMCLMNS + X_CELDA
0000182A                          1191  
0000182A  4C9F 000E               1192              MOVEM.W (A7)+,D1-D3     ; Restaura los registros D1-D3 desde la pila
0000182E                          1193  
0000182E  4E75                    1194              RTS  
00001830                          1195              
00001830                          1196  ;-----------------------------------------------------------------------------
00001830                          1197  CBZOCPD
00001830                          1198  ; MARCA UNA CELDA COMO OCUPADA POR LA CABEZA
00001830                          1199  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001830                          1200  ; OUTPUT   : NONE
00001830                          1201  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001830                          1202  ; ----------------------------------------------------------------------------
00001830                          1203  
00001830  48A7 0080               1204              MOVEM.W A0,-(A7)
00001834                          1205  
00001834  41F9 00001AA4           1206              LEA     ESTDCLDS,A0                ; Dirección de la matriz en A0
0000183A  11BC 0003 0000          1207              MOVE.B  #3,(A0, D0.W)           ; Marca la celda como ocupada
00001840                          1208              
00001840  4C9F 0100               1209              MOVEM.W (A7)+,A0
00001844                          1210              
00001844  4E75                    1211              RTS
00001846                          1212              
00001846                          1213              
00001846                          1214              
00001846                          1215             
00001846                          1216  ;-----------------------------------------------------------------------------
00001846                          1217  MCLDVCIA
00001846                          1218  ; MARCA UNA CELDA COMO VACÍA
00001846                          1219  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001846                          1220  ; OUTPUT   : NONE
00001846                          1221  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001846                          1222  ; ----------------------------------------------------------------------------
00001846                          1223  
00001846  48A7 0080               1224              MOVEM.W A0,-(A7)
0000184A                          1225  
0000184A  41F9 00001AA4           1226              LEA     ESTDCLDS,A0                ; Direccion de la matriz en A0
00001850  11BC 0000 0000          1227              MOVE.B  #0,(A0,D0.W)           ; Marca la celda como vacía
00001856                          1228              
00001856  4C9F 0100               1229              MOVEM.W (A7)+,A0
0000185A                          1230              
0000185A  4E75                    1231              RTS
0000185C                          1232  
0000185C                          1233  ;-----------------------------------------------------------------------------
0000185C                          1234  SGMOCPD
0000185C                          1235  ; MARCA UNA CELDA COMO OCUPADA POR EL SEGMENTO
0000185C                          1236  ; INPUT    : D0 = índice de la celda en ESTDCLDS
0000185C                          1237  ; OUTPUT   : NONE
0000185C                          1238  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
0000185C                          1239  ; ----------------------------------------------------------------------------
0000185C                          1240  
0000185C  48A7 0080               1241              MOVEM.W A0,-(A7)
00001860                          1242  
00001860  41F9 00001AA4           1243              LEA ESTDCLDS,A0                ; Dirección de la matriz en A0
00001866  11BC 0002 0000          1244              MOVE.B #2,(A0,D0.W)           ; Marca la celda como ocupada
0000186C                          1245              
0000186C  4C9F 0100               1246              MOVEM.W (A7)+,A0
00001870                          1247              
00001870  4E75                    1248              RTS
00001872                          1249              
00001872                          1250  ;-----------------------------------------------------------------------------
00001872                          1251  COLOCPD
00001872                          1252  ; MARCA UNA CELDA COMO OCUPADA POR LA COLA
00001872                          1253  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001872                          1254  ; OUTPUT   : NONE
00001872                          1255  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001872                          1256  ; ----------------------------------------------------------------------------
00001872                          1257  
00001872  48A7 0080               1258              MOVEM.W A0,-(A7)
00001876                          1259  
00001876  41F9 00001AA4           1260              LEA ESTDCLDS,A0                ; Dirección de la matriz en A0
0000187C  11BC 0001 0000          1261              MOVE.B #1,(A0,D0.W)           ; Marca la celda como ocupada
00001882                          1262              
00001882  4C9F 0100               1263              MOVEM.W (A7)+,A0
00001886                          1264              
00001886  4E75                    1265              RTS
00001888                          1266  
00001888                          1267  
00001888                          1268  ;-----------------------------------------------------------------------------
00001888                          1269  MNZOCPD
00001888                          1270  ; MARCA UNA CELDA COMO OCUPADA POR LA MANZANA
00001888                          1271  ; INPUT    : D0 = índice de la celda en ESTDCLDS
00001888                          1272  ; OUTPUT   : NONE
00001888                          1273  ; MODIFIES : Estado de la celda en la variable ESTDCLDS
00001888                          1274  ; ----------------------------------------------------------------------------
00001888                          1275  
00001888  48A7 0080               1276              MOVEM.W A0,-(A7)
0000188C                          1277  
0000188C  41F9 00001AA4           1278              LEA ESTDCLDS,A0                ; Dirección de la matriz en A0
00001892  11BC 0004 0000          1279              MOVE.B #4,(A0,D0.W)           ; Marca la celda como ocupada
00001898                          1280              
00001898  4C9F 0100               1281              MOVEM.W (A7)+,A0
0000189C                          1282              
0000189C  4E75                    1283              RTS
0000189E                          1284  
0000189E                          1285              
0000189E                          1286  ;-----------------------------------------------------------------------------
0000189E                          1287  CNVICOOR
0000189E                          1288  ; Convierte un índice de celda a coordenadas de pantalla (X, Y)
0000189E                          1289  ; INPUT    : D0 = índice de la celda en ESTADO_CELDAS
0000189E                          1290  ; OUTPUT   : D1 = coordenada X, D2 = coordenada Y
0000189E                          1291  ; MODIFIES : NONE
0000189E                          1292  ; ----------------------------------------------------------------------------
0000189E                          1293  
0000189E  48A7 9800               1294              MOVEM.W D0/D3-D4,-(A7)
000018A2                          1295  
000018A2  3400                    1296              MOVE.W  D0,D2         ; Copia índice a D2 para calcular la fila
000018A4  EA4A                    1297              LSR.W   #5,D2         ; D2 = índice / NUM_COLUMNAS (32 = 2^5)
000018A6  3200                    1298              MOVE.W  D0,D1         ; Copia índice a D1 para calcular la columna
000018A8  C27C 001F               1299              AND.W   #$1F,D1       ; D1 = índice % NUM_COLUMNAS (31 = 0x1F) (CREO)
000018AC                          1300  
000018AC                          1301              ; Multiplica por TAMAÑO_CELDA = 10
000018AC  363C 0014               1302              MOVE.W  #SIZECLDA, D3
000018B0  3801                    1303              MOVE.W  D1,D4         ; Copia D1 para multiplicar por 10
000018B2  4241                    1304              CLR.W   D1            ; Inicializa resultado
000018B4                          1305  
000018B4                          1306  
000018B4                          1307  MULTLOOPX: 
000018B4  B87C 0000               1308              CMP.W   #0,D4        ; ¿Quedan iteraciones?
000018B8  6700 0008               1309              BEQ     ENDMULTX
000018BC  D243                    1310              ADD.W   D3,D1         ; Suma TAMANO_CELDA (10) repetidamente
000018BE                          1311  
000018BE  5344                    1312              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
000018C0  60F2                    1313              BRA     MULTLOOPX     ; Repite mientras no sea 0
000018C2                          1314  ENDMULTX: 
000018C2  3802                    1315              MOVE.W  D2,D4         ; Copia D2 para multiplicar por 10
000018C4  4242                    1316              CLR.W   D2            ; Inicializa resultado
000018C6                          1317  
000018C6                          1318  MULTLOOPY: 
000018C6  B87C 0000               1319              CMP.W   #0,D4        ; ¿Quedan iteraciones?
000018CA  6700 0008               1320              BEQ     ENDMULTY
000018CE  D443                    1321              ADD.W   D3,D2         ; Suma TAMANO_CELDA (10) repetidamente
000018D0  5344                    1322              SUBQ.W  #1,D4         ; Cuenta las iteraciones restantes
000018D2  60F2                    1323              BRA     MULTLOOPY     ; Repite mientras no sea 0
000018D4                          1324  ENDMULTY:
000018D4  4C9F 0019               1325              MOVEM.W (A7)+,D0/D3-D4
000018D8                          1326  
000018D8  4E75                    1327              RTS
000018DA                          1328  
000018DA                          1329  ; ----------------------------------------------------------------------------
000018DA                          1330  CHECKCLD
000018DA                          1331  ; INPUT: D0 = índice de la celda
000018DA                          1332  ; OUTPUT: D0 = 0 si está vacía, 1 si está ocupada
000018DA                          1333  ; MODIFIES: Ninguno
000018DA                          1334  ; ----------------------------------------------------------------------------
000018DA                          1335  
000018DA  41F9 00001AA4           1336              LEA     ESTDCLDS,A0    ; Carga la dirección de la matriz ESTDCLDS
000018E0  1230 0000               1337              MOVE.B  (A0,D0.W),D1   ; Carga el estado de la celda en D1
000018E4  B23C 0000               1338              CMP.B   #0,D1          ; Compara si está vacía (0)
000018E8  6700 0008               1339              BEQ     CLDFREE         ; Si está vacía
000018EC  303C 0001               1340              MOVE.W  #1,D0          ; Si está ocupada, devuelve 1 (ocupada)
000018F0                          1341  
000018F0  4E75                    1342              RTS
000018F2                          1343  
000018F2                          1344  CLDFREE:
000018F2  303C 0000               1345              MOVE.W  #0,D0                 ; Devuelve 0 (libre)
000018F6                          1346  
000018F6  4E75                    1347              RTS
000018F8                          1348  
000018F8                          1349  
000018F8                          1350  ;-----------------------------------------------------------------------------
000018F8                          1351  FONPLOT
000018F8                          1352  ; DIBUJADO DEL FONDO
000018F8                          1353  ; INPUT    : NONE
000018F8                          1354  ; OUTPUT   : NONE
000018F8                          1355  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000018F8                          1356  ; ----------------------------------------------------------------------------
000018F8                          1357  
000018F8  3F00                    1358              MOVE.W  D0,-(A7)
000018FA  3003                    1359              MOVE.W  D3,D0
000018FC  4EB8 189E               1360              JSR     CNVICOOR
00001900  2F01                    1361              MOVE.L  D1,-(A7)
00001902                          1362              
00001902  103C 0050               1363              MOVE.B  #80,D0
00001906  223C 0090EE90           1364              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
0000190C  4E4F                    1365              TRAP    #15
0000190E                          1366              
0000190E  103C 0051               1367              MOVE.B  #81,D0
00001912  223C 0090EE90           1368              MOVE.L  #COLFND,D1            ; PONEMOS EL COLOR DE DIBUJADO A COLORFONDO
00001918  4E4F                    1369              TRAP    #15
0000191A                          1370              
0000191A  103C 0057               1371              MOVE.B  #87,D0
0000191E  221F                    1372              MOVE.L  (A7)+,D1
00001920  3F03                    1373              MOVE.W  D3,-(A7)
00001922  3601                    1374              MOVE.W  D1,D3
00001924  0643 0014               1375              ADD.W   #SIZECLDA,D3
00001928  3802                    1376              MOVE.W  D2,D4                    ; DIBUJAMOS EL CUADRADO
0000192A  0644 0014               1377              ADD.W   #SIZECLDA,D4
0000192E  4E4F                    1378              TRAP    #15                     
00001930                          1379                          
00001930  361F                    1380              MOVE.W  (A7)+,D3  
00001932  301F                    1381              MOVE.W  (A7)+,D0
00001934  4E75                    1382              RTS         
00001936                          1383  
00001936                          1384  
00001936                          1385  
00001936                          1386  ;-----------------------------------------------------------------------------
00001936                          1387  MTZUPD
00001936                          1388  ; ACTUALIZA LA MATRIZ CASILLA A CASILLA
00001936                          1389  ; INPUT    : NONE
00001936                          1390  ; OUTPUT   : NONE
00001936                          1391  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
00001936                          1392  ; ----------------------------------------------------------------------------
00001936                          1393  
00001936                          1394  
00001936  48A7 E080               1395              MOVEM.W D0-D2/A0,-(A7)
0000193A                          1396              
0000193A  41F9 00001AA4           1397              LEA ESTDCLDS,A0       ; Apunta al inicio de ESTDCLDS
00001940  303C 0300               1398              MOVE.W #TCELDAS,D0    ; Número total de celdas
00001944                          1399  
00001944                          1400  .CLNCLDS:
00001944  4218                    1401              CLR.B (A0)+            ; Coloca 0 en cada celda
00001946  5340                    1402              SUBI.W #1,D0          ; Decrementa el contador de celdas
00001948  66FA                    1403              BNE .CLNCLDS           ; Repite hasta que esten vacías
0000194A                          1404              
0000194A                          1405              
0000194A  3239 00001A8A           1406              MOVE.W  (CBZPOSX),D1             ; VEMOS LA POSICION INICIAL DE LA CABEZA             
00001950  3439 00001A8C           1407              MOVE.W  (CBZPOSY),D2
00001956  4EB8 17F6               1408              JSR     CINDMTRZ
0000195A  4EB8 1830               1409              JSR     CBZOCPD                 ; MARCAMOS LA POSICIÓN COMO CABEZA
0000195E                          1410              
0000195E  3239 00001A96           1411              MOVE.W  (SGMPOSX),D1
00001964  3439 00001A98           1412              MOVE.W  (SGMPOSY),D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
0000196A  4EB8 17F6               1413              JSR     CINDMTRZ
0000196E  4EB8 185C               1414              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
00001972                          1415              
00001972  3239 00001A9A           1416              MOVE.W  (SGMPOSX2),D1
00001978  3439 00001A9C           1417              MOVE.W  (SGMPOSY2),D2             ; VEMOS LA POSICIÓN INICIAL DEL SEGMENTO
0000197E  4EB8 17F6               1418              JSR     CINDMTRZ
00001982  4EB8 185C               1419              JSR     SGMOCPD                 ; MARCAMOS LA POSICIÓN DEL SEGMENTO
00001986                          1420              
00001986  3239 00001A92           1421              MOVE.W  (COLPOSX),D1             ; VEMOS LA POSICIÓN INICIAL DE LA COLA
0000198C  3439 00001A94           1422              MOVE.W  (COLPOSY),D2
00001992  4EB8 17F6               1423              JSR     CINDMTRZ
00001996  4EB8 1872               1424              JSR     COLOCPD                 ; MARCAMOS LA POSICIÓN DE LA COLA
0000199A                          1425              
0000199A  3239 00001A86           1426              MOVE.W  (MNZPOSX),D1             ; VEMOS LA POSICIÓN INICIAL DE LA MANZANA
000019A0  3439 00001A88           1427              MOVE.W  (MNZPOSY),D2
000019A6  4EB8 17F6               1428              JSR     CINDMTRZ
000019AA  4EB8 1888               1429              JSR     MNZOCPD                 ; MARCAMOS LA POSICIÓN DE LA MANZANA
000019AE                          1430              
000019AE                          1431              
000019AE  4C9F 0107               1432              MOVEM.W (A7)+,D0-D2/A0
000019B2                          1433  
000019B2  4E75                    1434              RTS
000019B4                          1435  
000019B4                          1436  
000019B4                          1437  
000019B4                          1438  ;-----------------------------------------------------------------------------
000019B4                          1439  MTZPLOT
000019B4                          1440  ; DIBUJA LA MATRIZ CASILLA A CASILLA
000019B4                          1441  ; INPUT    : NONE
000019B4                          1442  ; OUTPUT   : NONE
000019B4                          1443  ; MODIFIES : Variable ESTCLDS que contiene el estado de las celdas
000019B4                          1444  ; ----------------------------------------------------------------------------
000019B4  48E7 F080               1445              MOVEM.L D0-D3/A0,-(A7)
000019B8                          1446  
000019B8  4240                    1447              CLR.W   D0
000019BA  4243                    1448              CLR.W   D3
000019BC  41F9 00001AA4           1449              LEA     ESTDCLDS,A0            ; Apunta al inicio de ESTDCLDS
000019C2  303C 0300               1450              MOVE.W  #TCELDAS,D0            ; Número total de celdas
000019C6  363C 0000               1451              MOVE.W  #0,D3                   ; LO UTILIZAMOS PARA SABER EL INDICE EN EL QUE NOS ENCONTRAMOS
000019CA  4241                    1452              CLR.W   D1
000019CC  4242                    1453              CLR.W   D2
000019CE                          1454              
000019CE                          1455  
000019CE                          1456  PLOTCLDS:
000019CE  1218                    1457              MOVE.B  (A0)+,D1                ; MOVEMOS EL VALOR DE LA CELDA A D1
000019D0  B23C 0000               1458              CMP.B   #0,D1
000019D4  6700 0034               1459              BEQ     PLOTVAC                 ; SALTA A DIBUJAR POSICIÓN VACÍA
000019D8  B23C 0001               1460              CMP.B   #1,D1 
000019DC  6700 0032               1461              BEQ     PLOTCOL                 ; SALTA A DIBUJAR COLA
000019E0  B23C 0002               1462              CMP.B   #2,D1
000019E4  6700 0030               1463              BEQ     PLOTSEG                 ; SALTA A DIBUJAR SEGMENTO
000019E8  B23C 0003               1464              CMP.B   #3,D1
000019EC  6700 0016               1465              BEQ     PLOTCBZ                 ; SALTA A DIBUJAR CABEZA
000019F0  B23C 0004               1466              CMP.B   #4,D1                 
000019F4  6700 0026               1467              BEQ     PLOTAPPLE               ; SALTA A DIBUJAR MANZANA
000019F8                          1468    
000019F8                          1469  DONEPLOT            
000019F8  5243                    1470              ADDQ    #1,D3                   ; AUMENTAMOS EL INDICE DE CELDA PARA LA SIGUIENTE
000019FA  5340                    1471              SUBI.W  #1,D0                  ; Decrementa el contador de celdas
000019FC  66D0                    1472              BNE     PLOTCLDS                ; Repite hasta que esten vacías
000019FE  4CDF 010F               1473              MOVEM.L (A7)+,D0-D3/A0
00001A02  4E75                    1474              RTS
00001A04                          1475  PLOTCBZ:
00001A04  4EB8 13CA               1476              JSR     HEADPLOT
00001A08  60EE                    1477              BRA     DONEPLOT
00001A0A                          1478  
00001A0A                          1479  PLOTVAC:    
00001A0A  4EB8 18F8               1480              JSR     FONPLOT
00001A0E  60E8                    1481              BRA     DONEPLOT                ; DIBUJADO HECHO 
00001A10                          1482  
00001A10                          1483  PLOTCOL:   
00001A10  4EB8 15AE               1484              JSR     TAILPLOT 
00001A14  60E2                    1485              BRA     DONEPLOT                ; DIBUJADO HECHO 
00001A16                          1486              
00001A16                          1487  PLOTSEG:    
00001A16  4EB8 150E               1488              JSR     SEGPLOT
00001A1A  60DC                    1489              BRA     DONEPLOT                ; DIBUJADO HECHO    
00001A1C                          1490  
00001A1C                          1491  PLOTAPPLE:
00001A1C  4EB8 165E               1492              JSR     APPLEPLOT
00001A20  60D6                    1493              BRA     DONEPLOT            
00001A22                          1494  
00001A22                          1495  
00001A22                          1496  
00001A22                          1497  
00001A22                          1498  
00001A22                          1499  
00001A22                          1500  
00001A22                          1501  
00001A22                          1502  
00001A22                          1503  
00001A22                          1504  
00001A22                          1505  
00001A22                          1506  
00001A22                          1507  
00001A22                          1508  
00001A22                          1509  
00001A22                          1510  
00001A22                          1511  
00001A22                          1512  
00001A22                          1513  
00001A22                          1514  
00001A22                          1515  -------------------- end include --------------------
00001A22                          1516  START:
00001A22                          1517                  
00001A22                          1518  ; --- INIZIALIZACIÓN ---------------------------------------------------------
00001A22                          1519  
00001A22  007C 0700               1520              ORI.W   #$0700,SR
00001A26  4EB8 1000               1521              JSR     SYSINIT
00001A2A  4EB8 117C               1522              JSR     UTLINIT
00001A2E  4EB8 1764               1523              JSR     MTZINIT
00001A32  4EB8 12E2               1524              JSR     HEADINIT                
00001A36  4EB8 144E               1525              JSR     SEGINIT
00001A3A  4EB8 154E               1526              JSR     TAILINIT
00001A3E  4EB8 170E               1527              JSR     SCOINIT
00001A42  4EB8 15EE               1528              JSR     APPLEINIT
00001A46                          1529              
00001A46                          1530  
00001A46                          1531  .LOOP
00001A46                          1532  
00001A46                          1533  ; --- ACTUALIZAR -------------------------------------------------------------
00001A46                          1534  
00001A46                          1535  ; LEER DISPOSITIVOS DE ENTRADA
00001A46                          1536  
00001A46  4E41                    1537              TRAP    #KBDUPTN
00001A48                          1538  
00001A48                          1539  ; ACTUALIZAR LÓGICA DEL JUEGO
00001A48                          1540              
00001A48  4EB8 1560               1541              JSR     TAILUPD
00001A4C  4EB8 147C               1542              JSR     SEGUPD
00001A50  4EB8 1308               1543              JSR     HEADUPD
00001A54  4EB8 1936               1544              JSR     MTZUPD
00001A58                          1545              
00001A58                          1546  ; --- SINCRONIZACIÓN ---------------------------------------------------------
00001A58                          1547              
00001A58  4A39 00001DAC           1548  .WINT       TST.B   (SCRINTCT)
00001A5E  67F8                    1549              BEQ     .WINT   
00001A60  4239 00001DAC           1550              CLR.B   (SCRINTCT)         
00001A66                          1551  
00001A66                          1552  
00001A66                          1553  ;---DIBUJAR-------------------------------------------------------------------
00001A66  4EB8 13CA               1554               JSR    HEADPLOT
00001A6A  4EB8 150E               1555               JSR    SEGPLOT
00001A6E  4EB8 15AE               1556               JSR    TAILPLOT
00001A72  4EB8 165E               1557               JSR    APPLEPLOT
00001A76  4EB8 19B4               1558               JSR    MTZPLOT
00001A7A  4EB8 1730               1559               JSR    SCOPLOT
00001A7E                          1560              
00001A7E  4E40                    1561              TRAP    #SCRUPTN                      ; ACTUALIZA DOBLE BUFFER
00001A80                          1562  
00001A80                          1563  
00001A80  60C4                    1564              BRA     .LOOP
00001A82                          1565  
00001A82  FFFF FFFF               1566              SIMHALT
00001A86                          1567              
00001A86                          1568              INCLUDE 'VARS.X68'
00001A86                          1569  ; ----------------------------------------------------------------------------
00001A86                          1570  ; VARIABLES DEL JUEGO
00001A86                          1571  ; ----------------------------------------------------------------------------
00001A86                          1572  
00001A86                          1573  ; --- VARIABLES DE LA MANZANA ------------------------------------------------
00001A86                          1574  
00001A86                          1575  MNZPOSX     DS.W    1                       ; COORDENADA X DE LA MANZANA
00001A88                          1576  MNZPOSY     DS.W    1                       ; COORDENADA Y DE LA MANZANA
00001A8A                          1577  
00001A8A                          1578  ; --- VARIABLES DE LA SERPIENTE ----------------------------------------------
00001A8A                          1579  
00001A8A                          1580  CBZPOSX     DS.W    1                       ; COORDENADA X CABEZA
00001A8C                          1581  CBZPOSY     DS.W    1                       ; COORDENADA Y CABEZA
00001A8E                          1582  CBZVELX     DS.W    1                       ; VELOCIDAD X CABEZA
00001A90                          1583  CBZVELY     DS.W    1                       ; VELOCIDAD Y CABEZA
00001A92                          1584  COLPOSX     DS.W    1                       ; COORDENADA X COLA
00001A94                          1585  COLPOSY     DS.W    1                       ; COORDENADA Y COLA
00001A96                          1586  SGMPOSX     DS.W    1                       ; COORDENADA X SEGMENTO
00001A98                          1587  SGMPOSY     DS.W    1                       ; COORDENADA Y SEGMENTO
00001A9A                          1588  SGMPOSX2    DS.W    1                       ; COORDENADA X SEGMENTO 2
00001A9C                          1589  SGMPOSY2    DS.W    1                       ; COORDENADA Y SEGMENTO 2
00001A9E                          1590  SRPVEL      DS.W    1                       ; VELOCIDAD DE LA SERPIENTE
00001AA0                          1591  ; --- VARIABLES DEL MARCADOR -------------------------------------------------
00001AA0                          1592  
00001AA0                          1593  JGOPNTS     DS.W    1                       ; PUNTUACIÓN DEL JUEGO
00001AA2                          1594  
00001AA2                          1595  
00001AA2                          1596  
00001AA2                          1597  
00001AA2                          1598  
00001AA2                          1599  
00001AA2                          1600  
00001AA2                          1601  
00001AA2                          1602  
00001AA2                          1603  
00001AA2                          1604  
00001AA2                          1605  
00001AA2                          1606  
00001AA2                          1607  
00001AA2                          1608  
00001AA2                          1609  
00001AA2                          1610  -------------------- end include --------------------
00001AA2                          1611              INCLUDE 'LIB/UTLVARS.X68'
00001AA2                          1612  ; =============================================================================
00001AA2                          1613  ; UTILITY VARIABLES
00001AA2                          1614  ; =============================================================================
00001AA2                          1615  
00001AA2                          1616  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001AA4                          1617              DS.W    0
00001AA4                          1618  -------------------- end include --------------------
00001AA4                          1619              INCLUDE 'SYSVARS.X68'
00001AA4                          1620  ; ----------------------------------------------------------------------------
00001AA4                          1621  ; VARIABLES DEL SISTEMA
00001AA4                          1622  ; ----------------------------------------------------------------------------
00001AA4                          1623  
00001AA4                          1624  ; --- VARIABLES DE LA MATRIZ -------------------------------------------------
00001AA4                          1625  
00001AA4                          1626  ESTDCLDS    DS.B    TCELDAS                 ; ESTADO DE LAS CELDAS 0=VACÍO  1=COLA   2=SEGMENTO  TRZPLOT=CABEZA  4?=MANZANA    
00001DA4                          1627  ESTDCBZ     DS.B    1                       ; 0= DERECHA, 1=ARRIBA, 2=IZQUIERDA, 3=ABAJO
00001DA5                          1628  
00001DA5                          1629  ; --- VARIABLES DE TECLADO ---------------------------------------------------
00001DA5                          1630  
00001DA5                          1631  KBDVAL      DS.B    1
00001DA6                          1632  KBDEDGE     DS.B    1                       ; KEY EDGE
00001DA8                          1633  LASTKEY     DS.L    1                       
00001DAC                          1634  
00001DAC                          1635  ;--- TIMED INTERRUPT RELATED VARIABLES ---------------------------------------
00001DAC                          1636              
00001DAC                          1637  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
00001DAE                          1638              DS.W    0
00001DAE                          1639  
00001DAE                          1640  
00001DAE                          1641  
00001DAE                          1642  
00001DAE                          1643  
00001DAE                          1644  
00001DAE                          1645  
00001DAE                          1646  
00001DAE                          1647  
00001DAE                          1648  
00001DAE                          1649  
00001DAE                          1650  
00001DAE                          1651  
00001DAE                          1652  
00001DAE                          1653  -------------------- end include --------------------
00001DAE                          1654      
00001DAE                          1655      
00001DAE                          1656              END    START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
APPLEINIT           15EE
APPLEPLOT           165E
APPLEUPD            1620
ARR                 1156
CBZFCOL             AA00
CBZHEIGH            14
CBZOCPD             1830
CBZPCOL             FF00
CBZPOSX             1A8A
CBZPOSY             1A8C
CBZVEL              14
CBZVELX             1A8E
CBZVELY             1A90
CBZWIDTH            14
CHCKUPDT            1638
CHECK               15FA
CHECKCLD            18DA
CHKCOL              137A
CINDMTRZ            17F6
CLDFREE             18F2
CLNCLDS             1772
CNVICOOR            189E
COLFCOL             AA00
COLFND              90EE90
COLHEIGH            A
COLOCPD             1872
COLPCOL             FF00
COLPOSX             1A92
COLPOSY             1A94
COLWIDTH            A
CONTINU             1176
DER                 114A
DIVX                17FE
DIVY                1812
DONEPLOT            19F8
DWN                 116E
ENDDIVX             180E
ENDDIVY             1822
ENDMULTX            18C2
ENDMULTY            18D4
ESTDCBZ             1DA4
ESTDCLDS            1AA4
FIN                 13C4
FINUPD              15A8
FONPLOT             18F8
GENPOSMNZ           16DC
HEADINIT            12E2
HEADPLOT            13CA
HEADUPD             1308
IZQ                 1162
JGOPNTS             1AA0
KBDDOWN             28
KBDEDGE             1DA6
KBDINIT             1100
KBDLEFT             25
KBDRIGHT            27
KBDUP               26
KBDUPD              110E
KBDUPTN             1
KBDVAL              1DA5
LASTKEY             1DA8
LNGINI              1
MARKMNZ             1612
MAXSGM              1
MCLDVCIA            1846
MNZFCOL             FF
MNZHEIGH            14
MNZOCPD             1888
MNZPCOL             AAFF
MNZPOSX             1A86
MNZPOSY             1A88
MNZWIDTH            14
MTZINIT             1764
MTZPLOT             19B4
MTZUPD              1936
MTZUPD:CLNCLDS      1944
MULTLOOPX           18B4
MULTLOOPY           18C6
NEWMNZ              1650
NOCOL               13AC
NUMCLMNS            20
NUMFILAS            18
OJOFCOL             FFFFFF
OJOHEIGH            A
OJOPCOL             0
OJOWIDTH            A
PANHEIGH            1E0
PANWIDTH            280
PLOTAPPLE           1A1C
PLOTCBZ             1A04
PLOTCLDS            19CE
PLOTCOL             1A10
PLOTSEG             1A16
PLOTVAC             1A0A
PNTSFCOL            0
PNTSTEXT            65
SCOINIT             170E
SCOPLOT             1730
SCOPLOT:TXT1        175A
SCOUPD              1716
SCRFPS              32
SCRINIT             109A
SCRINTCT            1DAC
SCRINTN             1
SCRPLOT             10E6
SCRTIM              10DE
SCRUPTN             0
SEGINIT             144E
SEGPLOT             150E
SEGUPD              147C
SGMFCOL             AA00
SGMHEIGH            14
SGMOCPD             185C
SGMPCOL             FF00
SGMPOSX             1A96
SGMPOSX2            1A9A
SGMPOSY             1A98
SGMPOSY2            1A9C
SGMWIDTH            14
SIGABA              1372
SIGARR              135A
SIGDER              134E
SIGIZQ              1366
SIZECLDA            14
SNDEAT              0
SNDGMOV             1
SNDINIT             103A
SNDINIT:DONE        1058
SNDINIT:LOOP        1046
SNDINIT:SNDEAT      105E
SNDINIT:SNDGMOV     106A
SNDINIT:SNDLIST     107C
SNDPLAY             1088
SNDPLTN             2
SRPVEL              1A9E
START               1A22
START:LOOP          1A46
START:WINT          1A58
SYSINIT             1000
TAILINIT            154E
TAILPLOT            15AE
TAILUPD             1560
TCELDAS             300
UTLCHRWD            8
UTLINIT             117C
UTLPRINT            1192
UTLPRINT:ENDLOOP    11A4
UTLPRINT:LOOP       119A
UTLRAND             11C4
UTLRAND:RANDVEC     11E2
UTLRNDIX            1AA2
